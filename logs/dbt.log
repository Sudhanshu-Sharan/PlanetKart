[0m02:57:04.730810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106603750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106603610>]}


============================== 02:57:04.736752 | 46cf6981-77ff-4ac1-bd97-b2a68eee6565 ==============================
[0m02:57:04.736752 [info ] [MainThread]: Running with dbt=1.10.4
[0m02:57:04.737130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:57:04.784930 [info ] [MainThread]: dbt version: 1.10.4
[0m02:57:04.785532 [info ] [MainThread]: python version: 3.13.3
[0m02:57:04.785703 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3
[0m02:57:04.785837 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m02:57:05.457102 [info ] [MainThread]: Using profiles dir at /Users/sudahnshusharan/.dbt
[0m02:57:05.457370 [info ] [MainThread]: Using profiles.yml file at /Users/sudahnshusharan/.dbt/profiles.yml
[0m02:57:05.457524 [info ] [MainThread]: Using dbt_project.yml file at /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/dbt_project.yml
[0m02:57:05.459015 [info ] [MainThread]: adapter type: snowflake
[0m02:57:05.459156 [info ] [MainThread]: adapter version: 1.10.0
[0m02:57:05.506559 [info ] [MainThread]: Configuration:
[0m02:57:05.506814 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:57:05.506953 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:57:05.507072 [info ] [MainThread]: Required dependencies:
[0m02:57:05.507437 [debug] [MainThread]: Executing "git --help"
[0m02:57:05.538998 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:57:05.539577 [debug] [MainThread]: STDERR: "b''"
[0m02:57:05.539775 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:57:05.539945 [info ] [MainThread]: Connection:
[0m02:57:05.540112 [info ] [MainThread]:   account: df47214.ap-south-1.aws
[0m02:57:05.540235 [info ] [MainThread]:   user: PLANETKART_USER
[0m02:57:05.540342 [info ] [MainThread]:   database: PLANETKART
[0m02:57:05.540449 [info ] [MainThread]:   warehouse: PLANETKART_WH
[0m02:57:05.540552 [info ] [MainThread]:   role: HEVO_DATA
[0m02:57:05.540657 [info ] [MainThread]:   schema: PLANETKART_ANALYTICS
[0m02:57:05.540765 [info ] [MainThread]:   authenticator: None
[0m02:57:05.540866 [info ] [MainThread]:   oauth_client_id: None
[0m02:57:05.540971 [info ] [MainThread]:   query_tag: None
[0m02:57:05.541072 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:57:05.541173 [info ] [MainThread]:   host: None
[0m02:57:05.541278 [info ] [MainThread]:   port: None
[0m02:57:05.541377 [info ] [MainThread]:   proxy_host: None
[0m02:57:05.541478 [info ] [MainThread]:   proxy_port: None
[0m02:57:05.541577 [info ] [MainThread]:   protocol: None
[0m02:57:05.541675 [info ] [MainThread]:   connect_retries: 1
[0m02:57:05.541775 [info ] [MainThread]:   connect_timeout: None
[0m02:57:05.541875 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:57:05.541977 [info ] [MainThread]:   retry_all: False
[0m02:57:05.542074 [info ] [MainThread]:   insecure_mode: False
[0m02:57:05.542174 [info ] [MainThread]:   reuse_connections: True
[0m02:57:05.542272 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m02:57:05.542602 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m02:57:05.606651 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:57:05.801712 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:57:05.801930 [debug] [MainThread]: On debug: select 1 as id
[0m02:57:05.802062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:06.369766 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.567 seconds
[0m02:57:06.372641 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:57:06.373452 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:57:06.381144 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.7188162, "process_in_blocks": "0", "process_kernel_time": 0.37609, "process_mem_max_rss": "147767296", "process_out_blocks": "0", "process_user_time": 1.192532}
[0m02:57:06.381550 [debug] [MainThread]: Command `dbt debug` succeeded at 02:57:06.381485 after 1.72 seconds
[0m02:57:06.381741 [debug] [MainThread]: Connection 'debug' was left open.
[0m02:57:06.381875 [debug] [MainThread]: On debug: Close
[0m02:57:06.509850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0e5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b478dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abbd6a0>]}
[0m02:57:06.510807 [debug] [MainThread]: Flushing usage events
[0m02:57:07.702954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:01:11.591684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fb750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fb610>]}


============================== 03:01:11.597986 | 2e59d73a-845a-4789-b3ee-a6fb3ca6ab63 ==============================
[0m03:01:11.597986 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:01:11.598356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:01:12.451473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e59d73a-845a-4789-b3ee-a6fb3ca6ab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067175c0>]}
[0m03:01:12.479410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e59d73a-845a-4789-b3ee-a6fb3ca6ab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0e690>]}
[0m03:01:12.481540 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:01:12.554219 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:01:12.558081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:01:12.558333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e59d73a-845a-4789-b3ee-a6fb3ca6ab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebb350>]}
[0m03:01:13.102154 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.planetkart_analytics.marts
- models.planetkart_analytics.staging
[0m03:01:13.107945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e59d73a-845a-4789-b3ee-a6fb3ca6ab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f01c70>]}
[0m03:01:13.145094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:01:13.150205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:01:13.198755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e59d73a-845a-4789-b3ee-a6fb3ca6ab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809eb30>]}
[0m03:01:13.199070 [info ] [MainThread]: Found 8 data tests, 5 sources, 477 macros
[0m03:01:13.199268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e59d73a-845a-4789-b3ee-a6fb3ca6ab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c7520>]}
[0m03:01:13.200310 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:01:13.215059 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:01:13.217731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:01:13.220817 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/sources.json
[0m03:01:13.220991 [info ] [MainThread]: Done.
[0m03:01:13.225781 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 1.6931207, "process_in_blocks": "0", "process_kernel_time": 0.363492, "process_mem_max_rss": "143179776", "process_out_blocks": "0", "process_user_time": 1.681163}
[0m03:01:13.226111 [debug] [MainThread]: Command `dbt source freshness` succeeded at 03:01:13.226056 after 1.69 seconds
[0m03:01:13.226335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074604d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b0c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b0aa0>]}
[0m03:01:13.226530 [debug] [MainThread]: Flushing usage events
[0m03:01:14.225728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:07:14.573198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a103750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a103610>]}


============================== 03:07:14.579847 | 7a51ead4-8d68-4ba9-96ad-7698f638bf00 ==============================
[0m03:07:14.579847 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:07:14.580207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:07:15.443549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a51ead4-8d68-4ba9-96ad-7698f638bf00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f235c0>]}
[0m03:07:15.472457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a51ead4-8d68-4ba9-96ad-7698f638bf00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afe6690>]}
[0m03:07:15.473818 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:07:15.544688 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:07:15.690493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:07:15.690746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:07:15.691150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.planetkart_analytics.marts
- models.planetkart_analytics.staging
[0m03:07:15.706192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a51ead4-8d68-4ba9-96ad-7698f638bf00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b386950>]}
[0m03:07:15.745913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:07:15.748852 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:07:15.779315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a51ead4-8d68-4ba9-96ad-7698f638bf00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afd67b0>]}
[0m03:07:15.779619 [info ] [MainThread]: Found 8 data tests, 5 sources, 477 macros
[0m03:07:15.779796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a51ead4-8d68-4ba9-96ad-7698f638bf00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b124f30>]}
[0m03:07:15.780123 [warn ] [MainThread]: The selection criterion 'stg_customers' does not match any enabled nodes
[0m03:07:15.780758 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:07:15.781797 [debug] [MainThread]: Command end result
[0m03:07:15.842508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:07:15.846618 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:07:15.849168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:07:15.852446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3507581, "process_in_blocks": "0", "process_kernel_time": 0.386725, "process_mem_max_rss": "138330112", "process_out_blocks": "0", "process_user_time": 1.359015}
[0m03:07:15.852837 [debug] [MainThread]: Command `dbt run` succeeded at 03:07:15.852772 after 1.35 seconds
[0m03:07:15.853074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6d7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a16c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b66a690>]}
[0m03:07:15.853290 [debug] [MainThread]: Flushing usage events
[0m03:07:16.891596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:11:02.794334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107203750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107203610>]}


============================== 03:11:02.800418 | ac11b3b7-7ec8-4eea-8773-cb03db47ff91 ==============================
[0m03:11:02.800418 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:11:02.800799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_customers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:11:03.568459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac11b3b7-7ec8-4eea-8773-cb03db47ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a235c0>]}
[0m03:11:03.596159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac11b3b7-7ec8-4eea-8773-cb03db47ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e6690>]}
[0m03:11:03.597497 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:11:03.666072 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:11:03.817875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:11:03.818231 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/staging/stg_customers.sql
[0m03:11:03.952547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.planetkart_analytics.marts
[0m03:11:03.960575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac11b3b7-7ec8-4eea-8773-cb03db47ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108687550>]}
[0m03:11:04.006687 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:11:04.009492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:11:04.052189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac11b3b7-7ec8-4eea-8773-cb03db47ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109165d60>]}
[0m03:11:04.052516 [info ] [MainThread]: Found 8 data tests, 1 model, 5 sources, 477 macros
[0m03:11:04.052716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac11b3b7-7ec8-4eea-8773-cb03db47ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934b690>]}
[0m03:11:04.053663 [info ] [MainThread]: 
[0m03:11:04.053883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:11:04.054031 [info ] [MainThread]: 
[0m03:11:04.054317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:11:04.054799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:11:04.239244 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:11:04.239471 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:11:04.239610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:05.263959 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.024 seconds
[0m03:11:05.269492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now create_PLANETKART_PLANETKART_ANALYTICS)
[0m03:11:05.270555 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "PLANETKART_ANALYTICS"
"
[0m03:11:05.276746 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_PLANETKART_ANALYTICS"
[0m03:11:05.277180 [debug] [ThreadPool]: On create_PLANETKART_PLANETKART_ANALYTICS: create schema if not exists PLANETKART.PLANETKART_ANALYTICS
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_PLANETKART_ANALYTICS"} */
[0m03:11:05.383903 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m03:11:05.389087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_PLANETKART_ANALYTICS, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:11:05.408156 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:11:05.408642 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:11:05.675465 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.266 seconds
[0m03:11:05.679831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac11b3b7-7ec8-4eea-8773-cb03db47ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b67450>]}
[0m03:11:05.688223 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:11:05.689209 [info ] [Thread-1 (]: 1 of 1 START sql view model PLANETKART_ANALYTICS.stg_customers ................. [RUN]
[0m03:11:05.689833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.stg_customers)
[0m03:11:05.690303 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:11:05.701287 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:11:05.705992 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:11:05.736452 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:11:05.741549 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:11:05.741896 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:11:06.371415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m03:11:06.405969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac11b3b7-7ec8-4eea-8773-cb03db47ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4ab10>]}
[0m03:11:06.406709 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PLANETKART_ANALYTICS.stg_customers ............ [[32mSUCCESS 1[0m in 0.71s]
[0m03:11:06.407303 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:11:06.408396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:11:06.408640 [debug] [MainThread]: Connection 'model.planetkart_analytics.stg_customers' was left open.
[0m03:11:06.408862 [debug] [MainThread]: On model.planetkart_analytics.stg_customers: Close
[0m03:11:06.560057 [info ] [MainThread]: 
[0m03:11:06.560971 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m03:11:06.562156 [debug] [MainThread]: Command end result
[0m03:11:06.665127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:11:06.674011 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:11:06.682111 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:11:06.682433 [info ] [MainThread]: 
[0m03:11:06.682808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:11:06.683066 [info ] [MainThread]: 
[0m03:11:06.683361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:11:06.689994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9554756, "process_in_blocks": "0", "process_kernel_time": 0.417993, "process_mem_max_rss": "157286400", "process_out_blocks": "0", "process_user_time": 1.690337}
[0m03:11:06.690567 [debug] [MainThread]: Command `dbt run` succeeded at 03:11:06.690466 after 3.96 seconds
[0m03:11:06.690963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c31630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c31770>]}
[0m03:11:06.691368 [debug] [MainThread]: Flushing usage events
[0m03:11:07.704747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:45.745093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108807750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108807610>]}


============================== 03:13:45.750900 | b9864068-2d0f-4e4d-929e-004b6702a8eb ==============================
[0m03:13:45.750900 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:13:45.751253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:13:46.586906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d235c0>]}
[0m03:13:46.615046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e6690>]}
[0m03:13:46.616888 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:13:46.688748 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:13:46.862781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m03:13:46.863172 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/staging/stg_order_items.sql
[0m03:13:46.863348 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/staging/stg_orders.sql
[0m03:13:46.986361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.planetkart_analytics.marts
[0m03:13:46.993751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c87650>]}
[0m03:13:47.037300 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:13:47.040824 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:13:47.083398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a767b60>]}
[0m03:13:47.083727 [info ] [MainThread]: Found 8 data tests, 3 models, 5 sources, 477 macros
[0m03:13:47.083921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab07070>]}
[0m03:13:47.084950 [info ] [MainThread]: 
[0m03:13:47.085157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:47.085307 [info ] [MainThread]: 
[0m03:13:47.085570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:13:47.088111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:13:47.299801 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:13:47.300035 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:13:47.300178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:48.123784 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.823 seconds
[0m03:13:48.129259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:13:48.146376 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:13:48.146837 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:13:48.252406 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m03:13:48.260547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93a9c0>]}
[0m03:13:48.268293 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:13:48.269131 [info ] [Thread-1 (]: 1 of 3 START sql view model PLANETKART_ANALYTICS.stg_customers ................. [RUN]
[0m03:13:48.269795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.stg_customers)
[0m03:13:48.270275 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:13:48.280880 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:13:48.283108 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:13:48.313667 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:13:48.316643 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:13:48.316966 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:13:49.193855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.876 seconds
[0m03:13:49.227737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b34d010>]}
[0m03:13:49.228455 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PLANETKART_ANALYTICS.stg_customers ............ [[32mSUCCESS 1[0m in 0.95s]
[0m03:13:49.228967 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:13:49.229308 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:13:49.229796 [info ] [Thread-1 (]: 2 of 3 START sql view model PLANETKART_ANALYTICS.stg_order_items ............... [RUN]
[0m03:13:49.230237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:13:49.230570 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:13:49.233221 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:13:49.235372 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:13:49.237623 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:13:49.239312 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:13:49.239607 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:13:49.707134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m03:13:49.712815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac21180>]}
[0m03:13:49.714269 [info ] [Thread-1 (]: 2 of 3 OK created sql view model PLANETKART_ANALYTICS.stg_order_items .......... [[32mSUCCESS 1[0m in 0.48s]
[0m03:13:49.715551 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:13:49.716118 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:13:49.716893 [info ] [Thread-1 (]: 3 of 3 START sql view model PLANETKART_ANALYTICS.stg_orders .................... [RUN]
[0m03:13:49.717631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:13:49.718174 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:13:49.722554 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:13:49.724825 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:13:49.728848 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:13:49.730914 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:13:49.731380 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:13:49.932020 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2b7-0001-2b8c-0000-000a0e0ad3e9
[0m03:13:49.933824 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function DATE_TRUNC does not support VARCHAR(16777216) argument type
[0m03:13:49.952368 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(16777216) argument type
  compiled code at target/run/planetkart_analytics/models/staging/stg_orders.sql
[0m03:13:49.953249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9864068-2d0f-4e4d-929e-004b6702a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b527070>]}
[0m03:13:49.954184 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model PLANETKART_ANALYTICS.stg_orders ........... [[31mERROR[0m in 0.24s]
[0m03:13:49.954979 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:13:49.955647 [debug] [Thread-4 (]: Marking all children of 'model.planetkart_analytics.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(16777216) argument type
  compiled code at target/run/planetkart_analytics/models/staging/stg_orders.sql.
[0m03:13:49.958094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:49.958546 [debug] [MainThread]: Connection 'model.planetkart_analytics.stg_orders' was left open.
[0m03:13:49.958932 [debug] [MainThread]: On model.planetkart_analytics.stg_orders: Close
[0m03:13:50.117259 [info ] [MainThread]: 
[0m03:13:50.118391 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m03:13:50.119584 [debug] [MainThread]: Command end result
[0m03:13:50.208557 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:13:50.215987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:13:50.226351 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:13:50.226744 [info ] [MainThread]: 
[0m03:13:50.227127 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:13:50.227602 [info ] [MainThread]: 
[0m03:13:50.228079 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m03:13:50.228481 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(16777216) argument type
  compiled code at target/run/planetkart_analytics/models/staging/stg_orders.sql
[0m03:13:50.228733 [info ] [MainThread]: 
[0m03:13:50.229033 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/staging/stg_orders.sql
[0m03:13:50.229278 [info ] [MainThread]: 
[0m03:13:50.229560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m03:13:50.235333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5626564, "process_in_blocks": "0", "process_kernel_time": 0.456619, "process_mem_max_rss": "159186944", "process_out_blocks": "0", "process_user_time": 1.748597}
[0m03:13:50.235968 [debug] [MainThread]: Command `dbt run` failed at 03:13:50.235868 after 4.56 seconds
[0m03:13:50.236399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106762350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088360b0>]}
[0m03:13:50.236745 [debug] [MainThread]: Flushing usage events
[0m03:13:51.341402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:14:41.989372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fcb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bf610>]}


============================== 03:14:41.995898 | 983b8839-8f45-4bbf-b1a2-d49bdac2ad4d ==============================
[0m03:14:41.995898 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:14:41.996255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:14:42.798984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047db5c0>]}
[0m03:14:42.826186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd6690>]}
[0m03:14:42.827831 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:14:42.903358 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:14:43.074044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:14:43.074425 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/staging/stg_orders.sql
[0m03:14:43.194059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.planetkart_analytics.marts
[0m03:14:43.201545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646f750>]}
[0m03:14:43.246611 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:14:43.251750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:14:43.307398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106507d40>]}
[0m03:14:43.307743 [info ] [MainThread]: Found 8 data tests, 3 models, 5 sources, 477 macros
[0m03:14:43.307951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649eeb0>]}
[0m03:14:43.309042 [info ] [MainThread]: 
[0m03:14:43.309263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:14:43.309428 [info ] [MainThread]: 
[0m03:14:43.309701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:14:43.312435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:14:43.530485 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:14:43.530723 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:14:43.530863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:14:44.043047 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.512 seconds
[0m03:14:44.048311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:14:44.065625 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:14:44.066078 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:14:44.157909 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.091 seconds
[0m03:14:44.164101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a35f0>]}
[0m03:14:44.170542 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:14:44.171290 [info ] [Thread-1 (]: 1 of 3 START sql view model PLANETKART_ANALYTICS.stg_customers ................. [RUN]
[0m03:14:44.171887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.stg_customers)
[0m03:14:44.172351 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:14:44.182645 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:14:44.201117 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:14:44.231170 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:14:44.248113 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:14:44.248518 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:14:44.805696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m03:14:44.838791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764d190>]}
[0m03:14:44.839525 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PLANETKART_ANALYTICS.stg_customers ............ [[32mSUCCESS 1[0m in 0.66s]
[0m03:14:44.840108 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:14:44.840515 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:14:44.841065 [info ] [Thread-1 (]: 2 of 3 START sql view model PLANETKART_ANALYTICS.stg_order_items ............... [RUN]
[0m03:14:44.841572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:14:44.841935 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:14:44.844918 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:14:44.847121 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:14:44.849316 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:14:44.851033 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:14:44.851356 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:14:45.033486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m03:14:45.038401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106804f70>]}
[0m03:14:45.039699 [info ] [Thread-1 (]: 2 of 3 OK created sql view model PLANETKART_ANALYTICS.stg_order_items .......... [[32mSUCCESS 1[0m in 0.20s]
[0m03:14:45.040782 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:14:45.041382 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:14:45.042086 [info ] [Thread-1 (]: 3 of 3 START sql view model PLANETKART_ANALYTICS.stg_orders .................... [RUN]
[0m03:14:45.042737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:14:45.043257 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:14:45.047476 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:14:45.049862 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:14:45.053793 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:14:45.056307 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:14:45.056808 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:14:45.226922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m03:14:45.231361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '983b8839-8f45-4bbf-b1a2-d49bdac2ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107726cb0>]}
[0m03:14:45.232303 [info ] [Thread-1 (]: 3 of 3 OK created sql view model PLANETKART_ANALYTICS.stg_orders ............... [[32mSUCCESS 1[0m in 0.19s]
[0m03:14:45.233072 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:14:45.234636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:14:45.235037 [debug] [MainThread]: Connection 'model.planetkart_analytics.stg_orders' was left open.
[0m03:14:45.235409 [debug] [MainThread]: On model.planetkart_analytics.stg_orders: Close
[0m03:14:45.376612 [info ] [MainThread]: 
[0m03:14:45.377194 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m03:14:45.378359 [debug] [MainThread]: Command end result
[0m03:14:45.471850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:14:45.480198 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:14:45.487934 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:14:45.488313 [info ] [MainThread]: 
[0m03:14:45.488712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:14:45.489012 [info ] [MainThread]: 
[0m03:14:45.489354 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m03:14:45.495401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5666997, "process_in_blocks": "0", "process_kernel_time": 0.42501, "process_mem_max_rss": "158646272", "process_out_blocks": "0", "process_user_time": 1.669023}
[0m03:14:45.495911 [debug] [MainThread]: Command `dbt run` succeeded at 03:14:45.495813 after 3.57 seconds
[0m03:14:45.496271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e22350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ee0b0>]}
[0m03:14:45.496612 [debug] [MainThread]: Flushing usage events
[0m03:14:46.639283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:19:08.722136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074af4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899f610>]}


============================== 03:19:08.728691 | 15e446ac-04c0-4553-9e6c-45da821fb6af ==============================
[0m03:19:08.728691 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:19:08.729072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m03:19:09.499293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbb5c0>]}
[0m03:19:09.527393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ba690>]}
[0m03:19:09.529317 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:19:09.626118 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:19:09.782190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m03:19:09.782577 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/staging/stg_products.sql
[0m03:19:09.782751 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/staging/stg_regions.sql
[0m03:19:09.907504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.planetkart_analytics.marts
[0m03:19:09.915231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109953850>]}
[0m03:19:09.960938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:19:09.966379 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:19:10.015133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ebf20>]}
[0m03:19:10.015441 [info ] [MainThread]: Found 8 data tests, 5 models, 5 sources, 477 macros
[0m03:19:10.015632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdecf0>]}
[0m03:19:10.016666 [info ] [MainThread]: 
[0m03:19:10.016875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:19:10.017027 [info ] [MainThread]: 
[0m03:19:10.017286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:19:10.019872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:19:10.231616 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:19:10.231852 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:19:10.231992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:19:11.132309 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.900 seconds
[0m03:19:11.135094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:19:11.145928 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:19:11.146280 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:19:11.267477 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.121 seconds
[0m03:19:11.272850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cab6c0>]}
[0m03:19:11.279732 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:19:11.280465 [info ] [Thread-1 (]: 1 of 4 START sql view model PLANETKART_ANALYTICS.stg_customers ................. [RUN]
[0m03:19:11.281050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.stg_customers)
[0m03:19:11.281516 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:19:11.291611 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:19:11.294093 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:19:11.322303 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:19:11.325051 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:19:11.325383 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:19:11.690453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m03:19:11.726250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0e990>]}
[0m03:19:11.727034 [info ] [Thread-1 (]: 1 of 4 OK created sql view model PLANETKART_ANALYTICS.stg_customers ............ [[32mSUCCESS 1[0m in 0.44s]
[0m03:19:11.727611 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:19:11.728001 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:19:11.728537 [info ] [Thread-1 (]: 2 of 4 START sql view model PLANETKART_ANALYTICS.stg_order_items ............... [RUN]
[0m03:19:11.729028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:19:11.729392 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:19:11.732649 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:19:11.750690 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:19:11.753162 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:19:11.767736 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:19:11.768104 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:19:11.963673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m03:19:11.969529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce10d0>]}
[0m03:19:11.970542 [info ] [Thread-1 (]: 2 of 4 OK created sql view model PLANETKART_ANALYTICS.stg_order_items .......... [[32mSUCCESS 1[0m in 0.24s]
[0m03:19:11.971316 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:19:11.971854 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:19:11.972585 [info ] [Thread-1 (]: 3 of 4 START sql view model PLANETKART_ANALYTICS.stg_orders .................... [RUN]
[0m03:19:11.973244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:19:11.973773 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:19:11.977980 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:19:11.988575 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:19:11.992430 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:19:12.005569 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:19:12.006064 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:19:12.333241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m03:19:12.337978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac19e50>]}
[0m03:19:12.338902 [info ] [Thread-1 (]: 3 of 4 OK created sql view model PLANETKART_ANALYTICS.stg_orders ............... [[32mSUCCESS 1[0m in 0.36s]
[0m03:19:12.340308 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:19:12.341093 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:19:12.341864 [info ] [Thread-1 (]: 4 of 4 START sql view model PLANETKART_ANALYTICS.stg_regions ................... [RUN]
[0m03:19:12.342549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_regions)
[0m03:19:12.343066 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:19:12.347490 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:19:12.349545 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:19:12.353393 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:19:12.356150 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:19:12.356679 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:19:12.522101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m03:19:12.526328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e446ac-04c0-4553-9e6c-45da821fb6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa39ad0>]}
[0m03:19:12.527728 [info ] [Thread-1 (]: 4 of 4 OK created sql view model PLANETKART_ANALYTICS.stg_regions .............. [[32mSUCCESS 1[0m in 0.18s]
[0m03:19:12.528806 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:19:12.530839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:19:12.531332 [debug] [MainThread]: Connection 'model.planetkart_analytics.stg_regions' was left open.
[0m03:19:12.531738 [debug] [MainThread]: On model.planetkart_analytics.stg_regions: Close
[0m03:19:12.671796 [info ] [MainThread]: 
[0m03:19:12.672646 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m03:19:12.674117 [debug] [MainThread]: Command end result
[0m03:19:12.774857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:19:12.783497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:19:12.793413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:19:12.793741 [info ] [MainThread]: 
[0m03:19:12.794086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:19:12.794350 [info ] [MainThread]: 
[0m03:19:12.794636 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m03:19:12.801080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1519604, "process_in_blocks": "0", "process_kernel_time": 0.458474, "process_mem_max_rss": "156844032", "process_out_blocks": "0", "process_user_time": 1.782468}
[0m03:19:12.801878 [debug] [MainThread]: Command `dbt run` succeeded at 03:19:12.801729 after 4.15 seconds
[0m03:19:12.802280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d20b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dd6d0>]}
[0m03:19:12.802652 [debug] [MainThread]: Flushing usage events
[0m03:19:13.907650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:19:41.443485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078db4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcf610>]}


============================== 03:19:41.448764 | 38e64360-be6a-44ae-adbf-30140b79fb8e ==============================
[0m03:19:41.448764 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:19:41.449134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:19:42.188838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080eb5c0>]}
[0m03:19:42.216926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e6690>]}
[0m03:19:42.218830 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:19:42.293899 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:19:42.460964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:19:42.461360 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/staging/stg_products.sql
[0m03:19:42.581417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.planetkart_analytics.marts
[0m03:19:42.589016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7f950>]}
[0m03:19:42.632771 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:19:42.637944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:19:42.696353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1bf20>]}
[0m03:19:42.696697 [info ] [MainThread]: Found 8 data tests, 5 models, 5 sources, 477 macros
[0m03:19:42.696896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0175b0>]}
[0m03:19:42.698043 [info ] [MainThread]: 
[0m03:19:42.698251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:19:42.698407 [info ] [MainThread]: 
[0m03:19:42.698692 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:19:42.701484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:19:42.944372 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:19:42.944607 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:19:42.944748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:19:43.485350 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.540 seconds
[0m03:19:43.490110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:19:43.506635 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:19:43.507132 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:19:43.668132 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.161 seconds
[0m03:19:43.672240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bf5f0>]}
[0m03:19:43.677832 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:19:43.678492 [info ] [Thread-1 (]: 1 of 5 START sql view model PLANETKART_ANALYTICS.stg_customers ................. [RUN]
[0m03:19:43.678990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.stg_customers)
[0m03:19:43.679381 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:19:43.687758 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:19:43.702062 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:19:43.726373 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:19:43.740945 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:19:43.741258 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:19:44.194917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m03:19:44.230886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af66bd0>]}
[0m03:19:44.231639 [info ] [Thread-1 (]: 1 of 5 OK created sql view model PLANETKART_ANALYTICS.stg_customers ............ [[32mSUCCESS 1[0m in 0.55s]
[0m03:19:44.232161 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:19:44.232523 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:19:44.233009 [info ] [Thread-1 (]: 2 of 5 START sql view model PLANETKART_ANALYTICS.stg_order_items ............... [RUN]
[0m03:19:44.233466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:19:44.233805 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:19:44.236729 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:19:44.239579 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:19:44.241778 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:19:44.244053 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:19:44.244383 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:19:44.629693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m03:19:44.636621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a111020>]}
[0m03:19:44.637899 [info ] [Thread-1 (]: 2 of 5 OK created sql view model PLANETKART_ANALYTICS.stg_order_items .......... [[32mSUCCESS 1[0m in 0.40s]
[0m03:19:44.639264 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:19:44.639904 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:19:44.640757 [info ] [Thread-1 (]: 3 of 5 START sql view model PLANETKART_ANALYTICS.stg_orders .................... [RUN]
[0m03:19:44.641545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:19:44.642064 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:19:44.646587 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:19:44.649528 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:19:44.654186 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:19:44.656723 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:19:44.657167 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:19:45.072158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m03:19:45.077855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a74cd0>]}
[0m03:19:45.079317 [info ] [Thread-1 (]: 3 of 5 OK created sql view model PLANETKART_ANALYTICS.stg_orders ............... [[32mSUCCESS 1[0m in 0.44s]
[0m03:19:45.080161 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:19:45.080675 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:19:45.081348 [info ] [Thread-1 (]: 4 of 5 START sql view model PLANETKART_ANALYTICS.stg_products .................. [RUN]
[0m03:19:45.082000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:19:45.082498 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:19:45.086904 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:19:45.089305 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:19:45.093109 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m03:19:45.095458 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m03:19:45.095971 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m03:19:45.334178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m03:19:45.340031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adbd350>]}
[0m03:19:45.341055 [info ] [Thread-1 (]: 4 of 5 OK created sql view model PLANETKART_ANALYTICS.stg_products ............. [[32mSUCCESS 1[0m in 0.26s]
[0m03:19:45.341836 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:19:45.342348 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:19:45.343039 [info ] [Thread-1 (]: 5 of 5 START sql view model PLANETKART_ANALYTICS.stg_regions ................... [RUN]
[0m03:19:45.343761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:19:45.344303 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:19:45.348736 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:19:45.350785 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:19:45.354753 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:19:45.357015 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:19:45.357487 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:19:45.619780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m03:19:45.627343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e64360-be6a-44ae-adbf-30140b79fb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b16e9e0>]}
[0m03:19:45.628158 [info ] [Thread-1 (]: 5 of 5 OK created sql view model PLANETKART_ANALYTICS.stg_regions .............. [[32mSUCCESS 1[0m in 0.28s]
[0m03:19:45.628711 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:19:45.629995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:19:45.630353 [debug] [MainThread]: Connection 'model.planetkart_analytics.stg_regions' was left open.
[0m03:19:45.630659 [debug] [MainThread]: On model.planetkart_analytics.stg_regions: Close
[0m03:19:45.769765 [info ] [MainThread]: 
[0m03:19:45.770577 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m03:19:45.772172 [debug] [MainThread]: Command end result
[0m03:19:45.877258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:19:45.885798 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:19:45.895076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:19:45.895476 [info ] [MainThread]: 
[0m03:19:45.895896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:19:45.896211 [info ] [MainThread]: 
[0m03:19:45.896581 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m03:19:45.903479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5208, "process_in_blocks": "0", "process_kernel_time": 0.429208, "process_mem_max_rss": "159449088", "process_out_blocks": "0", "process_user_time": 1.69801}
[0m03:19:45.904066 [debug] [MainThread]: Command `dbt run` succeeded at 03:19:45.903958 after 4.52 seconds
[0m03:19:45.904462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13f8f0>]}
[0m03:19:45.904824 [debug] [MainThread]: Flushing usage events
[0m03:19:47.291751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:19.764314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f03750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f03610>]}


============================== 03:25:19.771213 | 51303f90-cebb-4734-bd09-3f610757341a ==============================
[0m03:25:19.771213 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:25:19.771589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:25:20.687901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51303f90-cebb-4734-bd09-3f610757341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d75c0>]}
[0m03:25:20.715438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51303f90-cebb-4734-bd09-3f610757341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de6690>]}
[0m03:25:20.717287 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:25:20.788642 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:25:20.910446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:25:20.910819 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/marts/dim_customers.sql
[0m03:25:21.066656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51303f90-cebb-4734-bd09-3f610757341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111387950>]}
[0m03:25:21.109780 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:25:21.112844 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:25:21.147465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51303f90-cebb-4734-bd09-3f610757341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e6bf20>]}
[0m03:25:21.147782 [info ] [MainThread]: Found 8 data tests, 6 models, 5 sources, 477 macros
[0m03:25:21.147977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51303f90-cebb-4734-bd09-3f610757341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112067690>]}
[0m03:25:21.148987 [info ] [MainThread]: 
[0m03:25:21.149229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:25:21.149403 [info ] [MainThread]: 
[0m03:25:21.149672 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:25:21.150134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:25:21.394219 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:25:21.394450 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:25:21.394600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:21.861053 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.466 seconds
[0m03:25:21.872542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:25:21.888866 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:25:21.889320 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:25:21.991955 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.102 seconds
[0m03:25:21.998143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51303f90-cebb-4734-bd09-3f610757341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212f860>]}
[0m03:25:22.003372 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:25:22.004396 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS.dim_customers ................ [RUN]
[0m03:25:22.005100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.dim_customers)
[0m03:25:22.005580 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:25:22.017271 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:25:22.020161 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:25:22.053340 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m03:25:22.056733 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m03:25:22.057180 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        -- Order behavior metrics
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        
        -- Revenue metrics (what customer pays)
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        
        -- Profit metrics (revenue - product cost)
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        
        -- Timing metrics
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select *,
    -- Business Intelligence Segments
    case 
        when total_revenue >= 150 then 'High_Value'      -- $150+ (our top customers)
        when total_revenue >= 80 then 'Medium_Value'     -- $80-149 (solid customers)
        when total_revenue > 0 then 'Low_Value'          -- Under $80 (growth opportunity)
        else 'No_Purchase'                               -- Never bought (activation needed)
    end as revenue_segment,
    
    -- Profitability segments (the real business metric)
    case 
        when total_profit >= 20 then 'Highly_Profitable'  -- $20+ profit
        when total_profit >= 5 then 'Profitable'          -- $5-19 profit  
        when total_profit > 0 then 'Low_Profit'           -- $1-4 profit
        else 'Unprofitable'                                -- $0 or negative
    end as profit_segment,
    
    -- Customer lifecycle stage
    case 
        when total_orders = 0 then 'Never_Purchased'
        when days_since_last_order <= 30 then 'Active'    -- Bought recently
        when days_since_last_order <= 90 then 'At_Risk'   -- Haven't bought in 1-3 months
        else 'Churned'                                     -- Haven't bought in 3+ months
    end as lifecycle_stage,
    
    -- Profit margin (how efficient each customer is)
    case 
        when total_revenue > 0 then round((total_profit / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m03:25:23.513701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.456 seconds
[0m03:25:23.547405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51303f90-cebb-4734-bd09-3f610757341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127562d0>]}
[0m03:25:23.548148 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PLANETKART_ANALYTICS.dim_customers ........... [[32mSUCCESS 1[0m in 1.54s]
[0m03:25:23.548726 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:25:23.549858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:23.550202 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_customers' was left open.
[0m03:25:23.550480 [debug] [MainThread]: On model.planetkart_analytics.dim_customers: Close
[0m03:25:23.888453 [info ] [MainThread]: 
[0m03:25:23.889286 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m03:25:23.890467 [debug] [MainThread]: Command end result
[0m03:25:23.988423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:25:23.996530 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:25:24.007143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:25:24.007507 [info ] [MainThread]: 
[0m03:25:24.007919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:25:24.008195 [info ] [MainThread]: 
[0m03:25:24.008496 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:25:24.014906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3285522, "process_in_blocks": "0", "process_kernel_time": 0.454268, "process_mem_max_rss": "154451968", "process_out_blocks": "0", "process_user_time": 1.819329}
[0m03:25:24.015562 [debug] [MainThread]: Command `dbt run` succeeded at 03:25:24.015435 after 4.33 seconds
[0m03:25:24.016030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11283c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112403f70>]}
[0m03:25:24.016451 [debug] [MainThread]: Flushing usage events
[0m03:25:25.015162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:27:29.178486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108857750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108857610>]}


============================== 03:27:29.185419 | 8032651b-15a8-4d78-8afe-3817221aacfc ==============================
[0m03:27:29.185419 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:27:29.185795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_products', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:27:30.019340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8032651b-15a8-4d78-8afe-3817221aacfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b735c0>]}
[0m03:27:30.047451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8032651b-15a8-4d78-8afe-3817221aacfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936e690>]}
[0m03:27:30.049573 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:27:30.124173 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:27:30.295989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:27:30.296348 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/marts/dim_products.sql
[0m03:27:30.425098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8032651b-15a8-4d78-8afe-3817221aacfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109807950>]}
[0m03:27:30.468656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:27:30.473497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:27:30.531780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8032651b-15a8-4d78-8afe-3817221aacfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a3f20>]}
[0m03:27:30.532119 [info ] [MainThread]: Found 8 data tests, 7 models, 5 sources, 477 macros
[0m03:27:30.532344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8032651b-15a8-4d78-8afe-3817221aacfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a97770>]}
[0m03:27:30.533378 [info ] [MainThread]: 
[0m03:27:30.533601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:30.533759 [info ] [MainThread]: 
[0m03:27:30.534039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:27:30.534551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:27:30.745276 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:27:30.745532 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:27:30.745688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:31.283378 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.537 seconds
[0m03:27:31.295337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:27:31.309919 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:27:31.310330 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:27:31.418579 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.108 seconds
[0m03:27:31.425527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8032651b-15a8-4d78-8afe-3817221aacfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b67860>]}
[0m03:27:31.431161 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:27:31.431775 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS.dim_products ................. [RUN]
[0m03:27:31.432253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.dim_products)
[0m03:27:31.432629 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:27:31.442075 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:27:31.443979 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:27:31.470646 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m03:27:31.473402 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m03:27:31.473797 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        -- Sales performance
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        
        -- Profitability metrics
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        
        -- Performance tracking
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select *,
    -- Profitability segments
    case 
        when total_profit >= 30 then 'High_Profit'      -- Top profit makers
        when total_profit >= 10 then 'Medium_Profit'    -- Solid performers  
        when total_profit > 0 then 'Low_Profit'         -- Break-even products
        when total_profit < 0 then 'Loss_Making'        -- Problem products
        else 'Never_Sold'                               -- Dead inventory
    end as profit_segment,
    
    -- Sales performance
    case 
        when total_sales >= 3 then 'Best_Seller'        -- High volume
        when total_sales >= 2 then 'Good_Seller'        -- Medium volume
        when total_sales = 1 then 'Slow_Mover'          -- Low volume
        else 'No_Sales'                                  -- Zero sales
    end as sales_performance,
    
    -- Profit margin efficiency 
    case 
        when total_revenue > 0 then round((total_profit / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    -- Pricing strategy insight
    case 
        when avg_selling_price > cost * 2 then 'Premium_Pricing'    -- 100%+ markup
        when avg_selling_price > cost * 1.5 then 'Standard_Pricing' -- 50%+ markup  
        when avg_selling_price > cost then 'Competitive_Pricing'    -- Some markup
        else 'Below_Cost'                                            -- Losing money
    end as pricing_strategy

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m03:27:33.197496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.723 seconds
[0m03:27:33.223890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8032651b-15a8-4d78-8afe-3817221aacfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ee2d0>]}
[0m03:27:33.224687 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PLANETKART_ANALYTICS.dim_products ............ [[32mSUCCESS 1[0m in 1.79s]
[0m03:27:33.225290 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:27:33.226922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:33.227336 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_products' was left open.
[0m03:27:33.227800 [debug] [MainThread]: On model.planetkart_analytics.dim_products: Close
[0m03:27:33.327780 [info ] [MainThread]: 
[0m03:27:33.328100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m03:27:33.328471 [debug] [MainThread]: Command end result
[0m03:27:33.387032 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:27:33.391729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:27:33.396266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:27:33.396568 [info ] [MainThread]: 
[0m03:27:33.396832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:27:33.397040 [info ] [MainThread]: 
[0m03:27:33.397218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:27:33.400908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.289208, "process_in_blocks": "0", "process_kernel_time": 0.460409, "process_mem_max_rss": "157417472", "process_out_blocks": "0", "process_user_time": 1.743357}
[0m03:27:33.401212 [debug] [MainThread]: Command `dbt run` succeeded at 03:27:33.401161 after 4.29 seconds
[0m03:27:33.401413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061572f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad6490>]}
[0m03:27:33.401596 [debug] [MainThread]: Flushing usage events
[0m03:27:34.389744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:29:05.395413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a7610>]}


============================== 03:29:05.400950 | 98019189-200f-4c9e-98a5-bcd8c30d826a ==============================
[0m03:29:05.400950 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:29:05.401328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_orders', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:29:06.203410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98019189-200f-4c9e-98a5-bcd8c30d826a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c35c0>]}
[0m03:29:06.230739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98019189-200f-4c9e-98a5-bcd8c30d826a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc2690>]}
[0m03:29:06.232940 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:29:06.307789 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:29:06.477446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:29:06.477864 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://models/marts/fact_orders.sql
[0m03:29:06.608142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98019189-200f-4c9e-98a5-bcd8c30d826a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625bb50>]}
[0m03:29:06.651798 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:29:06.656495 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:29:06.687407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98019189-200f-4c9e-98a5-bcd8c30d826a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f7f20>]}
[0m03:29:06.687724 [info ] [MainThread]: Found 8 data tests, 8 models, 5 sources, 477 macros
[0m03:29:06.687908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98019189-200f-4c9e-98a5-bcd8c30d826a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ef770>]}
[0m03:29:06.688851 [info ] [MainThread]: 
[0m03:29:06.689036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:29:06.689168 [info ] [MainThread]: 
[0m03:29:06.689421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:29:06.689848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:29:06.908245 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:29:06.908485 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:29:06.908631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:07.572703 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.664 seconds
[0m03:29:07.579874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS)
[0m03:29:07.590435 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS"
[0m03:29:07.590715 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS: show objects in PLANETKART.PLANETKART_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS"} */;
[0m03:29:07.893835 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.303 seconds
[0m03:29:07.900716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98019189-200f-4c9e-98a5-bcd8c30d826a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107418ef0>]}
[0m03:29:07.905767 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:29:07.906263 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS.fact_orders .................. [RUN]
[0m03:29:07.906636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS, now model.planetkart_analytics.fact_orders)
[0m03:29:07.906927 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:29:07.915248 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:29:07.917254 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:29:07.949095 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:29:07.952332 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:29:07.952783 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        o.order_date,
        o.order_status,
        o.order_month,
        
        -- Join dimension keys
        c.region_id,
        r.planet,
        r.zone,
        
        -- Order-level aggregations
        count(oi.product_id) as products_in_order,
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        
        -- Customer insights
        c.customer_tenure,
        c.revenue_segment,
        c.profit_segment as customer_profit_segment
        
    from PLANETKART.PLANETKART_ANALYTICS.stg_orders o
    join PLANETKART.PLANETKART_ANALYTICS.stg_customers c on o.customer_id = c.customer_id
    join PLANETKART.PLANETKART_ANALYTICS.stg_regions r on c.region_id = r.region_id
    left join PLANETKART.PLANETKART_ANALYTICS.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6,7,8,9,10,11,12
)

select *,
    -- Order profitability analysis
    case 
        when order_profit >= 20 then 'High_Profit_Order'
        when order_profit >= 5 then 'Profitable_Order'  
        when order_profit > 0 then 'Low_Profit_Order'
        else 'Unprofitable_Order'
    end as order_profit_segment,
    
    -- Order size analysis
    case 
        when order_revenue >= 150 then 'Large_Order'
        when order_revenue >= 80 then 'Medium_Order'
        when order_revenue > 0 then 'Small_Order'
        else 'Zero_Order'
    end as order_size_segment,
    
    -- Regional performance
    case 
        when planet = 'Earth' then 'Home_Planet'
        when planet in ('Mars', 'Venus') then 'Expansion_Planet'
        else 'Other_Planet'
    end as planet_category,
    
    -- Profit margin per order
    case 
        when order_revenue > 0 then round((order_profit / order_revenue) * 100, 1)
        else 0 
    end as order_margin_pct,
    
    -- Order completion success
    case when order_status = 'completed' then 1 else 0 end as is_completed

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:29:08.176334 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2c7-0001-2b8c-0000-000a0e0ad419
[0m03:29:08.177016 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'C.REVENUE_SEGMENT'
[0m03:29:08.183488 [debug] [Thread-1 (]: Database Error in model fact_orders (models/marts/fact_orders.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'C.REVENUE_SEGMENT'
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql
[0m03:29:08.186349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98019189-200f-4c9e-98a5-bcd8c30d826a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077562d0>]}
[0m03:29:08.187034 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PLANETKART_ANALYTICS.fact_orders ......... [[31mERROR[0m in 0.28s]
[0m03:29:08.187464 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:29:08.188914 [debug] [Thread-4 (]: Marking all children of 'model.planetkart_analytics.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models/marts/fact_orders.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'C.REVENUE_SEGMENT'
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql.
[0m03:29:08.190280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:08.190508 [debug] [MainThread]: Connection 'model.planetkart_analytics.fact_orders' was left open.
[0m03:29:08.190702 [debug] [MainThread]: On model.planetkart_analytics.fact_orders: Close
[0m03:29:08.324003 [info ] [MainThread]: 
[0m03:29:08.324711 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m03:29:08.325630 [debug] [MainThread]: Command end result
[0m03:29:08.412753 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:29:08.420788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:29:08.430875 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:29:08.431173 [info ] [MainThread]: 
[0m03:29:08.431486 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:29:08.431738 [info ] [MainThread]: 
[0m03:29:08.432045 [error] [MainThread]: [31mFailure in model fact_orders (models/marts/fact_orders.sql)[0m
[0m03:29:08.432333 [error] [MainThread]:   Database Error in model fact_orders (models/marts/fact_orders.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'C.REVENUE_SEGMENT'
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql
[0m03:29:08.432550 [info ] [MainThread]: 
[0m03:29:08.432816 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/fact_orders.sql
[0m03:29:08.433017 [info ] [MainThread]: 
[0m03:29:08.433260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m03:29:08.439079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.108403, "process_in_blocks": "0", "process_kernel_time": 0.457686, "process_mem_max_rss": "158695424", "process_out_blocks": "0", "process_user_time": 1.746495}
[0m03:29:08.439620 [debug] [MainThread]: Command `dbt run` failed at 03:29:08.439533 after 3.11 seconds
[0m03:29:08.439986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107820b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107838eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783bc50>]}
[0m03:29:08.440308 [debug] [MainThread]: Flushing usage events
[0m03:29:09.522032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:35:19.366507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040474d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105537750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105537610>]}


============================== 03:35:19.372471 | 1762d49e-1463-455b-8d0d-f5cf358eeebc ==============================
[0m03:35:19.372471 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:35:19.372861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:35:19.448240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1762d49e-1463-455b-8d0d-f5cf358eeebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048535c0>]}
[0m03:35:19.523380 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:35:19.524419 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:35:19.527776 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.22623895, "process_in_blocks": "0", "process_kernel_time": 0.241631, "process_mem_max_rss": "109838336", "process_out_blocks": "0", "process_user_time": 0.887255}
[0m03:35:19.528152 [debug] [MainThread]: Command `dbt deps` succeeded at 03:35:19.528076 after 0.23 seconds
[0m03:35:19.528396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d7450>]}
[0m03:35:19.528636 [debug] [MainThread]: Flushing usage events
[0m03:35:20.631798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:36:31.518362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b703750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b703610>]}


============================== 03:36:31.524806 | 04e3e15e-615b-4032-80ff-9d9d3afc1aa4 ==============================
[0m03:36:31.524806 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:36:31.525179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:36:31.607530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04e3e15e-615b-4032-80ff-9d9d3afc1aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d235c0>]}
[0m03:36:31.646372 [debug] [MainThread]: Set downloads directory='/var/folders/gk/y9r2f2nn7ps2p50hk52tq3hh0000gp/T/dbt-downloads-k9cqtvam'
[0m03:36:31.646754 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:36:31.969003 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:36:31.971194 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:36:32.121362 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:36:32.143412 [info ] [MainThread]: Updating lock file in file path: /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/package-lock.yml
[0m03:36:32.155510 [debug] [MainThread]: Set downloads directory='/var/folders/gk/y9r2f2nn7ps2p50hk52tq3hh0000gp/T/dbt-downloads-0udyrg76'
[0m03:36:32.159379 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:36:32.793304 [info ] [MainThread]: Installed from version 1.1.1
[0m03:36:32.793557 [info ] [MainThread]: Updated version available: 1.3.0
[0m03:36:32.793745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '04e3e15e-615b-4032-80ff-9d9d3afc1aa4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5fa7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f9e10>]}
[0m03:36:32.793940 [info ] [MainThread]: 
[0m03:36:32.794091 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m03:36:32.796759 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3504285, "process_in_blocks": "0", "process_kernel_time": 0.345229, "process_mem_max_rss": "113541120", "process_out_blocks": "0", "process_user_time": 1.043787}
[0m03:36:32.797057 [debug] [MainThread]: Command `dbt deps` succeeded at 03:36:32.796997 after 1.35 seconds
[0m03:36:32.797244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b592030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7dd040>]}
[0m03:36:32.797418 [debug] [MainThread]: Flushing usage events
[0m03:36:33.800936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:41:10.655285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a07610>]}


============================== 03:41:10.661964 | fbb530c7-4bb8-44b3-bb9c-00a977c3b19d ==============================
[0m03:41:10.661964 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:41:10.662337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:41:11.506600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b35c0>]}
[0m03:41:11.534695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9e6690>]}
[0m03:41:11.536323 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:41:11.613939 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:41:11.671306 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m03:41:11.671563 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:41:11.671732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af8b150>]}
[0m03:41:12.786325 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `customers` in file
`models/staging/_sources.yml`. The `freshness` top-level property should be
moved into the `config` of `customers`.
[0m03:41:12.786634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b610f50>]}
[0m03:41:12.848481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac72cf0>]}
[0m03:41:12.901515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:41:12.906268 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:41:12.966757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b00add0>]}
[0m03:41:12.967103 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 591 macros
[0m03:41:12.967306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8d07d0>]}
[0m03:41:12.968709 [info ] [MainThread]: 
[0m03:41:12.968920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:12.969078 [info ] [MainThread]: 
[0m03:41:12.969358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:41:12.969861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:41:13.186392 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:41:13.186629 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:41:13.186770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:13.798442 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.611 seconds
[0m03:41:13.803126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now create_PLANETKART_snapshots)
[0m03:41:13.804498 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "snapshots"
"
[0m03:41:13.811409 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_snapshots"
[0m03:41:13.811939 [debug] [ThreadPool]: On create_PLANETKART_snapshots: create schema if not exists PLANETKART.snapshots
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_snapshots"} */
[0m03:41:13.989526 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.177 seconds
[0m03:41:14.001686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:41:14.018051 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:41:14.018425 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:41:14.171881 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdd2d3-0001-2b9d-0000-000a0e0ae1f1
[0m03:41:14.172650 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:41:14.173481 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:41:14.174128 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:41:14.175034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:41:14.179067 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:41:14.179524 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:41:14.274927 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdd2d3-0001-2a72-0000-000a0e0a2cb9
[0m03:41:14.276116 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:41:14.277201 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:41:14.277969 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:41:14.279415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now list_PLANETKART_snapshots)
[0m03:41:14.285703 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:41:14.286287 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:41:14.385302 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.098 seconds
[0m03:41:14.390850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c993490>]}
[0m03:41:14.398394 [debug] [Thread-1 (]: Began running node snapshot.planetkart_analytics.snap_customers
[0m03:41:14.399376 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_customers ................................. [RUN]
[0m03:41:14.400338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now snapshot.planetkart_analytics.snap_customers)
[0m03:41:14.401076 [debug] [Thread-1 (]: Began compiling node snapshot.planetkart_analytics.snap_customers
[0m03:41:14.413644 [debug] [Thread-1 (]: Began executing node snapshot.planetkart_analytics.snap_customers
[0m03:41:14.475191 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m03:41:14.475529 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(signup_date as varchar ), '')
        ) as dbt_scd_id,
        signup_date as dbt_updated_at,
        signup_date as dbt_valid_from,
        
  
  coalesce(nullif(signup_date, signup_date), null)
  as dbt_valid_to
from (
        



select 
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date
from planetkart.planetkart_raw.customers

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m03:41:14.584323 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d3-0001-2a9a-0000-000a0e0a4b89
[0m03:41:14.584762 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 4
invalid identifier 'CUSTOMER_NAME'
[0m03:41:14.594111 [debug] [Thread-1 (]: Database Error in snapshot snap_customers (snapshots/snap_customers.sql)
  000904 (42000): SQL compilation error: error line 22 at position 4
  invalid identifier 'CUSTOMER_NAME'
[0m03:41:14.596949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbb530c7-4bb8-44b3-bb9c-00a977c3b19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106383890>]}
[0m03:41:14.597686 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.snap_customers ............................. [[31mERROR[0m in 0.19s]
[0m03:41:14.598187 [debug] [Thread-1 (]: Finished running node snapshot.planetkart_analytics.snap_customers
[0m03:41:14.598616 [debug] [Thread-4 (]: Marking all children of 'snapshot.planetkart_analytics.snap_customers' to be skipped because of status 'error'.  Reason: Database Error in snapshot snap_customers (snapshots/snap_customers.sql)
  000904 (42000): SQL compilation error: error line 22 at position 4
  invalid identifier 'CUSTOMER_NAME'.
[0m03:41:14.600105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:14.600357 [debug] [MainThread]: Connection 'snapshot.planetkart_analytics.snap_customers' was left open.
[0m03:41:14.600595 [debug] [MainThread]: On snapshot.planetkart_analytics.snap_customers: Close
[0m03:41:14.735744 [info ] [MainThread]: 
[0m03:41:14.736527 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m03:41:14.737681 [debug] [MainThread]: Command end result
[0m03:41:14.865937 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:41:14.872880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:41:14.879748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:41:14.880055 [info ] [MainThread]: 
[0m03:41:14.880404 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:41:14.880684 [info ] [MainThread]: 
[0m03:41:14.881035 [error] [MainThread]: [31mFailure in snapshot snap_customers (snapshots/snap_customers.sql)[0m
[0m03:41:14.881354 [error] [MainThread]:   Database Error in snapshot snap_customers (snapshots/snap_customers.sql)
  000904 (42000): SQL compilation error: error line 22 at position 4
  invalid identifier 'CUSTOMER_NAME'
[0m03:41:14.881603 [info ] [MainThread]: 
[0m03:41:14.881873 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m03:41:14.882369 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:41:14.890843 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 4.302035, "process_in_blocks": "0", "process_kernel_time": 0.490928, "process_mem_max_rss": "169000960", "process_out_blocks": "0", "process_user_time": 2.546319}
[0m03:41:14.891464 [debug] [MainThread]: Command `dbt snapshot` failed at 03:41:14.891358 after 4.30 seconds
[0m03:41:14.891875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106389850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8a4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a360b0>]}
[0m03:41:14.892235 [debug] [MainThread]: Flushing usage events
[0m03:41:15.882484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:41:54.274243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104877750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104877610>]}


============================== 03:41:54.280761 | c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256 ==============================
[0m03:41:54.280761 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:41:54.281140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:41:55.142271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b935c0>]}
[0m03:41:55.171301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e6690>]}
[0m03:41:55.173264 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:41:55.247299 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:41:55.450345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:41:55.450771 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://snapshots/snap_customers.sql
[0m03:41:55.581619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795c250>]}
[0m03:41:55.634955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:41:55.640167 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:41:55.690895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d72f0>]}
[0m03:41:55.691233 [info ] [MainThread]: Found 9 models, 23 data tests, 1 snapshot, 5 sources, 591 macros
[0m03:41:55.691464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bd550>]}
[0m03:41:55.692842 [info ] [MainThread]: 
[0m03:41:55.693053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:55.693210 [info ] [MainThread]: 
[0m03:41:55.693483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:41:55.693999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:41:55.900727 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:41:55.900960 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:41:55.901104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:56.520408 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.619 seconds
[0m03:41:56.533822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_snapshots)
[0m03:41:56.551293 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:41:56.551705 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:41:56.641804 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.090 seconds
[0m03:41:56.645390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:41:56.648794 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:41:56.649239 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:41:56.798483 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdd2d3-0001-2b93-0000-000a0e0ac4f5
[0m03:41:56.799356 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:41:56.800101 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:41:56.800523 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:41:56.801345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:41:56.805617 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:41:56.806105 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:41:56.890520 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdd2d3-0001-2b9d-0000-000a0e0ae1f5
[0m03:41:56.891118 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:41:56.891564 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:41:56.891863 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:41:56.892544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203c1b20>]}
[0m03:41:56.897554 [debug] [Thread-1 (]: Began running node snapshot.planetkart_analytics.snap_customers
[0m03:41:56.898174 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_customers ................................. [RUN]
[0m03:41:56.898651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now snapshot.planetkart_analytics.snap_customers)
[0m03:41:56.899036 [debug] [Thread-1 (]: Began compiling node snapshot.planetkart_analytics.snap_customers
[0m03:41:56.907928 [debug] [Thread-1 (]: Began executing node snapshot.planetkart_analytics.snap_customers
[0m03:41:56.965031 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m03:41:56.965380 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(signup_date as varchar ), '')
        ) as dbt_scd_id,
        signup_date as dbt_updated_at,
        signup_date as dbt_valid_from,
        
  
  coalesce(nullif(signup_date, signup_date), null)
  as dbt_valid_to
from (
        



select 
    customer_id,
    first_name,
    last_name,
    email,
    region_id,
    signup_date
from planetkart.planetkart_raw.customers

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m03:41:57.489364 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.523 seconds
[0m03:41:57.496722 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m03:41:57.496977 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m03:41:57.580791 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m03:41:57.582213 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TEXT). Please update snapshot config 'updated_at'.
[0m03:41:57.583870 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.planetkart_analytics.snap_customers"
[0m03:41:57.590790 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m03:41:57.591895 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: create or replace transient table PLANETKART.snapshots.snap_customers
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(signup_date as varchar ), '')
        ) as dbt_scd_id,
        signup_date as dbt_updated_at,
        signup_date as dbt_valid_from,
        
  
  coalesce(nullif(signup_date, signup_date), null)
  as dbt_valid_to
from (
        



select 
    customer_id,
    first_name,
    last_name,
    email,
    region_id,
    signup_date
from planetkart.planetkart_raw.customers

    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */;
[0m03:41:58.379417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m03:41:58.417597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34f4e8d-5c98-4b37-b5a5-ec7df4e0c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12021d310>]}
[0m03:41:58.418590 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_customers ................................. [[32mSUCCESS 1[0m in 1.51s]
[0m03:41:58.419187 [debug] [Thread-1 (]: Finished running node snapshot.planetkart_analytics.snap_customers
[0m03:41:58.420346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:58.420642 [debug] [MainThread]: Connection 'snapshot.planetkart_analytics.snap_customers' was left open.
[0m03:41:58.420902 [debug] [MainThread]: On snapshot.planetkart_analytics.snap_customers: Close
[0m03:41:58.530148 [info ] [MainThread]: 
[0m03:41:58.530813 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m03:41:58.531727 [debug] [MainThread]: Command end result
[0m03:41:58.653422 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:41:58.661445 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:41:58.671441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:41:58.671793 [info ] [MainThread]: 
[0m03:41:58.672171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:41:58.672451 [info ] [MainThread]: 
[0m03:41:58.672747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:41:58.679064 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 4.4747624, "process_in_blocks": "0", "process_kernel_time": 0.472197, "process_mem_max_rss": "162234368", "process_out_blocks": "0", "process_user_time": 1.887953}
[0m03:41:58.679727 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:41:58.679583 after 4.48 seconds
[0m03:41:58.680159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203c75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120398690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120398550>]}
[0m03:41:58.680539 [debug] [MainThread]: Flushing usage events
[0m03:41:59.737902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:42:08.364245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f8b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547f610>]}


============================== 03:42:08.371069 | 6a74031c-4e4d-4bcc-9c3a-d69cdccde6a5 ==============================
[0m03:42:08.371069 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:42:08.371450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m03:42:09.189195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a74031c-4e4d-4bcc-9c3a-d69cdccde6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479b5c0>]}
[0m03:42:09.217280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a74031c-4e4d-4bcc-9c3a-d69cdccde6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5e690>]}
[0m03:42:09.219305 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:42:09.296345 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:42:09.503821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:42:09.504063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:42:09.533427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a74031c-4e4d-4bcc-9c3a-d69cdccde6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650c150>]}
[0m03:42:09.585348 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:42:09.590407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:42:09.664968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a74031c-4e4d-4bcc-9c3a-d69cdccde6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b8c80>]}
[0m03:42:09.665345 [info ] [MainThread]: Found 9 models, 23 data tests, 1 snapshot, 5 sources, 591 macros
[0m03:42:09.665568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a74031c-4e4d-4bcc-9c3a-d69cdccde6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747add0>]}
[0m03:42:09.667439 [info ] [MainThread]: 
[0m03:42:09.667663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:42:09.667825 [info ] [MainThread]: 
[0m03:42:09.668127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:42:09.671425 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART_PLANETKART_ANALYTICS_stage'
[0m03:42:09.892158 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:42:09.892401 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:42:09.892554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:10.438333 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2a9a-0000-000a0e0a4b91
[0m03:42:10.439412 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:42:10.440186 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:42:10.440583 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:42:10.441643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now list_PLANETKART_snapshots)
[0m03:42:10.446327 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:42:10.446977 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:42:10.600304 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.153 seconds
[0m03:42:10.604759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:42:10.608679 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:42:10.609189 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:42:10.749021 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b93-0000-000a0e0ac4f9
[0m03:42:10.750238 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:42:10.751350 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:42:10.752121 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:42:10.753071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a74031c-4e4d-4bcc-9c3a-d69cdccde6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ff380>]}
[0m03:42:10.759662 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:42:10.760364 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase  [RUN]
[0m03:42:10.761018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13)
[0m03:42:10.761538 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:42:10.784584 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m03:42:10.788163 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:42:10.809729 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m03:42:10.812710 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m03:42:10.813053 [debug] [Thread-1 (]: On test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        revenue_segment as value_field,
        count(*) as n_records

    from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
    group by revenue_segment

)

select *
from all_values
where value_field not in (
    'High_Value','Medium_Value','Low_Value','No_Purchase'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"} */
[0m03:42:10.909014 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b9d-0000-000a0e0ae1fd
[0m03:42:10.909670 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:10.918912 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/accepted_values_dim_customers_c310fde78f10c64bf3a48992e1226420.sql
[0m03:42:10.919620 [error] [Thread-1 (]: 1 of 23 ERROR accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase  [[31mERROR[0m in 0.16s]
[0m03:42:10.920313 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:42:10.920772 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:42:10.921312 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/accepted_values_dim_customers_c310fde78f10c64bf3a48992e1226420.sql.
[0m03:42:10.921768 [info ] [Thread-1 (]: 2 of 23 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m03:42:10.923051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13, now test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m03:42:10.923518 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:42:10.930537 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m03:42:10.932216 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:42:10.935080 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m03:42:10.936570 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m03:42:10.936951 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */
[0m03:42:11.018127 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2a72-0000-000a0e0a2cc1
[0m03:42:11.018784 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.027369 [debug] [Thread-1 (]: Database Error in test not_null_dim_customers_customer_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_id.sql
[0m03:42:11.028132 [error] [Thread-1 (]: 2 of 23 ERROR not_null_dim_customers_customer_id ............................... [[31mERROR[0m in 0.10s]
[0m03:42:11.028905 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:42:11.029418 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:42:11.030022 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_customers_customer_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_id.sql.
[0m03:42:11.030467 [info ] [Thread-1 (]: 3 of 23 START test not_null_dim_customers_customer_sk .......................... [RUN]
[0m03:42:11.031049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863)
[0m03:42:11.031452 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:42:11.036316 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m03:42:11.038420 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:42:11.042103 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m03:42:11.043929 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m03:42:11.044315 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
where customer_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"} */
[0m03:42:11.138980 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2a9a-0000-000a0e0a4b95
[0m03:42:11.140183 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.149444 [debug] [Thread-1 (]: Database Error in test not_null_dim_customers_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_sk.sql
[0m03:42:11.150198 [error] [Thread-1 (]: 3 of 23 ERROR not_null_dim_customers_customer_sk ............................... [[31mERROR[0m in 0.12s]
[0m03:42:11.150936 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:42:11.151428 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:42:11.152091 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_customers_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_sk.sql.
[0m03:42:11.152656 [info ] [Thread-1 (]: 4 of 23 START test not_null_dim_products_product_id ............................ [RUN]
[0m03:42:11.153422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863, now test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m03:42:11.153978 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:42:11.159226 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m03:42:11.161256 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:42:11.164888 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m03:42:11.167609 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m03:42:11.168034 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"} */
[0m03:42:11.242074 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b8c-0000-000a0e0ad439
[0m03:42:11.243162 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.251444 [debug] [Thread-1 (]: Database Error in test not_null_dim_products_product_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_id.sql
[0m03:42:11.252229 [error] [Thread-1 (]: 4 of 23 ERROR not_null_dim_products_product_id ................................. [[31mERROR[0m in 0.10s]
[0m03:42:11.252861 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:42:11.253280 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:42:11.253825 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_id.sql.
[0m03:42:11.254299 [info ] [Thread-1 (]: 5 of 23 START test not_null_dim_products_product_sk ............................ [RUN]
[0m03:42:11.254936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1, now test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9)
[0m03:42:11.255330 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:42:11.260524 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m03:42:11.262217 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:42:11.265669 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m03:42:11.267666 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m03:42:11.268058 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_products
where product_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"} */
[0m03:42:11.389341 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b93-0000-000a0e0ac4fd
[0m03:42:11.390827 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.400475 [debug] [Thread-1 (]: Database Error in test not_null_dim_products_product_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_sk.sql
[0m03:42:11.401380 [error] [Thread-1 (]: 5 of 23 ERROR not_null_dim_products_product_sk ................................. [[31mERROR[0m in 0.15s]
[0m03:42:11.402162 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:42:11.402682 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:42:11.403333 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_sk.sql.
[0m03:42:11.403888 [info ] [Thread-1 (]: 6 of 23 START test not_null_dim_regions_region_sk .............................. [RUN]
[0m03:42:11.404528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9, now test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db)
[0m03:42:11.404936 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:42:11.410173 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m03:42:11.412642 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:42:11.419717 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m03:42:11.421913 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m03:42:11.422337 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_sk
from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_regions
where region_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"} */
[0m03:42:11.503153 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b9d-0000-000a0e0ae201
[0m03:42:11.504040 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.513037 [debug] [Thread-1 (]: Database Error in test not_null_dim_regions_region_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_regions_region_sk.sql
[0m03:42:11.513796 [error] [Thread-1 (]: 6 of 23 ERROR not_null_dim_regions_region_sk ................................... [[31mERROR[0m in 0.11s]
[0m03:42:11.514578 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:42:11.515098 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:42:11.515628 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_regions_region_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_regions_region_sk.sql.
[0m03:42:11.516103 [info ] [Thread-1 (]: 7 of 23 START test not_null_fact_orders_customer_sk ............................ [RUN]
[0m03:42:11.516748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db, now test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226)
[0m03:42:11.517204 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:42:11.522287 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m03:42:11.524495 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:42:11.528158 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m03:42:11.530007 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m03:42:11.530453 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
where customer_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"} */
[0m03:42:11.603828 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2a72-0000-000a0e0a2cc5
[0m03:42:11.604967 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.614024 [debug] [Thread-1 (]: Database Error in test not_null_fact_orders_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_customer_sk.sql
[0m03:42:11.614751 [error] [Thread-1 (]: 7 of 23 ERROR not_null_fact_orders_customer_sk ................................. [[31mERROR[0m in 0.10s]
[0m03:42:11.615507 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:42:11.616061 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:42:11.616703 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_orders_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_customer_sk.sql.
[0m03:42:11.617253 [info ] [Thread-1 (]: 8 of 23 START test not_null_fact_orders_order_revenue .......................... [RUN]
[0m03:42:11.617932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226, now test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25)
[0m03:42:11.618345 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:42:11.623296 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m03:42:11.625735 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:42:11.629033 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m03:42:11.630903 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m03:42:11.631310 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_revenue
from PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
where order_revenue is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"} */
[0m03:42:11.707030 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2a9a-0000-000a0e0a4b99
[0m03:42:11.707956 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.717541 [debug] [Thread-1 (]: Database Error in test not_null_fact_orders_order_revenue (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_revenue.sql
[0m03:42:11.718298 [error] [Thread-1 (]: 8 of 23 ERROR not_null_fact_orders_order_revenue ............................... [[31mERROR[0m in 0.10s]
[0m03:42:11.719058 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:42:11.719559 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:42:11.720251 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_orders_order_revenue (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_revenue.sql.
[0m03:42:11.720821 [info ] [Thread-1 (]: 9 of 23 START test not_null_fact_orders_order_sk ............................... [RUN]
[0m03:42:11.721554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25, now test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6)
[0m03:42:11.721981 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:42:11.726991 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m03:42:11.729227 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:42:11.732224 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m03:42:11.734043 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m03:42:11.734448 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_sk
from PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
where order_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"} */
[0m03:42:11.808593 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b8c-0000-000a0e0ad43d
[0m03:42:11.809645 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:11.819965 [debug] [Thread-1 (]: Database Error in test not_null_fact_orders_order_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_sk.sql
[0m03:42:11.820803 [error] [Thread-1 (]: 9 of 23 ERROR not_null_fact_orders_order_sk .................................... [[31mERROR[0m in 0.10s]
[0m03:42:11.821440 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:42:11.821881 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:42:11.822420 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_orders_order_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_sk.sql.
[0m03:42:11.822882 [info ] [Thread-1 (]: 10 of 23 START test source_not_null_planetkart_raw_customers_customer_id ....... [RUN]
[0m03:42:11.823495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6, now test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe)
[0m03:42:11.823957 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:42:11.829289 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m03:42:11.832380 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:42:11.834876 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m03:42:11.836914 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m03:42:11.837337 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from planetkart.planetkart_raw.customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"} */
[0m03:42:12.315714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m03:42:12.326005 [info ] [Thread-1 (]: 10 of 23 PASS source_not_null_planetkart_raw_customers_customer_id ............. [[32mPASS[0m in 0.50s]
[0m03:42:12.326543 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:42:12.326773 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:42:12.326982 [info ] [Thread-1 (]: 11 of 23 START test source_not_null_planetkart_raw_orders_order_id ............. [RUN]
[0m03:42:12.327231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe, now test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4)
[0m03:42:12.327455 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:42:12.329820 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m03:42:12.331213 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:42:12.333339 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m03:42:12.336109 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m03:42:12.337543 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from planetkart.planetkart_raw.orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"} */
[0m03:42:12.448574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m03:42:12.452964 [info ] [Thread-1 (]: 11 of 23 PASS source_not_null_planetkart_raw_orders_order_id ................... [[32mPASS[0m in 0.13s]
[0m03:42:12.453798 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:42:12.454310 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:42:12.454786 [info ] [Thread-1 (]: 12 of 23 START test source_not_null_planetkart_raw_products_product_id ......... [RUN]
[0m03:42:12.455491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4, now test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090)
[0m03:42:12.456014 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:42:12.460150 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m03:42:12.461847 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:42:12.464572 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m03:42:12.466080 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m03:42:12.466441 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from planetkart.planetkart_raw.products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"} */
[0m03:42:12.778986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m03:42:12.783984 [info ] [Thread-1 (]: 12 of 23 PASS source_not_null_planetkart_raw_products_product_id ............... [[32mPASS[0m in 0.33s]
[0m03:42:12.784894 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:42:12.785428 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:42:12.786033 [info ] [Thread-1 (]: 13 of 23 START test source_not_null_planetkart_raw_regions_region_id ........... [RUN]
[0m03:42:12.786698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090, now test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e)
[0m03:42:12.787220 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:42:12.793475 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m03:42:12.795533 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:42:12.798388 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m03:42:12.800554 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m03:42:12.801003 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from planetkart.planetkart_raw.regions
where region_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"} */
[0m03:42:13.100374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m03:42:13.107204 [info ] [Thread-1 (]: 13 of 23 PASS source_not_null_planetkart_raw_regions_region_id ................. [[32mPASS[0m in 0.32s]
[0m03:42:13.108178 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:42:13.108710 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:42:13.109296 [info ] [Thread-1 (]: 14 of 23 START test source_unique_planetkart_raw_customers_customer_id ......... [RUN]
[0m03:42:13.109925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e, now test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d)
[0m03:42:13.110421 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:42:13.119760 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m03:42:13.121870 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:42:13.124792 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m03:42:13.126677 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m03:42:13.127129 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"} */
[0m03:42:13.369833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m03:42:13.374664 [info ] [Thread-1 (]: 14 of 23 PASS source_unique_planetkart_raw_customers_customer_id ............... [[32mPASS[0m in 0.26s]
[0m03:42:13.375839 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:42:13.376402 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:42:13.376997 [info ] [Thread-1 (]: 15 of 23 START test source_unique_planetkart_raw_orders_order_id ............... [RUN]
[0m03:42:13.377640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d, now test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8)
[0m03:42:13.378152 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:42:13.384509 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m03:42:13.387106 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:42:13.390092 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m03:42:13.392107 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m03:42:13.392592 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"} */
[0m03:42:13.651115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m03:42:13.657559 [info ] [Thread-1 (]: 15 of 23 PASS source_unique_planetkart_raw_orders_order_id ..................... [[32mPASS[0m in 0.28s]
[0m03:42:13.658375 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:42:13.658818 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:42:13.659304 [info ] [Thread-1 (]: 16 of 23 START test source_unique_planetkart_raw_products_product_id ........... [RUN]
[0m03:42:13.659846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8, now test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb)
[0m03:42:13.660275 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:42:13.665427 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m03:42:13.668061 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:42:13.670567 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m03:42:13.672357 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m03:42:13.672754 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"} */
[0m03:42:13.838382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m03:42:13.842328 [info ] [Thread-1 (]: 16 of 23 PASS source_unique_planetkart_raw_products_product_id ................. [[32mPASS[0m in 0.18s]
[0m03:42:13.843437 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:42:13.844162 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:42:13.844949 [info ] [Thread-1 (]: 17 of 23 START test source_unique_planetkart_raw_regions_region_id ............. [RUN]
[0m03:42:13.845489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb, now test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f)
[0m03:42:13.845900 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:42:13.851978 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m03:42:13.854117 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:42:13.856633 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m03:42:13.858681 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m03:42:13.859115 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.regions
where region_id is not null
group by region_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"} */
[0m03:42:14.248266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m03:42:14.253939 [info ] [Thread-1 (]: 17 of 23 PASS source_unique_planetkart_raw_regions_region_id ................... [[32mPASS[0m in 0.41s]
[0m03:42:14.254884 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:42:14.255397 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:42:14.255980 [info ] [Thread-1 (]: 18 of 23 START test unique_dim_customers_customer_id ........................... [RUN]
[0m03:42:14.256634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f, now test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m03:42:14.257148 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:42:14.263354 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m03:42:14.265326 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:42:14.268143 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m03:42:14.270023 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m03:42:14.270463 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */
[0m03:42:14.382369 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b93-0000-000a0e0ac50d
[0m03:42:14.384112 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:14.394471 [debug] [Thread-1 (]: Database Error in test unique_dim_customers_customer_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_id.sql
[0m03:42:14.395440 [error] [Thread-1 (]: 18 of 23 ERROR unique_dim_customers_customer_id ................................ [[31mERROR[0m in 0.14s]
[0m03:42:14.396211 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:42:14.396753 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:42:14.397394 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_customers_customer_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_id.sql.
[0m03:42:14.397927 [info ] [Thread-1 (]: 19 of 23 START test unique_dim_customers_customer_sk ........................... [RUN]
[0m03:42:14.398678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62)
[0m03:42:14.399238 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:42:14.409014 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m03:42:14.411043 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:42:14.413827 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m03:42:14.415521 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m03:42:14.415882 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
where customer_sk is not null
group by customer_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"} */
[0m03:42:14.497437 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b9d-0000-000a0e0ae20d
[0m03:42:14.498663 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:14.507707 [debug] [Thread-1 (]: Database Error in test unique_dim_customers_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_sk.sql
[0m03:42:14.508407 [error] [Thread-1 (]: 19 of 23 ERROR unique_dim_customers_customer_sk ................................ [[31mERROR[0m in 0.11s]
[0m03:42:14.509148 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:42:14.509637 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:42:14.510200 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_customers_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_sk.sql.
[0m03:42:14.510628 [info ] [Thread-1 (]: 20 of 23 START test unique_dim_products_product_id ............................. [RUN]
[0m03:42:14.511210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62, now test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m03:42:14.511583 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:42:14.516963 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m03:42:14.518829 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:42:14.521595 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m03:42:14.523627 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m03:42:14.523989 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"} */
[0m03:42:14.596931 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2a72-0000-000a0e0a2ccd
[0m03:42:14.597779 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:14.606251 [debug] [Thread-1 (]: Database Error in test unique_dim_products_product_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_id.sql
[0m03:42:14.606925 [error] [Thread-1 (]: 20 of 23 ERROR unique_dim_products_product_id .................................. [[31mERROR[0m in 0.10s]
[0m03:42:14.607643 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:42:14.608092 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:42:14.608631 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_products_product_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_id.sql.
[0m03:42:14.609086 [info ] [Thread-1 (]: 21 of 23 START test unique_dim_products_product_sk ............................. [RUN]
[0m03:42:14.609678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985, now test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b)
[0m03:42:14.610073 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:42:14.615475 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m03:42:14.617463 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:42:14.619842 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m03:42:14.621685 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m03:42:14.622063 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_products
where product_sk is not null
group by product_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"} */
[0m03:42:14.702722 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2a9a-0000-000a0e0a4ba1
[0m03:42:14.703512 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:14.711995 [debug] [Thread-1 (]: Database Error in test unique_dim_products_product_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_sk.sql
[0m03:42:14.712778 [error] [Thread-1 (]: 21 of 23 ERROR unique_dim_products_product_sk .................................. [[31mERROR[0m in 0.10s]
[0m03:42:14.713546 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:42:14.713988 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:42:14.714477 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_products_product_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_sk.sql.
[0m03:42:14.714885 [info ] [Thread-1 (]: 22 of 23 START test unique_dim_regions_region_sk ............................... [RUN]
[0m03:42:14.715442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b, now test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d)
[0m03:42:14.715815 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:42:14.721527 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m03:42:14.724075 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:42:14.726860 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m03:42:14.729047 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m03:42:14.729446 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_analytics.dim_regions
where region_sk is not null
group by region_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"} */
[0m03:42:14.805333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b8c-0000-000a0e0ad445
[0m03:42:14.806071 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:14.814782 [debug] [Thread-1 (]: Database Error in test unique_dim_regions_region_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_regions_region_sk.sql
[0m03:42:14.815435 [error] [Thread-1 (]: 22 of 23 ERROR unique_dim_regions_region_sk .................................... [[31mERROR[0m in 0.10s]
[0m03:42:14.816188 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:42:14.816688 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:42:14.817294 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_regions_region_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_regions_region_sk.sql.
[0m03:42:14.817766 [info ] [Thread-1 (]: 23 of 23 START test unique_fact_orders_order_sk ................................ [RUN]
[0m03:42:14.818363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d, now test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c)
[0m03:42:14.818767 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:42:14.824683 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m03:42:14.827001 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:42:14.829814 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m03:42:14.831877 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m03:42:14.832313 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
where order_sk is not null
group by order_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"} */
[0m03:42:14.939049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d4-0001-2b93-0000-000a0e0ac511
[0m03:42:14.940456 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
[0m03:42:14.950036 [debug] [Thread-1 (]: Database Error in test unique_fact_orders_order_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_fact_orders_order_sk.sql
[0m03:42:14.950879 [error] [Thread-1 (]: 23 of 23 ERROR unique_fact_orders_order_sk ..................................... [[31mERROR[0m in 0.13s]
[0m03:42:14.951644 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:42:14.952253 [debug] [Thread-4 (]: Marking all children of 'test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c' to be skipped because of status 'error'.  Reason: Database Error in test unique_fact_orders_order_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_fact_orders_order_sk.sql.
[0m03:42:14.954016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:14.954487 [debug] [MainThread]: Connection 'test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c' was left open.
[0m03:42:14.954906 [debug] [MainThread]: On test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c: Close
[0m03:42:15.088753 [info ] [MainThread]: 
[0m03:42:15.090168 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m03:42:15.094735 [debug] [MainThread]: Command end result
[0m03:42:15.209362 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:42:15.217020 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:42:15.225470 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:42:15.225814 [info ] [MainThread]: 
[0m03:42:15.226150 [info ] [MainThread]: [31mCompleted with 15 errors, 0 partial successes, and 0 warnings:[0m
[0m03:42:15.226425 [info ] [MainThread]: 
[0m03:42:15.226783 [error] [MainThread]: [31mFailure in test accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase (models/marts/schema.yml)[0m
[0m03:42:15.227148 [error] [MainThread]:   Database Error in test accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/accepted_values_dim_customers_c310fde78f10c64bf3a48992e1226420.sql
[0m03:42:15.227411 [info ] [MainThread]: 
[0m03:42:15.227714 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/accepted_values_dim_customers_c310fde78f10c64bf3a48992e1226420.sql
[0m03:42:15.227962 [info ] [MainThread]: 
[0m03:42:15.228257 [error] [MainThread]: [31mFailure in test not_null_dim_customers_customer_id (models/marts/schema.yml)[0m
[0m03:42:15.228586 [error] [MainThread]:   Database Error in test not_null_dim_customers_customer_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_id.sql
[0m03:42:15.228824 [info ] [MainThread]: 
[0m03:42:15.229075 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_id.sql
[0m03:42:15.229274 [info ] [MainThread]: 
[0m03:42:15.229522 [error] [MainThread]: [31mFailure in test not_null_dim_customers_customer_sk (models/marts/schema.yml)[0m
[0m03:42:15.229787 [error] [MainThread]:   Database Error in test not_null_dim_customers_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_sk.sql
[0m03:42:15.229989 [info ] [MainThread]: 
[0m03:42:15.230235 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_dim_customers_customer_sk.sql
[0m03:42:15.230433 [info ] [MainThread]: 
[0m03:42:15.230675 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_id (models/marts/schema.yml)[0m
[0m03:42:15.230933 [error] [MainThread]:   Database Error in test not_null_dim_products_product_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_id.sql
[0m03:42:15.231453 [info ] [MainThread]: 
[0m03:42:15.231892 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_id.sql
[0m03:42:15.232216 [info ] [MainThread]: 
[0m03:42:15.232527 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_sk (models/marts/schema.yml)[0m
[0m03:42:15.232825 [error] [MainThread]:   Database Error in test not_null_dim_products_product_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_sk.sql
[0m03:42:15.233042 [info ] [MainThread]: 
[0m03:42:15.233299 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_dim_products_product_sk.sql
[0m03:42:15.233509 [info ] [MainThread]: 
[0m03:42:15.233761 [error] [MainThread]: [31mFailure in test not_null_dim_regions_region_sk (models/marts/schema.yml)[0m
[0m03:42:15.234032 [error] [MainThread]:   Database Error in test not_null_dim_regions_region_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_dim_regions_region_sk.sql
[0m03:42:15.234237 [info ] [MainThread]: 
[0m03:42:15.234487 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_dim_regions_region_sk.sql
[0m03:42:15.234692 [info ] [MainThread]: 
[0m03:42:15.234938 [error] [MainThread]: [31mFailure in test not_null_fact_orders_customer_sk (models/marts/schema.yml)[0m
[0m03:42:15.235197 [error] [MainThread]:   Database Error in test not_null_fact_orders_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_customer_sk.sql
[0m03:42:15.235402 [info ] [MainThread]: 
[0m03:42:15.235643 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_customer_sk.sql
[0m03:42:15.235836 [info ] [MainThread]: 
[0m03:42:15.236307 [error] [MainThread]: [31mFailure in test not_null_fact_orders_order_revenue (models/marts/schema.yml)[0m
[0m03:42:15.237118 [error] [MainThread]:   Database Error in test not_null_fact_orders_order_revenue (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_revenue.sql
[0m03:42:15.237690 [info ] [MainThread]: 
[0m03:42:15.238106 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_revenue.sql
[0m03:42:15.238401 [info ] [MainThread]: 
[0m03:42:15.238723 [error] [MainThread]: [31mFailure in test not_null_fact_orders_order_sk (models/marts/schema.yml)[0m
[0m03:42:15.239051 [error] [MainThread]:   Database Error in test not_null_fact_orders_order_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_sk.sql
[0m03:42:15.239435 [info ] [MainThread]: 
[0m03:42:15.239795 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/not_null_fact_orders_order_sk.sql
[0m03:42:15.240029 [info ] [MainThread]: 
[0m03:42:15.240285 [error] [MainThread]: [31mFailure in test unique_dim_customers_customer_id (models/marts/schema.yml)[0m
[0m03:42:15.240556 [error] [MainThread]:   Database Error in test unique_dim_customers_customer_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_id.sql
[0m03:42:15.240748 [info ] [MainThread]: 
[0m03:42:15.241119 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_id.sql
[0m03:42:15.241311 [info ] [MainThread]: 
[0m03:42:15.241543 [error] [MainThread]: [31mFailure in test unique_dim_customers_customer_sk (models/marts/schema.yml)[0m
[0m03:42:15.241810 [error] [MainThread]:   Database Error in test unique_dim_customers_customer_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_sk.sql
[0m03:42:15.242045 [info ] [MainThread]: 
[0m03:42:15.242302 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/unique_dim_customers_customer_sk.sql
[0m03:42:15.242761 [info ] [MainThread]: 
[0m03:42:15.243101 [error] [MainThread]: [31mFailure in test unique_dim_products_product_id (models/marts/schema.yml)[0m
[0m03:42:15.243429 [error] [MainThread]:   Database Error in test unique_dim_products_product_id (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_id.sql
[0m03:42:15.243673 [info ] [MainThread]: 
[0m03:42:15.243922 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_id.sql
[0m03:42:15.244125 [info ] [MainThread]: 
[0m03:42:15.244358 [error] [MainThread]: [31mFailure in test unique_dim_products_product_sk (models/marts/schema.yml)[0m
[0m03:42:15.244605 [error] [MainThread]:   Database Error in test unique_dim_products_product_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_sk.sql
[0m03:42:15.244794 [info ] [MainThread]: 
[0m03:42:15.245012 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/unique_dim_products_product_sk.sql
[0m03:42:15.245192 [info ] [MainThread]: 
[0m03:42:15.245418 [error] [MainThread]: [31mFailure in test unique_dim_regions_region_sk (models/marts/schema.yml)[0m
[0m03:42:15.245650 [error] [MainThread]:   Database Error in test unique_dim_regions_region_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_dim_regions_region_sk.sql
[0m03:42:15.245825 [info ] [MainThread]: 
[0m03:42:15.246203 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/unique_dim_regions_region_sk.sql
[0m03:42:15.246434 [info ] [MainThread]: 
[0m03:42:15.246688 [error] [MainThread]: [31mFailure in test unique_fact_orders_order_sk (models/marts/schema.yml)[0m
[0m03:42:15.246946 [error] [MainThread]:   Database Error in test unique_fact_orders_order_sk (models/marts/schema.yml)
  002003 (02000): SQL compilation error:
  Schema 'PLANETKART.PLANETKART_ANALYTICS_ANALYTICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/schema.yml/unique_fact_orders_order_sk.sql
[0m03:42:15.247141 [info ] [MainThread]: 
[0m03:42:15.247362 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/schema.yml/unique_fact_orders_order_sk.sql
[0m03:42:15.247558 [info ] [MainThread]: 
[0m03:42:15.247785 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=15 SKIP=0 NO-OP=0 TOTAL=23
[0m03:42:15.252899 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.9532056, "process_in_blocks": "0", "process_kernel_time": 0.523938, "process_mem_max_rss": "162119680", "process_out_blocks": "0", "process_user_time": 2.472865}
[0m03:42:15.253234 [debug] [MainThread]: Command `dbt test` failed at 03:42:15.253171 after 6.95 seconds
[0m03:42:15.253494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b77ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da0100>]}
[0m03:42:15.253729 [debug] [MainThread]: Flushing usage events
[0m03:42:16.300551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:43:19.980680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa07610>]}


============================== 03:43:19.987509 | d2b2931f-f44a-4883-8dcf-e1abf2d7251b ==============================
[0m03:43:19.987509 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:43:19.987876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:43:20.845593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076235c0>]}
[0m03:43:20.874172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e6690>]}
[0m03:43:20.875820 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:43:20.947770 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:43:21.142171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:43:21.142418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:43:21.171534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc90050>]}
[0m03:43:21.223886 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:43:21.229089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:43:21.283946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d6a80>]}
[0m03:43:21.284274 [info ] [MainThread]: Found 9 models, 23 data tests, 1 snapshot, 5 sources, 591 macros
[0m03:43:21.284484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba29ef0>]}
[0m03:43:21.285954 [info ] [MainThread]: 
[0m03:43:21.286162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:43:21.286321 [info ] [MainThread]: 
[0m03:43:21.286604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:43:21.289572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:43:21.497263 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:43:21.497508 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:43:21.497652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:21.977386 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.479 seconds
[0m03:43:21.984996 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:43:21.985695 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:43:22.163376 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.177 seconds
[0m03:43:22.167698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now create_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:43:22.169933 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "PLANETKART_ANALYTICS_stage"
"
[0m03:43:22.177850 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:43:22.178365 [debug] [ThreadPool]: On create_PLANETKART_PLANETKART_ANALYTICS_stage: create schema if not exists PLANETKART.PLANETKART_ANALYTICS_stage
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_PLANETKART_ANALYTICS_stage"} */
[0m03:43:22.334208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.155 seconds
[0m03:43:22.338013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_PLANETKART_ANALYTICS_stage, now create_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:43:22.338802 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "PLANETKART_ANALYTICS_analytics"
"
[0m03:43:22.342718 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:43:22.343316 [debug] [ThreadPool]: On create_PLANETKART_PLANETKART_ANALYTICS_analytics: create schema if not exists PLANETKART.PLANETKART_ANALYTICS_analytics
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_PLANETKART_ANALYTICS_analytics"} */
[0m03:43:22.442555 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m03:43:22.449792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_PLANETKART_ANALYTICS_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:43:22.469449 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:43:22.469914 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:43:22.554251 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.084 seconds
[0m03:43:22.558994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now list_PLANETKART_snapshots)
[0m03:43:22.562585 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:43:22.563097 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:43:22.839622 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.276 seconds
[0m03:43:22.841444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:43:22.844005 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:43:22.844297 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:43:22.943345 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.099 seconds
[0m03:43:22.946704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfcf930>]}
[0m03:43:22.952179 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:43:22.952933 [info ] [Thread-1 (]: 1 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_customers ........... [RUN]
[0m03:43:22.953525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now model.planetkart_analytics.stg_customers)
[0m03:43:22.954015 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:43:22.965200 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:43:22.967500 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:43:22.997271 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:43:23.000235 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:43:23.000580 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:43:23.362933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m03:43:23.399856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf534d0>]}
[0m03:43:23.400668 [info ] [Thread-1 (]: 1 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_customers ...... [[32mSUCCESS 1[0m in 0.44s]
[0m03:43:23.401240 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:43:23.401610 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:43:23.402143 [info ] [Thread-1 (]: 2 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_order_items ......... [RUN]
[0m03:43:23.402622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:43:23.402973 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:43:23.405958 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:43:23.429643 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:43:23.432864 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:43:23.445697 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:43:23.446139 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:43:23.624573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m03:43:23.630795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1e8e0>]}
[0m03:43:23.631763 [info ] [Thread-1 (]: 2 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_order_items .... [[32mSUCCESS 1[0m in 0.23s]
[0m03:43:23.632531 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:43:23.633025 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:43:23.633732 [info ] [Thread-1 (]: 3 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_orders .............. [RUN]
[0m03:43:23.634393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:43:23.634798 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:43:23.638674 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:43:23.648308 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:43:23.650991 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:43:23.663429 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:43:23.663884 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:43:23.929383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m03:43:23.934422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d374cd0>]}
[0m03:43:23.935994 [info ] [Thread-1 (]: 3 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_orders ......... [[32mSUCCESS 1[0m in 0.30s]
[0m03:43:23.936872 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:43:23.937427 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:43:23.938178 [info ] [Thread-1 (]: 4 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_products ............ [RUN]
[0m03:43:23.938928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:43:23.939455 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:43:23.944194 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:43:23.947351 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:43:23.950693 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m03:43:23.953111 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m03:43:23.953611 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m03:43:24.190345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m03:43:24.196834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3350d0>]}
[0m03:43:24.198029 [info ] [Thread-1 (]: 4 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_products ....... [[32mSUCCESS 1[0m in 0.26s]
[0m03:43:24.198824 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:43:24.199351 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:43:24.200088 [info ] [Thread-1 (]: 5 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_regions ............. [RUN]
[0m03:43:24.200838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:43:24.201328 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:43:24.205270 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:43:24.216693 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:43:24.219793 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:43:24.231309 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:43:24.231815 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:43:24.388574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m03:43:24.393285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3e5b70>]}
[0m03:43:24.394307 [info ] [Thread-1 (]: 5 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_regions ........ [[32mSUCCESS 1[0m in 0.19s]
[0m03:43:24.395112 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:43:24.395625 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:43:24.396358 [info ] [Thread-1 (]: 6 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_customers ...... [RUN]
[0m03:43:24.397070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m03:43:24.397536 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:43:24.416489 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:43:24.419696 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:43:24.441195 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m03:43:24.445514 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m03:43:24.445929 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    case 
        when total_orders = 0 then 'Never_Purchased'
        when coalesce(days_since_last_order, 9999) <= 30 then 'Active'
        when coalesce(days_since_last_order, 9999) <= 90 then 'At_Risk'
        else 'Churned'
    end as lifecycle_stage,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m03:43:26.063915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.617 seconds
[0m03:43:26.068090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a23f0>]}
[0m03:43:26.069119 [info ] [Thread-1 (]: 6 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_customers . [[32mSUCCESS 1[0m in 1.67s]
[0m03:43:26.069955 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:43:26.070514 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:43:26.071475 [info ] [Thread-1 (]: 7 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_products ....... [RUN]
[0m03:43:26.072171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m03:43:26.072668 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:43:26.083325 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:43:26.085329 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:43:26.088335 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m03:43:26.092570 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m03:43:26.093208 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m03:43:26.986947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.893 seconds
[0m03:43:26.992111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a0c50>]}
[0m03:43:26.993325 [info ] [Thread-1 (]: 7 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_products .. [[32mSUCCESS 1[0m in 0.92s]
[0m03:43:26.994125 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:43:26.994653 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m03:43:26.995385 [info ] [Thread-1 (]: 8 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_regions ........ [RUN]
[0m03:43:26.996098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.dim_regions)
[0m03:43:26.996623 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m03:43:27.003375 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m03:43:27.005455 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m03:43:27.008353 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m03:43:27.011014 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m03:43:27.011500 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m03:43:28.113588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.101 seconds
[0m03:43:28.120114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a2630>]}
[0m03:43:28.121670 [info ] [Thread-1 (]: 8 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_regions ... [[32mSUCCESS 1[0m in 1.12s]
[0m03:43:28.122698 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m03:43:28.123346 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:43:28.124068 [info ] [Thread-1 (]: 9 of 9 START sql table model PLANETKART_ANALYTICS_analytics.fact_orders ........ [RUN]
[0m03:43:28.124781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now model.planetkart_analytics.fact_orders)
[0m03:43:28.125328 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:43:28.135274 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:43:28.137688 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:43:28.141292 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:43:28.145428 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:43:28.145979 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
    
    
    
    as (

select 
    md5(cast(coalesce(cast(o.order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(o.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(c.region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    o.order_id,
    o.customer_id,
    o.order_date,
    o.order_status,
    o.order_month,
    c.region_id,
    r.planet,
    r.zone,
    
    count(oi.product_id) as products_in_order,
    sum(oi.quantity) as total_quantity,
    sum(oi.line_total) as order_revenue,
    sum(p.cost * oi.quantity) as order_cost,
    sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
    
    case 
        when sum(oi.line_total - (p.cost * oi.quantity)) >= 20 then 'High_Profit_Order'
        when sum(oi.line_total - (p.cost * oi.quantity)) >= 5 then 'Profitable_Order'  
        when sum(oi.line_total - (p.cost * oi.quantity)) > 0 then 'Low_Profit_Order'
        else 'Unprofitable_Order'
    end as order_profit_segment,
    
    case 
        when sum(oi.line_total) >= 150 then 'Large_Order'
        when sum(oi.line_total) >= 80 then 'Medium_Order'
        when sum(oi.line_total) > 0 then 'Small_Order'
        else 'Zero_Order'
    end as order_size_segment,
    
    case 
        when sum(oi.line_total) > 0 then round((sum(oi.line_total - (p.cost * oi.quantity)) / sum(oi.line_total)) * 100, 1)
        else 0 
    end as order_margin_pct,
    
    case when o.order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at
    
from PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o
join PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c on o.customer_id = c.customer_id
join PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions r on c.region_id = r.region_id
left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
group by 1,2,3,4,5,6,7,8,9,10,11,12,20,21
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:43:28.552391 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d5-0001-2a72-0000-000a0e0a2cd9
[0m03:43:28.553035 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[PRODUCTS_IN_ORDER] is not a valid group by expression
[0m03:43:28.563490 [debug] [Thread-1 (]: Database Error in model fact_orders (models/marts/fact_orders.sql)
  000979 (42601): SQL compilation error:
  [PRODUCTS_IN_ORDER] is not a valid group by expression
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql
[0m03:43:28.564201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b2931f-f44a-4883-8dcf-e1abf2d7251b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4611f0>]}
[0m03:43:28.565109 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model PLANETKART_ANALYTICS_analytics.fact_orders  [[31mERROR[0m in 0.44s]
[0m03:43:28.565813 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:43:28.566340 [debug] [Thread-4 (]: Marking all children of 'model.planetkart_analytics.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models/marts/fact_orders.sql)
  000979 (42601): SQL compilation error:
  [PRODUCTS_IN_ORDER] is not a valid group by expression
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql.
[0m03:43:28.568369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:43:28.568744 [debug] [MainThread]: Connection 'model.planetkart_analytics.fact_orders' was left open.
[0m03:43:28.569066 [debug] [MainThread]: On model.planetkart_analytics.fact_orders: Close
[0m03:43:28.684505 [info ] [MainThread]: 
[0m03:43:28.685259 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m03:43:28.687659 [debug] [MainThread]: Command end result
[0m03:43:28.811663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:43:28.822416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:43:28.834758 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:43:28.835113 [info ] [MainThread]: 
[0m03:43:28.835484 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:43:28.835766 [info ] [MainThread]: 
[0m03:43:28.836103 [error] [MainThread]: [31mFailure in model fact_orders (models/marts/fact_orders.sql)[0m
[0m03:43:28.836464 [error] [MainThread]:   Database Error in model fact_orders (models/marts/fact_orders.sql)
  000979 (42601): SQL compilation error:
  [PRODUCTS_IN_ORDER] is not a valid group by expression
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql
[0m03:43:28.836709 [info ] [MainThread]: 
[0m03:43:28.836998 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/fact_orders.sql
[0m03:43:28.837242 [info ] [MainThread]: 
[0m03:43:28.837526 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=9
[0m03:43:28.843153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.9390335, "process_in_blocks": "0", "process_kernel_time": 0.484668, "process_mem_max_rss": "157614080", "process_out_blocks": "0", "process_user_time": 2.014876}
[0m03:43:28.843715 [debug] [MainThread]: Command `dbt run` failed at 03:43:28.843615 after 8.94 seconds
[0m03:43:28.844107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e13650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba470b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b7cb0>]}
[0m03:43:28.844465 [debug] [MainThread]: Flushing usage events
[0m03:43:30.083375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:44:46.124768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039474d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a03750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a03610>]}


============================== 03:44:46.130953 | 8db4732a-16d1-4725-9714-6bc1563fc550 ==============================
[0m03:44:46.130953 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:44:46.131338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m03:44:46.990618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8db4732a-16d1-4725-9714-6bc1563fc550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041575c0>]}
[0m03:44:47.018504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8db4732a-16d1-4725-9714-6bc1563fc550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e6690>]}
[0m03:44:47.020200 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:44:47.095600 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:44:47.287284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:44:47.287738 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/marts/fact_orders.sql
[0m03:44:47.497273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8db4732a-16d1-4725-9714-6bc1563fc550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a29550>]}
[0m03:44:47.549468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:44:47.554697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:44:47.613045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8db4732a-16d1-4725-9714-6bc1563fc550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d6a80>]}
[0m03:44:47.613399 [info ] [MainThread]: Found 9 models, 23 data tests, 1 snapshot, 5 sources, 591 macros
[0m03:44:47.613625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db4732a-16d1-4725-9714-6bc1563fc550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9fcb0>]}
[0m03:44:47.614799 [info ] [MainThread]: 
[0m03:44:47.615010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:44:47.615170 [info ] [MainThread]: 
[0m03:44:47.615447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:44:47.615983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:44:47.831854 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:44:47.832091 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:44:47.832231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:48.568969 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.736 seconds
[0m03:44:48.581187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:44:48.593727 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:44:48.594065 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:44:48.707782 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.113 seconds
[0m03:44:48.713106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now list_PLANETKART_snapshots)
[0m03:44:48.717770 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:44:48.718296 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:44:48.833665 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m03:44:48.839663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:44:48.843896 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:44:48.844355 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:44:48.979379 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.135 seconds
[0m03:44:48.981553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db4732a-16d1-4725-9714-6bc1563fc550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061de1a0>]}
[0m03:44:48.987485 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:44:48.987895 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS_analytics.fact_orders ........ [RUN]
[0m03:44:48.988230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now model.planetkart_analytics.fact_orders)
[0m03:44:48.988483 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:44:48.997071 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:44:49.015795 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:44:49.036735 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:44:49.055748 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:44:49.056084 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
    
    
    
    as (

select 
    md5(cast(coalesce(cast(o.order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(o.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(c.region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    o.order_id,
    o.customer_id,
    o.order_date,
    o.order_status,
    o.order_month,
    c.region_id,
    r.planet,
    r.zone,
    
    count(oi.product_id) as products_in_order,
    sum(oi.quantity) as total_quantity,
    sum(oi.line_total) as order_revenue,
    sum(p.cost * oi.quantity) as order_cost,
    sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
    
    case 
        when sum(oi.line_total - (p.cost * oi.quantity)) >= 20 then 'High_Profit_Order'
        when sum(oi.line_total - (p.cost * oi.quantity)) >= 5 then 'Profitable_Order'  
        when sum(oi.line_total - (p.cost * oi.quantity)) > 0 then 'Low_Profit_Order'
        else 'Unprofitable_Order'
    end as order_profit_segment,
    
    case 
        when sum(oi.line_total) >= 150 then 'Large_Order'
        when sum(oi.line_total) >= 80 then 'Medium_Order'
        when sum(oi.line_total) > 0 then 'Small_Order'
        else 'Zero_Order'
    end as order_size_segment,
    
    case when o.order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at
    
from PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o
join PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c on o.customer_id = c.customer_id
join PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions r on c.region_id = r.region_id
left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
group by 1,2,3,4,5,6,7,8,9,10,11,20,21
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:44:49.260724 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2d6-0001-2a9a-0000-000a0e0a4bb1
[0m03:44:49.261470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[21] is not a valid group by expression
[0m03:44:49.271832 [debug] [Thread-1 (]: Database Error in model fact_orders (models/marts/fact_orders.sql)
  000979 (42601): SQL compilation error:
  [21] is not a valid group by expression
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql
[0m03:44:49.275540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8db4732a-16d1-4725-9714-6bc1563fc550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108680d10>]}
[0m03:44:49.276528 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PLANETKART_ANALYTICS_analytics.fact_orders  [[31mERROR[0m in 0.28s]
[0m03:44:49.277359 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:44:49.278016 [debug] [Thread-4 (]: Marking all children of 'model.planetkart_analytics.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models/marts/fact_orders.sql)
  000979 (42601): SQL compilation error:
  [21] is not a valid group by expression
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql.
[0m03:44:49.280086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:49.280454 [debug] [MainThread]: Connection 'model.planetkart_analytics.fact_orders' was left open.
[0m03:44:49.280767 [debug] [MainThread]: On model.planetkart_analytics.fact_orders: Close
[0m03:44:49.405435 [info ] [MainThread]: 
[0m03:44:49.406911 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m03:44:49.407872 [debug] [MainThread]: Command end result
[0m03:44:49.523885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:44:49.531737 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:44:49.538433 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:44:49.538765 [info ] [MainThread]: 
[0m03:44:49.539124 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:44:49.539415 [info ] [MainThread]: 
[0m03:44:49.539760 [error] [MainThread]: [31mFailure in model fact_orders (models/marts/fact_orders.sql)[0m
[0m03:44:49.540093 [error] [MainThread]:   Database Error in model fact_orders (models/marts/fact_orders.sql)
  000979 (42601): SQL compilation error:
  [21] is not a valid group by expression
  compiled code at target/run/planetkart_analytics/models/marts/fact_orders.sql
[0m03:44:49.540333 [info ] [MainThread]: 
[0m03:44:49.540623 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/fact_orders.sql
[0m03:44:49.540856 [info ] [MainThread]: 
[0m03:44:49.541125 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m03:44:49.546800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.48893, "process_in_blocks": "0", "process_kernel_time": 0.475393, "process_mem_max_rss": "162955264", "process_out_blocks": "0", "process_user_time": 1.900311}
[0m03:44:49.547359 [debug] [MainThread]: Command `dbt run` failed at 03:44:49.547266 after 3.49 seconds
[0m03:44:49.547758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108672a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108672c10>]}
[0m03:44:49.548115 [debug] [MainThread]: Flushing usage events
[0m03:44:50.746367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:46:12.320096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109703750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109703610>]}


============================== 03:46:12.326336 | bd774bf0-02b7-4af7-a180-fa14d33d9979 ==============================
[0m03:46:12.326336 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:46:12.326925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_orders', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:46:13.141791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd774bf0-02b7-4af7-a180-fa14d33d9979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088df5c0>]}
[0m03:46:13.170840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd774bf0-02b7-4af7-a180-fa14d33d9979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e6690>]}
[0m03:46:13.172812 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:46:13.247846 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:46:13.453932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:46:13.454385 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/marts/fact_orders.sql
[0m03:46:13.663377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd774bf0-02b7-4af7-a180-fa14d33d9979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abe1450>]}
[0m03:46:13.715573 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:46:13.720536 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:46:13.778079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd774bf0-02b7-4af7-a180-fa14d33d9979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d6a80>]}
[0m03:46:13.778428 [info ] [MainThread]: Found 9 models, 23 data tests, 1 snapshot, 5 sources, 591 macros
[0m03:46:13.778647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd774bf0-02b7-4af7-a180-fa14d33d9979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c8f30>]}
[0m03:46:13.779816 [info ] [MainThread]: 
[0m03:46:13.780025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:46:13.780186 [info ] [MainThread]: 
[0m03:46:13.780475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:46:13.780979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:46:14.001323 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:46:14.001556 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:46:14.001698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:14.640870 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.639 seconds
[0m03:46:14.650359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:46:14.665427 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:46:14.665862 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:46:14.783220 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.117 seconds
[0m03:46:14.786085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now list_PLANETKART_snapshots)
[0m03:46:14.789462 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:46:14.789832 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:46:14.884070 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m03:46:14.888907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:46:14.893078 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:46:14.893526 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:46:15.040859 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.147 seconds
[0m03:46:15.047978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd774bf0-02b7-4af7-a180-fa14d33d9979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd63790>]}
[0m03:46:15.055971 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:46:15.057076 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS_analytics.fact_orders ........ [RUN]
[0m03:46:15.057865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now model.planetkart_analytics.fact_orders)
[0m03:46:15.058470 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:46:15.074096 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:46:15.076070 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:46:15.106581 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:46:15.110528 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:46:15.110929 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:46:16.323462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.212 seconds
[0m03:46:16.357399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd774bf0-02b7-4af7-a180-fa14d33d9979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128280590>]}
[0m03:46:16.358196 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PLANETKART_ANALYTICS_analytics.fact_orders ... [[32mSUCCESS 1[0m in 1.30s]
[0m03:46:16.358801 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:46:16.359988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:16.360341 [debug] [MainThread]: Connection 'model.planetkart_analytics.fact_orders' was left open.
[0m03:46:16.360645 [debug] [MainThread]: On model.planetkart_analytics.fact_orders: Close
[0m03:46:16.543818 [info ] [MainThread]: 
[0m03:46:16.544571 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m03:46:16.545558 [debug] [MainThread]: Command end result
[0m03:46:16.673778 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:46:16.681876 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:46:16.691753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:46:16.692108 [info ] [MainThread]: 
[0m03:46:16.692503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:46:16.692778 [info ] [MainThread]: 
[0m03:46:16.693074 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:46:16.699297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.448421, "process_in_blocks": "0", "process_kernel_time": 0.464198, "process_mem_max_rss": "162365440", "process_out_blocks": "0", "process_user_time": 1.900063}
[0m03:46:16.699820 [debug] [MainThread]: Command `dbt run` succeeded at 03:46:16.699692 after 4.45 seconds
[0m03:46:16.700373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128077b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280f9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280f8730>]}
[0m03:46:16.700729 [debug] [MainThread]: Flushing usage events
[0m03:46:17.790868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:46:32.216448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139a34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115907750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115907610>]}


============================== 03:46:32.222624 | 0c1444f5-c9b1-4112-a689-9df7210107ba ==============================
[0m03:46:32.222624 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:46:32.222992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:46:32.961406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11401f5c0>]}
[0m03:46:32.989259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167e6690>]}
[0m03:46:32.991131 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:46:33.063926 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:46:33.251663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:46:33.251906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:46:33.281049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c90050>]}
[0m03:46:33.333353 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:46:33.337934 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:46:33.385842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167d6a80>]}
[0m03:46:33.386211 [info ] [MainThread]: Found 9 models, 23 data tests, 1 snapshot, 5 sources, 591 macros
[0m03:46:33.386430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a29ef0>]}
[0m03:46:33.387917 [info ] [MainThread]: 
[0m03:46:33.388132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:46:33.388289 [info ] [MainThread]: 
[0m03:46:33.388591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:46:33.391397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:46:33.601887 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:46:33.602131 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:46:33.602272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:34.168499 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.566 seconds
[0m03:46:34.175890 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:46:34.176532 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:46:34.252761 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.076 seconds
[0m03:46:34.258694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:46:34.276713 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:46:34.277148 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:46:34.372285 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.095 seconds
[0m03:46:34.376688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now list_PLANETKART_snapshots)
[0m03:46:34.381090 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:46:34.381543 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:46:34.475690 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m03:46:34.479072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:46:34.483428 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:46:34.484629 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:46:34.619380 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.134 seconds
[0m03:46:34.625176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fcedd0>]}
[0m03:46:34.632373 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:46:34.633452 [info ] [Thread-1 (]: 1 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_customers ........... [RUN]
[0m03:46:34.634109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now model.planetkart_analytics.stg_customers)
[0m03:46:34.634599 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:46:34.646795 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:46:34.664942 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:46:34.697607 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:46:34.711461 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:46:34.711850 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:46:34.919238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.207 seconds
[0m03:46:34.955041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f53c50>]}
[0m03:46:34.955841 [info ] [Thread-1 (]: 1 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_customers ...... [[32mSUCCESS 1[0m in 0.32s]
[0m03:46:34.956425 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:46:34.956811 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:46:34.957370 [info ] [Thread-1 (]: 2 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_order_items ......... [RUN]
[0m03:46:34.957879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:46:34.958257 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:46:34.961130 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:46:34.963489 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:46:34.966399 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:46:34.968835 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:46:34.969318 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:46:35.115174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m03:46:35.116959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249e59c0>]}
[0m03:46:35.117418 [info ] [Thread-1 (]: 2 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_order_items .... [[32mSUCCESS 1[0m in 0.16s]
[0m03:46:35.117794 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:46:35.118046 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:46:35.118428 [info ] [Thread-1 (]: 3 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_orders .............. [RUN]
[0m03:46:35.118786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:46:35.119033 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:46:35.121339 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:46:35.123030 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:46:35.125782 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:46:35.130598 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:46:35.130886 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:46:35.286091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m03:46:35.287681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a44d70>]}
[0m03:46:35.288101 [info ] [Thread-1 (]: 3 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_orders ......... [[32mSUCCESS 1[0m in 0.17s]
[0m03:46:35.288461 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:46:35.288695 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:46:35.289041 [info ] [Thread-1 (]: 4 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_products ............ [RUN]
[0m03:46:35.289370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:46:35.289611 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:46:35.291643 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:46:35.305032 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:46:35.307220 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m03:46:35.315197 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m03:46:35.315446 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m03:46:35.520225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m03:46:35.525308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ab69d0>]}
[0m03:46:35.526329 [info ] [Thread-1 (]: 4 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_products ....... [[32mSUCCESS 1[0m in 0.24s]
[0m03:46:35.527075 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:46:35.527597 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:46:35.528314 [info ] [Thread-1 (]: 5 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_regions ............. [RUN]
[0m03:46:35.529077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:46:35.529556 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:46:35.533841 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:46:35.535993 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:46:35.539569 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:46:35.542437 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:46:35.543008 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:46:35.871585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m03:46:35.875776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ae9be0>]}
[0m03:46:35.876552 [info ] [Thread-1 (]: 5 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_regions ........ [[32mSUCCESS 1[0m in 0.35s]
[0m03:46:35.877645 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:46:35.878600 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:46:35.879468 [info ] [Thread-1 (]: 6 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_customers ...... [RUN]
[0m03:46:35.880304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m03:46:35.880842 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:46:35.898827 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:46:35.914760 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:46:35.939183 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m03:46:35.960916 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m03:46:35.961481 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    case 
        when total_orders = 0 then 'Never_Purchased'
        when coalesce(days_since_last_order, 9999) <= 30 then 'Active'
        when coalesce(days_since_last_order, 9999) <= 90 then 'At_Risk'
        else 'Churned'
    end as lifecycle_stage,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m03:46:36.941507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.979 seconds
[0m03:46:36.944617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249a2b10>]}
[0m03:46:36.945397 [info ] [Thread-1 (]: 6 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_customers . [[32mSUCCESS 1[0m in 1.06s]
[0m03:46:36.946051 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:46:36.946490 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:46:36.947106 [info ] [Thread-1 (]: 7 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_products ....... [RUN]
[0m03:46:36.947708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m03:46:36.948135 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:46:36.952426 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:46:36.970060 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:46:36.971961 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m03:46:36.985967 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m03:46:36.986393 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m03:46:37.658210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m03:46:37.663542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fdff50>]}
[0m03:46:37.664550 [info ] [Thread-1 (]: 7 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_products .. [[32mSUCCESS 1[0m in 0.72s]
[0m03:46:37.665708 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:46:37.666595 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:46:37.667524 [info ] [Thread-1 (]: 8 of 9 START sql table model PLANETKART_ANALYTICS_analytics.fact_orders ........ [RUN]
[0m03:46:37.668245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m03:46:37.668743 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:46:37.677096 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:46:37.694928 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:46:37.699475 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:46:37.717598 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:46:37.718367 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:46:38.792156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.073 seconds
[0m03:46:38.795978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249a03b0>]}
[0m03:46:38.798573 [info ] [Thread-1 (]: 8 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.fact_orders ... [[32mSUCCESS 1[0m in 1.13s]
[0m03:46:38.799561 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:46:38.800323 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m03:46:38.801105 [info ] [Thread-1 (]: 9 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_regions ........ [RUN]
[0m03:46:38.801682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m03:46:38.802136 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m03:46:38.805439 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m03:46:38.806925 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m03:46:38.809081 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m03:46:38.810736 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m03:46:38.811018 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m03:46:39.602959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m03:46:39.607204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1444f5-c9b1-4112-a689-9df7210107ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249a03b0>]}
[0m03:46:39.608066 [info ] [Thread-1 (]: 9 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_regions ... [[32mSUCCESS 1[0m in 0.81s]
[0m03:46:39.608778 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m03:46:39.610092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:39.610458 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_regions' was left open.
[0m03:46:39.610669 [debug] [MainThread]: On model.planetkart_analytics.dim_regions: Close
[0m03:46:39.714818 [info ] [MainThread]: 
[0m03:46:39.715519 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m03:46:39.718282 [debug] [MainThread]: Command end result
[0m03:46:39.822842 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:46:39.829676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:46:39.835977 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:46:39.836243 [info ] [MainThread]: 
[0m03:46:39.836490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:46:39.836667 [info ] [MainThread]: 
[0m03:46:39.836864 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m03:46:39.842804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6899657, "process_in_blocks": "0", "process_kernel_time": 0.431334, "process_mem_max_rss": "152993792", "process_out_blocks": "0", "process_user_time": 1.848947}
[0m03:46:39.843264 [debug] [MainThread]: Command `dbt run` succeeded at 03:46:39.843192 after 7.69 seconds
[0m03:46:39.843523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ddf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fdfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fddf70>]}
[0m03:46:39.843755 [debug] [MainThread]: Flushing usage events
[0m03:46:41.168524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:47:31.041022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a27750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a27610>]}


============================== 03:47:31.047529 | 0529dca0-c8a0-493f-bb98-a43e87d6aa74 ==============================
[0m03:47:31.047529 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:47:31.047915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:47:31.899802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d475c0>]}
[0m03:47:31.927817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109542690>]}
[0m03:47:31.929529 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:47:32.008398 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:47:32.074181 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:47:32.074471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e7e50>]}
[0m03:47:32.923387 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `customers` in file
`models/staging/_sources.yml`. The `freshness` top-level property should be
moved into the `config` of `customers`.
[0m03:47:32.923693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3f5c0>]}
[0m03:47:32.987460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f7d90>]}
[0m03:47:33.037938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:47:33.042325 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:47:33.092699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac3e10>]}
[0m03:47:33.093038 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 591 macros
[0m03:47:33.093251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4c7d0>]}
[0m03:47:33.094720 [info ] [MainThread]: 
[0m03:47:33.094930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:47:33.095079 [info ] [MainThread]: 
[0m03:47:33.095342 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:47:33.098097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:47:33.316292 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:47:33.316528 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:47:33.316673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:33.908117 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.591 seconds
[0m03:47:33.911771 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:47:33.912135 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:47:33.995877 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.083 seconds
[0m03:47:34.000711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m03:47:34.016827 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m03:47:34.017196 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m03:47:34.108806 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.091 seconds
[0m03:47:34.113244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_stage)
[0m03:47:34.117963 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_stage"
[0m03:47:34.118412 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_stage"} */;
[0m03:47:34.222572 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.104 seconds
[0m03:47:34.228458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_stage, now list_PLANETKART_snapshots)
[0m03:47:34.233293 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:47:34.233773 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:47:34.319110 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m03:47:34.323742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f00c5d0>]}
[0m03:47:34.330208 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:47:34.330918 [info ] [Thread-1 (]: 1 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_customers ........... [RUN]
[0m03:47:34.331494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.stg_customers)
[0m03:47:34.331967 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:47:34.344180 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:47:34.346243 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:47:34.379425 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:47:34.382485 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:47:34.382848 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:47:34.595801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m03:47:34.633236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d17890>]}
[0m03:47:34.634027 [info ] [Thread-1 (]: 1 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_customers ...... [[32mSUCCESS 1[0m in 0.30s]
[0m03:47:34.634615 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:47:34.635002 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:47:34.635550 [info ] [Thread-1 (]: 2 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_order_items ......... [RUN]
[0m03:47:34.636060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:47:34.636427 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:47:34.639255 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:47:34.658281 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:47:34.661439 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:47:34.673603 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:47:34.673952 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:47:34.846075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m03:47:34.852863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae66850>]}
[0m03:47:34.854068 [info ] [Thread-1 (]: 2 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_order_items .... [[32mSUCCESS 1[0m in 0.22s]
[0m03:47:34.854918 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:47:34.855458 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:47:34.856174 [info ] [Thread-1 (]: 3 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_orders .............. [RUN]
[0m03:47:34.856837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:47:34.857335 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:47:34.861718 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:47:34.872484 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:47:34.876479 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:47:34.890663 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:47:34.891162 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:47:35.078054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m03:47:35.083670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb380>]}
[0m03:47:35.084989 [info ] [Thread-1 (]: 3 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_orders ......... [[32mSUCCESS 1[0m in 0.23s]
[0m03:47:35.086180 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:47:35.086716 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:47:35.087430 [info ] [Thread-1 (]: 4 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_products ............ [RUN]
[0m03:47:35.088117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:47:35.088609 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:47:35.093171 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:47:35.095844 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:47:35.100043 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m03:47:35.102717 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m03:47:35.103223 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m03:47:35.260567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m03:47:35.266657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f103f50>]}
[0m03:47:35.267788 [info ] [Thread-1 (]: 4 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_products ....... [[32mSUCCESS 1[0m in 0.18s]
[0m03:47:35.268612 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:47:35.269124 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:47:35.269883 [info ] [Thread-1 (]: 5 of 9 START sql view model PLANETKART_ANALYTICS_stage.stg_regions ............. [RUN]
[0m03:47:35.270735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:47:35.271279 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:47:35.275705 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:47:35.288369 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:47:35.292528 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:47:35.302711 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:47:35.303212 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:47:35.444364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m03:47:35.449660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1003b0>]}
[0m03:47:35.451121 [info ] [Thread-1 (]: 5 of 9 OK created sql view model PLANETKART_ANALYTICS_stage.stg_regions ........ [[32mSUCCESS 1[0m in 0.18s]
[0m03:47:35.451955 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:47:35.452485 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:47:35.453150 [info ] [Thread-1 (]: 6 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_customers ...... [RUN]
[0m03:47:35.453863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m03:47:35.454461 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:47:35.461841 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:47:35.465254 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:47:35.490874 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m03:47:35.495318 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m03:47:35.495814 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    case 
        when total_orders = 0 then 'Never_Purchased'
        when coalesce(days_since_last_order, 9999) <= 30 then 'Active'
        when coalesce(days_since_last_order, 9999) <= 90 then 'At_Risk'
        else 'Churned'
    end as lifecycle_stage,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m03:47:36.232106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m03:47:36.237663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f103f50>]}
[0m03:47:36.238784 [info ] [Thread-1 (]: 6 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_customers . [[32mSUCCESS 1[0m in 0.78s]
[0m03:47:36.239720 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:47:36.240367 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:47:36.241094 [info ] [Thread-1 (]: 7 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_products ....... [RUN]
[0m03:47:36.241759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m03:47:36.242266 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:47:36.249375 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:47:36.253013 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:47:36.256169 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m03:47:36.260133 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m03:47:36.260782 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m03:47:36.949414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m03:47:36.955691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fcad0>]}
[0m03:47:36.956710 [info ] [Thread-1 (]: 7 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_products .. [[32mSUCCESS 1[0m in 0.71s]
[0m03:47:36.957497 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:47:36.958009 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:47:36.958715 [info ] [Thread-1 (]: 8 of 9 START sql table model PLANETKART_ANALYTICS_analytics.fact_orders ........ [RUN]
[0m03:47:36.959406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m03:47:36.959892 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:47:36.969379 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:47:36.971911 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:47:36.975275 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:47:36.979115 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:47:36.979630 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:47:37.563722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m03:47:37.570810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fdcd0>]}
[0m03:47:37.572187 [info ] [Thread-1 (]: 8 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.fact_orders ... [[32mSUCCESS 1[0m in 0.61s]
[0m03:47:37.573173 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:47:37.573714 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m03:47:37.574404 [info ] [Thread-1 (]: 9 of 9 START sql table model PLANETKART_ANALYTICS_analytics.dim_regions ........ [RUN]
[0m03:47:37.575105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m03:47:37.575623 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m03:47:37.581632 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m03:47:37.595587 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m03:47:37.599307 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m03:47:37.615252 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m03:47:37.615883 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m03:47:38.096726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m03:47:38.101305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0529dca0-c8a0-493f-bb98-a43e87d6aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fcc50>]}
[0m03:47:38.102297 [info ] [Thread-1 (]: 9 of 9 OK created sql table model PLANETKART_ANALYTICS_analytics.dim_regions ... [[32mSUCCESS 1[0m in 0.53s]
[0m03:47:38.103049 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m03:47:38.104664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:38.105079 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_regions' was left open.
[0m03:47:38.105444 [debug] [MainThread]: On model.planetkart_analytics.dim_regions: Close
[0m03:47:38.233124 [info ] [MainThread]: 
[0m03:47:38.234625 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m03:47:38.237311 [debug] [MainThread]: Command end result
[0m03:47:38.365832 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:47:38.374379 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:47:38.386196 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:47:38.386546 [info ] [MainThread]: 
[0m03:47:38.386911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:47:38.387182 [info ] [MainThread]: 
[0m03:47:38.387474 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m03:47:38.387976 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:47:38.394356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4317923, "process_in_blocks": "0", "process_kernel_time": 0.493276, "process_mem_max_rss": "167493632", "process_out_blocks": "0", "process_user_time": 2.746857}
[0m03:47:38.394964 [debug] [MainThread]: Command `dbt run` succeeded at 03:47:38.394828 after 7.43 seconds
[0m03:47:38.395393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c95df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1023f0>]}
[0m03:47:38.395762 [debug] [MainThread]: Flushing usage events
[0m03:47:39.814937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:35.169585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112407750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112407610>]}


============================== 03:48:35.176153 | 8b4846f8-2319-4f6a-944b-9ae0e5ffc222 ==============================
[0m03:48:35.176153 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:48:35.176536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:48:36.053267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b235c0>]}
[0m03:48:36.081194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131e6690>]}
[0m03:48:36.082919 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:48:36.158784 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:48:36.224145 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:48:36.224432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113793e50>]}
[0m03:48:37.067707 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `customers` in file
`models/staging/_sources.yml`. The `freshness` top-level property should be
moved into the `config` of `customers`.
[0m03:48:37.067999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144375c0>]}
[0m03:48:37.128364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114997d90>]}
[0m03:48:37.179062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:48:37.184236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:48:37.249438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a63e10>]}
[0m03:48:37.249830 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 591 macros
[0m03:48:37.250062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114af0710>]}
[0m03:48:37.251716 [info ] [MainThread]: 
[0m03:48:37.251973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:37.252152 [info ] [MainThread]: 
[0m03:48:37.252488 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:48:37.255633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:48:37.485028 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:48:37.485285 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:48:37.485435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:38.004853 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.519 seconds
[0m03:48:38.012808 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:48:38.013488 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:48:38.092156 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.078 seconds
[0m03:48:38.093729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now create_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m03:48:38.094310 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "PLANETKART_ANALYTICS_planetkart_stage"
"
[0m03:48:38.096916 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m03:48:38.097148 [debug] [ThreadPool]: On create_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: create schema if not exists PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */
[0m03:48:38.188122 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m03:48:38.189254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now create_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m03:48:38.189752 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "PLANETKART_ANALYTICS_planetkart_analytics"
"
[0m03:48:38.191499 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m03:48:38.191756 [debug] [ThreadPool]: On create_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: create schema if not exists PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */
[0m03:48:38.291373 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m03:48:38.294993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m03:48:38.304516 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m03:48:38.304843 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m03:48:38.383624 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.079 seconds
[0m03:48:38.385083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m03:48:38.386825 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:48:38.387068 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:48:38.504834 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m03:48:38.508489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m03:48:38.512207 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m03:48:38.512662 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m03:48:38.605551 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.092 seconds
[0m03:48:38.609900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114de4260>]}
[0m03:48:38.616074 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:48:38.617054 [info ] [Thread-1 (]: 1 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m03:48:38.617832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now model.planetkart_analytics.stg_customers)
[0m03:48:38.618337 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:48:38.635036 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:48:38.656993 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:48:38.687891 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:48:38.706783 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:48:38.707180 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:48:38.921598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m03:48:38.940810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af3890>]}
[0m03:48:38.941247 [info ] [Thread-1 (]: 1 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.32s]
[0m03:48:38.941551 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:48:38.941757 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:48:38.941968 [info ] [Thread-1 (]: 2 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m03:48:38.942228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:48:38.942391 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:48:38.943894 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:48:38.945658 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:48:38.947257 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:48:38.948941 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:48:38.949189 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:48:39.202146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m03:48:39.208731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a770d0>]}
[0m03:48:39.209754 [info ] [Thread-1 (]: 2 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.27s]
[0m03:48:39.210539 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:48:39.211094 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:48:39.212061 [info ] [Thread-1 (]: 3 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders ... [RUN]
[0m03:48:39.213302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:48:39.213930 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:48:39.218395 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:48:39.221334 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:48:39.226677 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:48:39.229148 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:48:39.229636 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:48:39.429354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m03:48:39.435863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e3620>]}
[0m03:48:39.437008 [info ] [Thread-1 (]: 3 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.22s]
[0m03:48:39.437792 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:48:39.438315 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:48:39.439023 [info ] [Thread-1 (]: 4 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products . [RUN]
[0m03:48:39.439733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:48:39.440270 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:48:39.444978 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:48:39.455416 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:48:39.458720 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m03:48:39.474038 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m03:48:39.474537 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m03:48:39.640568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m03:48:39.646305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a912b0>]}
[0m03:48:39.647683 [info ] [Thread-1 (]: 4 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.21s]
[0m03:48:39.648770 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:48:39.649339 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:48:39.650074 [info ] [Thread-1 (]: 5 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions .. [RUN]
[0m03:48:39.650883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:48:39.651410 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:48:39.655991 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:48:39.658272 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:48:39.661316 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:48:39.663740 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:48:39.664233 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:48:39.829941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m03:48:39.835819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a91a90>]}
[0m03:48:39.837288 [info ] [Thread-1 (]: 5 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.18s]
[0m03:48:39.838092 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:48:39.838628 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:48:39.839351 [info ] [Thread-1 (]: 6 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m03:48:39.840160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m03:48:39.840710 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:48:39.847021 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:48:39.860961 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:48:39.886209 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m03:48:39.908540 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m03:48:39.909084 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    case 
        when total_orders = 0 then 'Never_Purchased'
        when coalesce(days_since_last_order, 9999) <= 30 then 'Active'
        when coalesce(days_since_last_order, 9999) <= 90 then 'At_Risk'
        else 'Churned'
    end as lifecycle_stage,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m03:48:41.051343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.141 seconds
[0m03:48:41.056026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a92c30>]}
[0m03:48:41.057343 [info ] [Thread-1 (]: 6 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.22s]
[0m03:48:41.058767 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:48:41.059427 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:48:41.060176 [info ] [Thread-1 (]: 7 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m03:48:41.060817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m03:48:41.061279 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:48:41.068362 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:48:41.084141 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:48:41.087342 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m03:48:41.106646 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m03:48:41.107337 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m03:48:41.966876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m03:48:41.975152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a90c50>]}
[0m03:48:41.976396 [info ] [Thread-1 (]: 7 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 0.91s]
[0m03:48:41.977208 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:48:41.977759 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:48:41.978497 [info ] [Thread-1 (]: 8 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m03:48:41.979203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m03:48:41.979738 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:48:41.988891 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:48:42.008126 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:48:42.011586 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:48:42.024962 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:48:42.025699 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:48:42.925797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m03:48:42.931428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b68050>]}
[0m03:48:42.932877 [info ] [Thread-1 (]: 8 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 0.95s]
[0m03:48:42.934231 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:48:42.934924 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m03:48:42.935813 [info ] [Thread-1 (]: 9 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m03:48:42.936579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m03:48:42.937098 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m03:48:42.943781 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m03:48:42.947496 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m03:48:42.950446 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m03:48:42.953228 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m03:48:42.953724 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m03:48:43.684804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m03:48:43.690959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b4846f8-2319-4f6a-944b-9ae0e5ffc222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a92b10>]}
[0m03:48:43.691982 [info ] [Thread-1 (]: 9 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.75s]
[0m03:48:43.692774 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m03:48:43.694492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:43.694913 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_regions' was left open.
[0m03:48:43.695276 [debug] [MainThread]: On model.planetkart_analytics.dim_regions: Close
[0m03:48:43.997172 [info ] [MainThread]: 
[0m03:48:43.997895 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m03:48:44.000120 [debug] [MainThread]: Command end result
[0m03:48:44.124524 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:48:44.132264 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:48:44.140838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:48:44.141180 [info ] [MainThread]: 
[0m03:48:44.141532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:48:44.141796 [info ] [MainThread]: 
[0m03:48:44.142069 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m03:48:44.142504 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:48:44.148168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.040157, "process_in_blocks": "0", "process_kernel_time": 0.495612, "process_mem_max_rss": "166035456", "process_out_blocks": "0", "process_user_time": 2.70329}
[0m03:48:44.148696 [debug] [MainThread]: Command `dbt run` succeeded at 03:48:44.148606 after 9.04 seconds
[0m03:48:44.149044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b6bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b6b7d0>]}
[0m03:48:44.149350 [debug] [MainThread]: Flushing usage events
[0m03:48:45.308122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:08.390548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119407750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119407610>]}


============================== 03:50:08.397355 | 0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5 ==============================
[0m03:50:08.397355 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:50:08.397726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:50:09.237183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f235c0>]}
[0m03:50:09.265070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1e6690>]}
[0m03:50:09.266721 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:50:09.344953 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:50:09.532654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:50:09.533022 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://macros/get_custom_schema.sql
[0m03:50:09.583885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7e0450>]}
[0m03:50:09.635923 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:50:09.640921 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:50:09.689301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1d6a80>]}
[0m03:50:09.689641 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 591 macros
[0m03:50:09.689861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a329550>]}
[0m03:50:09.691335 [info ] [MainThread]: 
[0m03:50:09.691550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:50:09.691700 [info ] [MainThread]: 
[0m03:50:09.691965 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:50:09.694729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:50:09.904985 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:50:09.905221 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:50:09.905361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:50:10.503860 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.598 seconds
[0m03:50:10.511413 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:50:10.512073 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:50:10.629780 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.117 seconds
[0m03:50:10.637532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m03:50:10.655495 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m03:50:10.655953 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m03:50:10.763049 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.107 seconds
[0m03:50:10.769935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m03:50:10.775048 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:50:10.775526 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:50:10.872129 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m03:50:10.877714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m03:50:10.881685 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m03:50:10.882234 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m03:50:10.971995 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.089 seconds
[0m03:50:10.979174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b81add0>]}
[0m03:50:10.985931 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:50:10.986681 [info ] [Thread-1 (]: 1 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m03:50:10.987270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now model.planetkart_analytics.stg_customers)
[0m03:50:10.987723 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:50:10.998378 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:50:11.000830 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:50:11.028219 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:50:11.030503 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:50:11.030816 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:50:11.473583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m03:50:11.510996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbc8950>]}
[0m03:50:11.511793 [info ] [Thread-1 (]: 1 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.52s]
[0m03:50:11.512394 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:50:11.512780 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:50:11.513290 [info ] [Thread-1 (]: 2 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m03:50:11.513727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:50:11.514040 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:50:11.516643 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:50:11.535153 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:50:11.538206 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:50:11.551151 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:50:11.551526 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:50:11.743385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m03:50:11.748625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbea620>]}
[0m03:50:11.749790 [info ] [Thread-1 (]: 2 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.23s]
[0m03:50:11.750574 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:50:11.751082 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:50:11.751788 [info ] [Thread-1 (]: 3 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders ... [RUN]
[0m03:50:11.752445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:50:11.752927 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:50:11.757271 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:50:11.767429 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:50:11.771253 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:50:11.784753 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:50:11.785283 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:50:12.002728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m03:50:12.008679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b66eb70>]}
[0m03:50:12.009925 [info ] [Thread-1 (]: 3 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.26s]
[0m03:50:12.010678 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:50:12.011216 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:50:12.011910 [info ] [Thread-1 (]: 4 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products . [RUN]
[0m03:50:12.012579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:50:12.013077 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:50:12.017716 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:50:12.020767 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:50:12.025243 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m03:50:12.027714 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m03:50:12.028206 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m03:50:12.259454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m03:50:12.263815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bce4e50>]}
[0m03:50:12.264841 [info ] [Thread-1 (]: 4 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.25s]
[0m03:50:12.265773 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:50:12.266230 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:50:12.266817 [info ] [Thread-1 (]: 5 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions .. [RUN]
[0m03:50:12.267505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:50:12.267912 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:50:12.270826 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:50:12.280846 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:50:12.287035 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:50:12.303296 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:50:12.303733 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:50:12.508886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m03:50:12.514200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11be17e70>]}
[0m03:50:12.515619 [info ] [Thread-1 (]: 5 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.25s]
[0m03:50:12.516907 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:50:12.517496 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:50:12.518197 [info ] [Thread-1 (]: 6 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m03:50:12.518958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m03:50:12.519580 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:50:12.540628 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:50:12.542762 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:50:12.564079 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m03:50:12.568032 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m03:50:12.568448 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    case 
        when total_orders = 0 then 'Never_Purchased'
        when coalesce(days_since_last_order, 9999) <= 30 then 'Active'
        when coalesce(days_since_last_order, 9999) <= 90 then 'At_Risk'
        else 'Churned'
    end as lifecycle_stage,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m03:50:13.597037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.028 seconds
[0m03:50:13.603530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbd5bb0>]}
[0m03:50:13.605054 [info ] [Thread-1 (]: 6 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.08s]
[0m03:50:13.606128 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:50:13.606782 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:50:13.607528 [info ] [Thread-1 (]: 7 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m03:50:13.608261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m03:50:13.608808 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:50:13.616010 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:50:13.619002 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:50:13.623007 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m03:50:13.627451 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m03:50:13.628154 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m03:50:14.803095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.174 seconds
[0m03:50:14.809170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc6f350>]}
[0m03:50:14.810154 [info ] [Thread-1 (]: 7 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 1.20s]
[0m03:50:14.810921 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:50:14.811459 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:50:14.812177 [info ] [Thread-1 (]: 8 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m03:50:14.812818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m03:50:14.813305 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:50:14.821824 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:50:14.824742 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:50:14.828458 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:50:14.832950 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:50:14.833495 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:50:15.633005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m03:50:15.638983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc6fd70>]}
[0m03:50:15.640006 [info ] [Thread-1 (]: 8 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 0.83s]
[0m03:50:15.640758 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:50:15.641255 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m03:50:15.641947 [info ] [Thread-1 (]: 9 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m03:50:15.642637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m03:50:15.643157 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m03:50:15.648999 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m03:50:15.662697 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m03:50:15.666470 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m03:50:15.681308 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m03:50:15.681821 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m03:50:16.592347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.910 seconds
[0m03:50:16.597874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c493d2e-f46e-4b7f-b1bc-e5dbed376cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc6e870>]}
[0m03:50:16.599016 [info ] [Thread-1 (]: 9 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.96s]
[0m03:50:16.599822 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m03:50:16.602450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:50:16.602932 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_regions' was left open.
[0m03:50:16.603335 [debug] [MainThread]: On model.planetkart_analytics.dim_regions: Close
[0m03:50:16.728327 [info ] [MainThread]: 
[0m03:50:16.729201 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 7.04 seconds (7.04s).
[0m03:50:16.731795 [debug] [MainThread]: Command end result
[0m03:50:16.859399 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:50:16.867601 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:50:16.879294 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:50:16.879649 [info ] [MainThread]: 
[0m03:50:16.880020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:50:16.880295 [info ] [MainThread]: 
[0m03:50:16.880599 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m03:50:16.886935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.568324, "process_in_blocks": "0", "process_kernel_time": 0.475799, "process_mem_max_rss": "156352512", "process_out_blocks": "0", "process_user_time": 2.008938}
[0m03:50:16.887536 [debug] [MainThread]: Command `dbt run` succeeded at 03:50:16.887390 after 8.57 seconds
[0m03:50:16.887960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119283950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc5fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc5f950>]}
[0m03:50:16.888333 [debug] [MainThread]: Flushing usage events
[0m03:50:18.267273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:53:09.323003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c07610>]}


============================== 03:53:09.331458 | 8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b ==============================
[0m03:53:09.331458 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:53:09.331849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:53:10.087672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046235c0>]}
[0m03:53:10.117272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e6690>]}
[0m03:53:10.118929 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:53:10.191954 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:53:10.397110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:53:10.397936 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/staging/_sources.yml
[0m03:53:10.768811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f92050>]}
[0m03:53:10.819123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:53:10.823828 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:53:10.884901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111056a80>]}
[0m03:53:10.885261 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 591 macros
[0m03:53:10.885488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11139e5f0>]}
[0m03:53:10.887034 [info ] [MainThread]: 
[0m03:53:10.887266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:53:10.887434 [info ] [MainThread]: 
[0m03:53:10.887717 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:53:10.890753 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m03:53:11.106163 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:53:11.106415 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:53:11.106629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:53:11.619010 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.512 seconds
[0m03:53:11.627628 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m03:53:11.628322 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m03:53:11.737302 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.108 seconds
[0m03:53:11.745734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_snapshots)
[0m03:53:11.762672 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:53:11.763129 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:53:11.847836 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m03:53:11.852273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m03:53:11.856475 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m03:53:11.856994 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m03:53:11.977416 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.120 seconds
[0m03:53:11.982234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m03:53:11.986289 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m03:53:11.986725 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m03:53:12.109508 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.122 seconds
[0m03:53:12.113262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b013d0>]}
[0m03:53:12.119078 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:53:12.119726 [info ] [Thread-1 (]: 1 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m03:53:12.120234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now model.planetkart_analytics.stg_customers)
[0m03:53:12.120629 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:53:12.132719 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:53:12.166638 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:53:12.204743 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m03:53:12.230913 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m03:53:12.231263 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m03:53:12.467901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m03:53:12.504113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b1c410>]}
[0m03:53:12.504822 [info ] [Thread-1 (]: 1 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.38s]
[0m03:53:12.505396 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:53:12.505775 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:53:12.506345 [info ] [Thread-1 (]: 2 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m03:53:12.506850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:53:12.507215 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:53:12.510076 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:53:12.512587 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:53:12.515679 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m03:53:12.517632 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m03:53:12.517980 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m03:53:12.717339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m03:53:12.719279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b901b0>]}
[0m03:53:12.719763 [info ] [Thread-1 (]: 2 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.21s]
[0m03:53:12.720151 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:53:12.720407 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:53:12.720826 [info ] [Thread-1 (]: 3 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders ... [RUN]
[0m03:53:12.721206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:53:12.721453 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:53:12.727288 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:53:12.730261 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:53:12.732637 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m03:53:12.734291 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m03:53:12.734540 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m03:53:12.957623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m03:53:12.966266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bac2d0>]}
[0m03:53:12.968350 [info ] [Thread-1 (]: 3 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.24s]
[0m03:53:12.969999 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:53:12.970659 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:53:12.971483 [info ] [Thread-1 (]: 4 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products . [RUN]
[0m03:53:12.972194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:53:12.972711 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:53:12.977312 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:53:12.990577 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:53:12.994467 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m03:53:13.008548 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m03:53:13.009024 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m03:53:13.219129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m03:53:13.225592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd52d0>]}
[0m03:53:13.226689 [info ] [Thread-1 (]: 4 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.25s]
[0m03:53:13.227403 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:53:13.227845 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:53:13.228467 [info ] [Thread-1 (]: 5 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions .. [RUN]
[0m03:53:13.229106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:53:13.229572 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:53:13.233211 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:53:13.235505 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:53:13.243086 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m03:53:13.245097 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m03:53:13.245498 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m03:53:13.430598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m03:53:13.435588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112165e80>]}
[0m03:53:13.436926 [info ] [Thread-1 (]: 5 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.21s]
[0m03:53:13.438137 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:53:13.438716 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:53:13.439458 [info ] [Thread-1 (]: 6 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m03:53:13.440240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m03:53:13.440727 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:53:13.447829 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:53:13.463101 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:53:13.489411 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m03:53:13.511637 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m03:53:13.512210 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    case 
        when total_orders = 0 then 'Never_Purchased'
        when coalesce(days_since_last_order, 9999) <= 30 then 'Active'
        when coalesce(days_since_last_order, 9999) <= 90 then 'At_Risk'
        else 'Churned'
    end as lifecycle_stage,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m03:53:14.654030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.141 seconds
[0m03:53:14.659947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139bf0b0>]}
[0m03:53:14.660997 [info ] [Thread-1 (]: 6 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.22s]
[0m03:53:14.661791 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:53:14.662305 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:53:14.663032 [info ] [Thread-1 (]: 7 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m03:53:14.663716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m03:53:14.664230 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:53:14.671191 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:53:14.688941 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:53:14.692181 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m03:53:14.714222 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m03:53:14.714941 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m03:53:15.796731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.081 seconds
[0m03:53:15.803360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11397c1d0>]}
[0m03:53:15.804606 [info ] [Thread-1 (]: 7 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 1.14s]
[0m03:53:15.805432 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:53:15.805908 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:53:15.806583 [info ] [Thread-1 (]: 8 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m03:53:15.807253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m03:53:15.807749 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:53:15.816904 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:53:15.826984 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:53:15.830185 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m03:53:15.850630 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m03:53:15.851223 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m03:53:16.870671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.018 seconds
[0m03:53:16.877987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11397f8f0>]}
[0m03:53:16.879143 [info ] [Thread-1 (]: 8 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 1.07s]
[0m03:53:16.879926 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:53:16.880700 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m03:53:16.881984 [info ] [Thread-1 (]: 9 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m03:53:16.882780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m03:53:16.883291 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m03:53:16.888954 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m03:53:16.891911 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m03:53:16.895748 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m03:53:16.898846 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m03:53:16.899441 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m03:53:17.536866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m03:53:17.544245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8695a2bc-8aec-49ae-b2a4-acc5ecc9ec6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11397fb30>]}
[0m03:53:17.545125 [info ] [Thread-1 (]: 9 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.66s]
[0m03:53:17.545783 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m03:53:17.547119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:53:17.547404 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_regions' was left open.
[0m03:53:17.547676 [debug] [MainThread]: On model.planetkart_analytics.dim_regions: Close
[0m03:53:17.663755 [info ] [MainThread]: 
[0m03:53:17.664483 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m03:53:17.666787 [debug] [MainThread]: Command end result
[0m03:53:17.787664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:53:17.795310 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:53:17.802885 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:53:17.803218 [info ] [MainThread]: 
[0m03:53:17.803577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:53:17.803839 [info ] [MainThread]: 
[0m03:53:17.804143 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m03:53:17.810319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.551526, "process_in_blocks": "0", "process_kernel_time": 0.477939, "process_mem_max_rss": "164691968", "process_out_blocks": "0", "process_user_time": 2.257237}
[0m03:53:17.810837 [debug] [MainThread]: Command `dbt run` succeeded at 03:53:17.810695 after 8.55 seconds
[0m03:53:17.811258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf7950>]}
[0m03:53:17.811593 [debug] [MainThread]: Flushing usage events
[0m03:53:19.043232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:53:21.910055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a5b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae07610>]}


============================== 03:53:21.916279 | 2c6aba63-c23c-4b51-a8bd-07d871755d12 ==============================
[0m03:53:21.916279 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:53:21.916638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:53:22.686698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6aba63-c23c-4b51-a8bd-07d871755d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195235c0>]}
[0m03:53:22.714810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6aba63-c23c-4b51-a8bd-07d871755d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbe6690>]}
[0m03:53:22.716601 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:53:22.794306 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:53:23.002781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:53:23.003035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:53:23.031133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6aba63-c23c-4b51-a8bd-07d871755d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c10ec50>]}
[0m03:53:23.083611 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:53:23.087624 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:53:23.144407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6aba63-c23c-4b51-a8bd-07d871755d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce50c80>]}
[0m03:53:23.144749 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 591 macros
[0m03:53:23.144970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6aba63-c23c-4b51-a8bd-07d871755d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c456dd0>]}
[0m03:53:23.146725 [info ] [MainThread]: 
[0m03:53:23.146957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:53:23.147117 [info ] [MainThread]: 
[0m03:53:23.147396 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:53:23.150227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics'
[0m03:53:23.362131 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m03:53:23.362387 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m03:53:23.362536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:53:23.874965 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.512 seconds
[0m03:53:23.880175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m03:53:23.885704 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:53:23.886211 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:53:23.981494 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m03:53:23.987669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m03:53:23.993498 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m03:53:23.994214 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m03:53:24.110289 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.115 seconds
[0m03:53:24.116843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6aba63-c23c-4b51-a8bd-07d871755d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0bdf30>]}
[0m03:53:24.123450 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:53:24.124104 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase  [RUN]
[0m03:53:24.124707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13)
[0m03:53:24.125197 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:53:24.148214 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m03:53:24.150089 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:53:24.171678 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m03:53:24.174684 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m03:53:24.175026 [debug] [Thread-1 (]: On test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        revenue_segment as value_field,
        count(*) as n_records

    from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    group by revenue_segment

)

select *
from all_values
where value_field not in (
    'High_Value','Medium_Value','Low_Value','No_Purchase'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"} */
[0m03:53:24.380666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m03:53:24.397522 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase  [[32mPASS[0m in 0.27s]
[0m03:53:24.398372 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:53:24.398834 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:53:24.399344 [info ] [Thread-1 (]: 2 of 23 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m03:53:24.399942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13, now test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m03:53:24.400400 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:53:24.408508 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m03:53:24.410797 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:53:24.414109 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m03:53:24.416290 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m03:53:24.416740 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */
[0m03:53:24.808953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m03:53:24.815108 [info ] [Thread-1 (]: 2 of 23 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.42s]
[0m03:53:24.815933 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:53:24.816388 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:53:24.816881 [info ] [Thread-1 (]: 3 of 23 START test not_null_dim_customers_customer_sk .......................... [RUN]
[0m03:53:24.817420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863)
[0m03:53:24.817867 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:53:24.823238 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m03:53:24.825229 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:53:24.829028 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m03:53:24.831034 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m03:53:24.831411 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"} */
[0m03:53:24.974438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m03:53:24.980165 [info ] [Thread-1 (]: 3 of 23 PASS not_null_dim_customers_customer_sk ................................ [[32mPASS[0m in 0.16s]
[0m03:53:24.980975 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:53:24.981428 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:53:24.981887 [info ] [Thread-1 (]: 4 of 23 START test not_null_dim_products_product_id ............................ [RUN]
[0m03:53:24.982436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863, now test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m03:53:24.982849 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:53:24.987995 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m03:53:24.990044 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:53:24.993102 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m03:53:24.995361 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m03:53:24.995877 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"} */
[0m03:53:25.147446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m03:53:25.154653 [info ] [Thread-1 (]: 4 of 23 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.17s]
[0m03:53:25.155655 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:53:25.156316 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:53:25.156844 [info ] [Thread-1 (]: 5 of 23 START test not_null_dim_products_product_sk ............................ [RUN]
[0m03:53:25.157455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1, now test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9)
[0m03:53:25.157907 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:53:25.163270 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m03:53:25.165324 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:53:25.171972 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m03:53:25.174272 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m03:53:25.174655 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"} */
[0m03:53:25.355593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m03:53:25.361177 [info ] [Thread-1 (]: 5 of 23 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 0.20s]
[0m03:53:25.362461 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:53:25.363018 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:53:25.363593 [info ] [Thread-1 (]: 6 of 23 START test not_null_dim_regions_region_sk .............................. [RUN]
[0m03:53:25.364246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9, now test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db)
[0m03:53:25.364720 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:53:25.370835 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m03:53:25.372945 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:53:25.377038 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m03:53:25.379303 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m03:53:25.379781 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
where region_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"} */
[0m03:53:25.514118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m03:53:25.519004 [info ] [Thread-1 (]: 6 of 23 PASS not_null_dim_regions_region_sk .................................... [[32mPASS[0m in 0.15s]
[0m03:53:25.520109 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:53:25.520872 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:53:25.521672 [info ] [Thread-1 (]: 7 of 23 START test not_null_fact_orders_customer_sk ............................ [RUN]
[0m03:53:25.522369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db, now test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226)
[0m03:53:25.522824 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:53:25.528872 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m03:53:25.531530 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:53:25.534953 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m03:53:25.537167 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m03:53:25.537621 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where customer_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"} */
[0m03:53:25.888741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m03:53:25.895648 [info ] [Thread-1 (]: 7 of 23 PASS not_null_fact_orders_customer_sk .................................. [[32mPASS[0m in 0.37s]
[0m03:53:25.896463 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:53:25.896897 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:53:25.897362 [info ] [Thread-1 (]: 8 of 23 START test not_null_fact_orders_order_revenue .......................... [RUN]
[0m03:53:25.897910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226, now test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25)
[0m03:53:25.898324 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:53:25.902725 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m03:53:25.904725 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:53:25.907154 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m03:53:25.909408 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m03:53:25.909753 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_revenue
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where order_revenue is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"} */
[0m03:53:26.067674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m03:53:26.075131 [info ] [Thread-1 (]: 8 of 23 PASS not_null_fact_orders_order_revenue ................................ [[32mPASS[0m in 0.18s]
[0m03:53:26.075917 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:53:26.076354 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:53:26.076849 [info ] [Thread-1 (]: 9 of 23 START test not_null_fact_orders_order_sk ............................... [RUN]
[0m03:53:26.077416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25, now test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6)
[0m03:53:26.077833 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:53:26.082810 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m03:53:26.084725 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:53:26.087199 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m03:53:26.089120 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m03:53:26.089521 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where order_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"} */
[0m03:53:26.238615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m03:53:26.244543 [info ] [Thread-1 (]: 9 of 23 PASS not_null_fact_orders_order_sk ..................................... [[32mPASS[0m in 0.17s]
[0m03:53:26.245616 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:53:26.246134 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:53:26.246685 [info ] [Thread-1 (]: 10 of 23 START test source_not_null_planetkart_raw_customers_customer_id ....... [RUN]
[0m03:53:26.247277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6, now test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe)
[0m03:53:26.247763 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:53:26.253913 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m03:53:26.256345 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:53:26.259718 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m03:53:26.261918 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m03:53:26.262369 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from planetkart.planetkart_raw.customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"} */
[0m03:53:26.335292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m03:53:26.340846 [info ] [Thread-1 (]: 10 of 23 PASS source_not_null_planetkart_raw_customers_customer_id ............. [[32mPASS[0m in 0.09s]
[0m03:53:26.341805 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:53:26.342323 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:53:26.342912 [info ] [Thread-1 (]: 11 of 23 START test source_not_null_planetkart_raw_orders_order_id ............. [RUN]
[0m03:53:26.343575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe, now test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4)
[0m03:53:26.344074 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:53:26.350173 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m03:53:26.352939 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:53:26.355747 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m03:53:26.357831 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m03:53:26.358280 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from planetkart.planetkart_raw.orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"} */
[0m03:53:26.440819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m03:53:26.445334 [info ] [Thread-1 (]: 11 of 23 PASS source_not_null_planetkart_raw_orders_order_id ................... [[32mPASS[0m in 0.10s]
[0m03:53:26.446144 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:53:26.446649 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:53:26.447213 [info ] [Thread-1 (]: 12 of 23 START test source_not_null_planetkart_raw_products_product_id ......... [RUN]
[0m03:53:26.447887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4, now test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090)
[0m03:53:26.448401 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:53:26.454702 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m03:53:26.456791 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:53:26.459840 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m03:53:26.461898 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m03:53:26.462370 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from planetkart.planetkart_raw.products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"} */
[0m03:53:26.542244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m03:53:26.546845 [info ] [Thread-1 (]: 12 of 23 PASS source_not_null_planetkart_raw_products_product_id ............... [[32mPASS[0m in 0.10s]
[0m03:53:26.547870 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:53:26.548359 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:53:26.548913 [info ] [Thread-1 (]: 13 of 23 START test source_not_null_planetkart_raw_regions_region_id ........... [RUN]
[0m03:53:26.549557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090, now test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e)
[0m03:53:26.550072 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:53:26.556235 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m03:53:26.558584 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:53:26.561390 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m03:53:26.563335 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m03:53:26.563786 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from planetkart.planetkart_raw.regions
where region_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"} */
[0m03:53:26.654860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m03:53:26.662767 [info ] [Thread-1 (]: 13 of 23 PASS source_not_null_planetkart_raw_regions_region_id ................. [[32mPASS[0m in 0.11s]
[0m03:53:26.663856 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:53:26.664350 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:53:26.664935 [info ] [Thread-1 (]: 14 of 23 START test source_unique_planetkart_raw_customers_customer_id ......... [RUN]
[0m03:53:26.665594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e, now test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d)
[0m03:53:26.666150 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:53:26.675872 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m03:53:26.678459 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:53:26.681290 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m03:53:26.683286 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m03:53:26.683726 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"} */
[0m03:53:26.772316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m03:53:26.779276 [info ] [Thread-1 (]: 14 of 23 PASS source_unique_planetkart_raw_customers_customer_id ............... [[32mPASS[0m in 0.11s]
[0m03:53:26.780260 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:53:26.780773 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:53:26.781352 [info ] [Thread-1 (]: 15 of 23 START test source_unique_planetkart_raw_orders_order_id ............... [RUN]
[0m03:53:26.781979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d, now test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8)
[0m03:53:26.782505 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:53:26.788152 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m03:53:26.790243 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:53:26.793512 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m03:53:26.795680 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m03:53:26.796083 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"} */
[0m03:53:26.876091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m03:53:26.881152 [info ] [Thread-1 (]: 15 of 23 PASS source_unique_planetkart_raw_orders_order_id ..................... [[32mPASS[0m in 0.10s]
[0m03:53:26.881940 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:53:26.882437 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:53:26.883006 [info ] [Thread-1 (]: 16 of 23 START test source_unique_planetkart_raw_products_product_id ........... [RUN]
[0m03:53:26.883644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8, now test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb)
[0m03:53:26.884147 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:53:26.890021 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m03:53:26.892147 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:53:26.894946 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m03:53:26.897818 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m03:53:26.898236 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"} */
[0m03:53:26.990827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m03:53:26.996130 [info ] [Thread-1 (]: 16 of 23 PASS source_unique_planetkart_raw_products_product_id ................. [[32mPASS[0m in 0.11s]
[0m03:53:26.997288 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:53:26.997825 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:53:26.998420 [info ] [Thread-1 (]: 17 of 23 START test source_unique_planetkart_raw_regions_region_id ............. [RUN]
[0m03:53:26.999086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb, now test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f)
[0m03:53:26.999591 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:53:27.006672 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m03:53:27.009080 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:53:27.012268 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m03:53:27.014244 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m03:53:27.014666 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.regions
where region_id is not null
group by region_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"} */
[0m03:53:27.125532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m03:53:27.128123 [info ] [Thread-1 (]: 17 of 23 PASS source_unique_planetkart_raw_regions_region_id ................... [[32mPASS[0m in 0.13s]
[0m03:53:27.128867 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:53:27.129315 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:53:27.129829 [info ] [Thread-1 (]: 18 of 23 START test unique_dim_customers_customer_id ........................... [RUN]
[0m03:53:27.130401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f, now test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m03:53:27.130818 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:53:27.139319 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m03:53:27.140935 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:53:27.143637 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m03:53:27.145708 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m03:53:27.146049 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */
[0m03:53:27.298607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m03:53:27.303352 [info ] [Thread-1 (]: 18 of 23 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.17s]
[0m03:53:27.304366 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:53:27.304913 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:53:27.305481 [info ] [Thread-1 (]: 19 of 23 START test unique_dim_customers_customer_sk ........................... [RUN]
[0m03:53:27.306146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62)
[0m03:53:27.306634 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:53:27.313368 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m03:53:27.315590 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:53:27.318460 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m03:53:27.320783 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m03:53:27.321219 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_sk is not null
group by customer_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"} */
[0m03:53:27.438755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m03:53:27.445116 [info ] [Thread-1 (]: 19 of 23 PASS unique_dim_customers_customer_sk ................................. [[32mPASS[0m in 0.14s]
[0m03:53:27.446293 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:53:27.447076 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:53:27.447796 [info ] [Thread-1 (]: 20 of 23 START test unique_dim_products_product_id ............................. [RUN]
[0m03:53:27.448526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62, now test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m03:53:27.449027 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:53:27.455994 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m03:53:27.458144 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:53:27.460942 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m03:53:27.463710 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m03:53:27.464236 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"} */
[0m03:53:27.587190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m03:53:27.592570 [info ] [Thread-1 (]: 20 of 23 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.14s]
[0m03:53:27.593664 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:53:27.594201 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:53:27.594773 [info ] [Thread-1 (]: 21 of 23 START test unique_dim_products_product_sk ............................. [RUN]
[0m03:53:27.595404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985, now test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b)
[0m03:53:27.595890 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:53:27.602527 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m03:53:27.604789 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:53:27.608692 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m03:53:27.611266 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m03:53:27.611751 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_sk is not null
group by product_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"} */
[0m03:53:27.756765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m03:53:27.761632 [info ] [Thread-1 (]: 21 of 23 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 0.17s]
[0m03:53:27.762824 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:53:27.763534 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:53:27.764213 [info ] [Thread-1 (]: 22 of 23 START test unique_dim_regions_region_sk ............................... [RUN]
[0m03:53:27.764882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b, now test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d)
[0m03:53:27.765359 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:53:27.772110 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m03:53:27.774584 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:53:27.777335 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m03:53:27.779307 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m03:53:27.779736 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
where region_sk is not null
group by region_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"} */
[0m03:53:27.926541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m03:53:27.930531 [info ] [Thread-1 (]: 22 of 23 PASS unique_dim_regions_region_sk ..................................... [[32mPASS[0m in 0.17s]
[0m03:53:27.931443 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:53:27.931955 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:53:27.932510 [info ] [Thread-1 (]: 23 of 23 START test unique_fact_orders_order_sk ................................ [RUN]
[0m03:53:27.933128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d, now test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c)
[0m03:53:27.933598 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:53:27.939480 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m03:53:27.941482 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:53:27.945276 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m03:53:27.947470 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m03:53:27.947895 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where order_sk is not null
group by order_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"} */
[0m03:53:28.091314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m03:53:28.096425 [info ] [Thread-1 (]: 23 of 23 PASS unique_fact_orders_order_sk ...................................... [[32mPASS[0m in 0.16s]
[0m03:53:28.097677 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:53:28.099573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:53:28.100009 [debug] [MainThread]: Connection 'test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c' was left open.
[0m03:53:28.100405 [debug] [MainThread]: On test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c: Close
[0m03:53:28.235823 [info ] [MainThread]: 
[0m03:53:28.237220 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m03:53:28.241862 [debug] [MainThread]: Command end result
[0m03:53:28.356099 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:53:28.363353 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:53:28.375369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:53:28.375721 [info ] [MainThread]: 
[0m03:53:28.376062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:53:28.376339 [info ] [MainThread]: 
[0m03:53:28.376633 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m03:53:28.382019 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.5408716, "process_in_blocks": "0", "process_kernel_time": 0.408624, "process_mem_max_rss": "163069952", "process_out_blocks": "0", "process_user_time": 2.238367}
[0m03:53:28.382752 [debug] [MainThread]: Command `dbt test` succeeded at 03:53:28.382630 after 6.54 seconds
[0m03:53:28.383147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae6c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6f0d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6f0ec0>]}
[0m03:53:28.383617 [debug] [MainThread]: Flushing usage events
[0m03:53:29.414717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:54:46.510204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961b610>]}


============================== 03:54:46.517048 | 4af3810f-7415-4dca-bb1e-114469fbd7a5 ==============================
[0m03:54:46.517048 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:54:46.517429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:47.299015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4af3810f-7415-4dca-bb1e-114469fbd7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089335c0>]}
[0m03:54:47.327833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4af3810f-7415-4dca-bb1e-114469fbd7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12e690>]}
[0m03:54:47.329696 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:54:47.407886 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:54:47.602430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:54:47.602816 [debug] [MainThread]: Partial parsing: added file: planetkart_analytics://macros/calculate_profit_segment.sql
[0m03:54:47.654845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4af3810f-7415-4dca-bb1e-114469fbd7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a700550>]}
[0m03:54:47.711389 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:54:47.716837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:54:47.779002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4af3810f-7415-4dca-bb1e-114469fbd7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a122a80>]}
[0m03:54:47.779380 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m03:54:47.779608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4af3810f-7415-4dca-bb1e-114469fbd7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a79b3f0>]}
[0m03:54:47.781148 [info ] [MainThread]: 
[0m03:54:47.781370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:54:47.781537 [info ] [MainThread]: 
[0m03:54:47.781850 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:54:47.784899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage'
[0m03:54:48.002900 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m03:54:48.003136 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m03:54:48.003279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:48.584962 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.581 seconds
[0m03:54:48.592545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m03:54:48.597599 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:54:48.598204 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:54:48.724402 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m03:54:48.728340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m03:54:48.731910 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m03:54:48.732417 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m03:54:48.845286 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.112 seconds
[0m03:54:48.851571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4af3810f-7415-4dca-bb1e-114469fbd7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaf2340>]}
[0m03:54:48.852887 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 3 sources
[0m03:54:49.128018 [debug] [MainThread]: Using snowflake connection "master"
[0m03:54:49.128823 [debug] [MainThread]: On master: select table_schema as schema,
               table_name as identifier,
               last_altered as last_modified,
               convert_timezone('UTC', current_timestamp()) as snapshotted_at
        from planetkart.INFORMATION_SCHEMA.tables
        where ((upper(table_schema) = upper('planetkart_raw') and
             upper(table_name) = upper('products')) or (upper(table_schema) = upper('planetkart_raw') and
             upper(table_name) = upper('orders')) or (upper(table_schema) = upper('planetkart_raw') and
             upper(table_name) = upper('customers')))
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "master"} */
[0m03:54:50.274212 [debug] [MainThread]: SQL status: SUCCESS 3 in 1.144 seconds
[0m03:54:50.285887 [debug] [Thread-1 (]: Began running node source.planetkart_analytics.planetkart_raw.customers
[0m03:54:50.286482 [info ] [Thread-1 (]: 1 of 3 START freshness of planetkart_raw.customers ............................. [RUN]
[0m03:54:50.287061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now source.planetkart_analytics.planetkart_raw.customers)
[0m03:54:50.287485 [debug] [Thread-1 (]: Began compiling node source.planetkart_analytics.planetkart_raw.customers
[0m03:54:50.287910 [debug] [Thread-1 (]: Began executing node source.planetkart_analytics.planetkart_raw.customers
[0m03:54:50.288902 [info ] [Thread-1 (]: 1 of 3 PASS freshness of planetkart_raw.customers .............................. [[32mPASS[0m in 0.00s]
[0m03:54:50.289495 [debug] [Thread-1 (]: Finished running node source.planetkart_analytics.planetkart_raw.customers
[0m03:54:50.289886 [debug] [Thread-1 (]: Began running node source.planetkart_analytics.planetkart_raw.orders
[0m03:54:50.290287 [info ] [Thread-1 (]: 2 of 3 START freshness of planetkart_raw.orders ................................ [RUN]
[0m03:54:50.290625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly source.planetkart_analytics.planetkart_raw.customers, now source.planetkart_analytics.planetkart_raw.orders)
[0m03:54:50.290915 [debug] [Thread-1 (]: Began compiling node source.planetkart_analytics.planetkart_raw.orders
[0m03:54:50.291207 [debug] [Thread-1 (]: Began executing node source.planetkart_analytics.planetkart_raw.orders
[0m03:54:50.291840 [info ] [Thread-1 (]: 2 of 3 PASS freshness of planetkart_raw.orders ................................. [[32mPASS[0m in 0.00s]
[0m03:54:50.292526 [debug] [Thread-1 (]: Finished running node source.planetkart_analytics.planetkart_raw.orders
[0m03:54:50.292843 [debug] [Thread-1 (]: Began running node source.planetkart_analytics.planetkart_raw.products
[0m03:54:50.293258 [info ] [Thread-1 (]: 3 of 3 START freshness of planetkart_raw.products .............................. [RUN]
[0m03:54:50.293783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly source.planetkart_analytics.planetkart_raw.orders, now source.planetkart_analytics.planetkart_raw.products)
[0m03:54:50.294162 [debug] [Thread-1 (]: Began compiling node source.planetkart_analytics.planetkart_raw.products
[0m03:54:50.294487 [debug] [Thread-1 (]: Began executing node source.planetkart_analytics.planetkart_raw.products
[0m03:54:50.295204 [info ] [Thread-1 (]: 3 of 3 PASS freshness of planetkart_raw.products ............................... [[32mPASS[0m in 0.00s]
[0m03:54:50.295687 [debug] [Thread-1 (]: Finished running node source.planetkart_analytics.planetkart_raw.products
[0m03:54:50.296706 [debug] [MainThread]: Connection 'master' was left open.
[0m03:54:50.297012 [debug] [MainThread]: On master: Close
[0m03:54:50.784991 [debug] [MainThread]: Connection 'source.planetkart_analytics.planetkart_raw.products' was left open.
[0m03:54:50.786119 [debug] [MainThread]: On source.planetkart_analytics.planetkart_raw.products: Close
[0m03:54:50.906827 [info ] [MainThread]: 
[0m03:54:50.907698 [info ] [MainThread]: Finished running 3 sources in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m03:54:51.026629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:54:51.034380 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:54:51.040872 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/sources.json
[0m03:54:51.041260 [info ] [MainThread]: Done.
[0m03:54:51.047522 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 4.599805, "process_in_blocks": "0", "process_kernel_time": 0.425653, "process_mem_max_rss": "158089216", "process_out_blocks": "0", "process_user_time": 1.642979}
[0m03:54:51.048165 [debug] [MainThread]: Command `dbt source freshness` succeeded at 03:54:51.048052 after 4.60 seconds
[0m03:54:51.048920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096784d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f96b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f96afc0>]}
[0m03:54:51.049406 [debug] [MainThread]: Flushing usage events
[0m03:54:52.154565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:55:04.654884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a03750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a03610>]}


============================== 03:55:04.661254 | a88f5524-44a2-4dd9-9b70-a07338d4d6f9 ==============================
[0m03:55:04.661254 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:55:04.661631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:55:05.334943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88f5524-44a2-4dd9-9b70-a07338d4d6f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c135c0>]}
[0m03:55:05.363201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88f5524-44a2-4dd9-9b70-a07338d4d6f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e2690>]}
[0m03:55:05.365388 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m03:55:05.442133 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m03:55:05.648572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:55:05.648807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:55:05.676644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88f5524-44a2-4dd9-9b70-a07338d4d6f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f92c50>]}
[0m03:55:05.698543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88f5524-44a2-4dd9-9b70-a07338d4d6f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d389b0>]}
[0m03:55:05.698830 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m03:55:05.699006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88f5524-44a2-4dd9-9b70-a07338d4d6f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d25390>]}
[0m03:55:05.700461 [info ] [MainThread]: 
[0m03:55:05.700644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:55:05.700770 [info ] [MainThread]: 
[0m03:55:05.701001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:55:05.703327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics'
[0m03:55:05.891366 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m03:55:05.891622 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m03:55:05.891773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:06.446518 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.554 seconds
[0m03:55:06.451676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m03:55:06.456102 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m03:55:06.456597 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m03:55:06.544129 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.087 seconds
[0m03:55:06.548316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m03:55:06.552324 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m03:55:06.552825 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m03:55:06.656319 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.103 seconds
[0m03:55:06.662460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88f5524-44a2-4dd9-9b70-a07338d4d6f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dbe680>]}
[0m03:55:06.669796 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m03:55:06.670518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now model.planetkart_analytics.stg_customers)
[0m03:55:06.671025 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m03:55:06.686861 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m03:55:06.689662 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m03:55:06.690465 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m03:55:06.690902 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m03:55:06.691387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m03:55:06.691848 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m03:55:06.694878 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m03:55:06.718334 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m03:55:06.719032 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m03:55:06.719456 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m03:55:06.719925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m03:55:06.720339 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m03:55:06.724079 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m03:55:06.737378 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m03:55:06.738179 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m03:55:06.738659 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m03:55:06.739172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m03:55:06.739659 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m03:55:06.742711 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m03:55:06.744745 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m03:55:06.745363 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m03:55:06.745737 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m03:55:06.746153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m03:55:06.746587 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m03:55:06.749636 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m03:55:06.760879 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m03:55:06.761536 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m03:55:06.761935 [debug] [Thread-1 (]: Began running node snapshot.planetkart_analytics.snap_customers
[0m03:55:06.762390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now snapshot.planetkart_analytics.snap_customers)
[0m03:55:06.762750 [debug] [Thread-1 (]: Began compiling node snapshot.planetkart_analytics.snap_customers
[0m03:55:06.766911 [debug] [Thread-1 (]: Began executing node snapshot.planetkart_analytics.snap_customers
[0m03:55:06.767656 [debug] [Thread-1 (]: Finished running node snapshot.planetkart_analytics.snap_customers
[0m03:55:06.768067 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:55:06.768485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.planetkart_analytics.snap_customers, now test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe)
[0m03:55:06.768847 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:55:06.780809 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m03:55:06.793077 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:55:06.793762 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m03:55:06.794130 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:55:06.794538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe, now test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4)
[0m03:55:06.794931 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:55:06.799354 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m03:55:06.811917 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:55:06.812486 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m03:55:06.812816 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:55:06.813192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4, now test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090)
[0m03:55:06.813567 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:55:06.817040 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m03:55:06.825284 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:55:06.825816 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m03:55:06.826138 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:55:06.826518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090, now test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e)
[0m03:55:06.826900 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:55:06.830719 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m03:55:06.841055 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:55:06.841587 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m03:55:06.841946 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:55:06.842299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e, now test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d)
[0m03:55:06.842658 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:55:06.848145 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m03:55:06.857340 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:55:06.857860 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m03:55:06.858172 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:55:06.858484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d, now test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8)
[0m03:55:06.858822 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:55:06.862608 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m03:55:06.871329 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:55:06.871879 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m03:55:06.872201 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:55:06.872561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8, now test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb)
[0m03:55:06.872922 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:55:06.876007 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m03:55:06.884722 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:55:06.885181 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m03:55:06.885457 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:55:06.885771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb, now test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f)
[0m03:55:06.886123 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:55:06.889701 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m03:55:06.898589 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:55:06.899137 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m03:55:06.899477 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m03:55:06.899791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f, now model.planetkart_analytics.dim_customers)
[0m03:55:06.900142 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m03:55:06.912956 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m03:55:06.915130 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m03:55:06.915536 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m03:55:06.915781 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m03:55:06.916085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m03:55:06.916422 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m03:55:06.919704 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m03:55:06.921513 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m03:55:06.921893 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m03:55:06.922132 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m03:55:06.922401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m03:55:06.922671 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m03:55:06.926399 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m03:55:06.928514 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m03:55:06.928946 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m03:55:06.929196 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m03:55:06.929459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m03:55:06.929723 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m03:55:06.932314 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m03:55:06.946171 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m03:55:06.946601 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m03:55:06.946864 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:55:06.947175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13)
[0m03:55:06.947423 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:55:06.954631 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m03:55:06.968060 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:55:06.968542 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m03:55:06.968814 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:55:06.969097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13, now test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m03:55:06.969375 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:55:06.972417 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m03:55:06.981874 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:55:06.982288 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m03:55:06.982531 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:55:06.982803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863)
[0m03:55:06.983070 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:55:06.985633 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m03:55:06.993297 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:55:06.993690 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m03:55:06.993922 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:55:06.994187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863, now test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m03:55:06.994436 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:55:06.997245 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m03:55:07.005288 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:55:07.005876 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m03:55:07.006194 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:55:07.006524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62)
[0m03:55:07.006796 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:55:07.009369 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m03:55:07.017279 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:55:07.017758 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m03:55:07.018035 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:55:07.018331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62, now test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m03:55:07.018619 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:55:07.021708 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m03:55:07.029370 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:55:07.029865 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m03:55:07.030164 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:55:07.030478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1, now test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9)
[0m03:55:07.030767 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:55:07.033582 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m03:55:07.041614 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:55:07.042099 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m03:55:07.042386 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:55:07.042691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9, now test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m03:55:07.042978 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:55:07.048095 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m03:55:07.057103 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:55:07.057548 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m03:55:07.057819 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:55:07.058121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985, now test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b)
[0m03:55:07.058415 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:55:07.061104 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m03:55:07.069917 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:55:07.070365 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m03:55:07.070629 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:55:07.070933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b, now test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226)
[0m03:55:07.071233 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:55:07.074029 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m03:55:07.081508 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:55:07.081968 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m03:55:07.082240 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:55:07.082548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226, now test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25)
[0m03:55:07.082851 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:55:07.086249 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m03:55:07.093270 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:55:07.093730 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m03:55:07.093998 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:55:07.094306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25, now test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6)
[0m03:55:07.094603 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:55:07.097265 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m03:55:07.101986 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:55:07.102392 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m03:55:07.102635 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:55:07.102871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6, now test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c)
[0m03:55:07.103123 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:55:07.106129 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m03:55:07.115963 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:55:07.116439 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m03:55:07.116717 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:55:07.117029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c, now test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db)
[0m03:55:07.117357 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:55:07.120338 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m03:55:07.128754 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:55:07.129304 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m03:55:07.129605 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:55:07.129929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db, now test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d)
[0m03:55:07.130214 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:55:07.133433 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m03:55:07.138337 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:55:07.138801 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m03:55:07.139506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:55:07.139742 [debug] [MainThread]: Connection 'test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d' was left open.
[0m03:55:07.139955 [debug] [MainThread]: On test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d: Close
[0m03:55:07.257104 [debug] [MainThread]: Command end result
[0m03:55:07.340882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:55:07.345784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:55:07.351787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m03:55:07.356096 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m03:55:07.356281 [info ] [MainThread]: Building catalog
[0m03:55:07.362071 [debug] [ThreadPool]: Acquiring new snowflake connection 'PLANETKART.information_schema'
[0m03:55:07.371827 [debug] [ThreadPool]: Using snowflake connection "PLANETKART.information_schema"
[0m03:55:07.372383 [debug] [ThreadPool]: On PLANETKART.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PLANETKART.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_regions' and upper("table_name") = upper('stg_regions')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_regions' and upper("table_name") = upper('dim_regions')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PLANETKART.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_regions' and upper("table_name") = upper('stg_regions')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_regions' and upper("table_name") = upper('dim_regions')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "PLANETKART.information_schema"} */
[0m03:55:07.372866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:12.637043 [debug] [ThreadPool]: SQL status: SUCCESS 97 in 5.264 seconds
[0m03:55:12.650049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly PLANETKART.information_schema, now planetkart.information_schema)
[0m03:55:12.654028 [debug] [ThreadPool]: Using snowflake connection "planetkart.information_schema"
[0m03:55:12.654545 [debug] [ThreadPool]: On planetkart.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from planetkart.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'regions' and upper("table_name") = upper('regions')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'order_items' and upper("table_name") = upper('order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from planetkart.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'regions' and upper("table_name") = upper('regions')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'order_items' and upper("table_name") = upper('order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "planetkart.information_schema"} */
[0m03:55:14.942524 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 2.287 seconds
[0m03:55:14.989824 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/catalog.json
[0m03:55:15.093827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m03:55:15.100241 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m03:55:15.100554 [info ] [MainThread]: Catalog written to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/catalog.json
[0m03:55:15.105889 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.524953, "process_in_blocks": "0", "process_kernel_time": 0.450355, "process_mem_max_rss": "160120832", "process_out_blocks": "0", "process_user_time": 1.954031}
[0m03:55:15.106678 [debug] [MainThread]: Command `dbt docs generate` succeeded at 03:55:15.106563 after 10.53 seconds
[0m03:55:15.106965 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m03:55:15.107180 [debug] [MainThread]: Connection 'planetkart.information_schema' was left open.
[0m03:55:15.107375 [debug] [MainThread]: On planetkart.information_schema: Close
[0m03:55:15.728519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ebac0>]}
[0m03:55:15.729495 [debug] [MainThread]: Flushing usage events
[0m03:55:16.997295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:55:21.172560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ab4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a03750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a03610>]}


============================== 03:55:21.177714 | 60f210cb-f9a8-4c6f-85b5-153cdfcd3315 ==============================
[0m03:55:21.177714 [info ] [MainThread]: Running with dbt=1.10.4
[0m03:55:21.178118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:55:21.940458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f210cb-f9a8-4c6f-85b5-153cdfcd3315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bb5c0>]}
[0m03:55:21.968533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60f210cb-f9a8-4c6f-85b5-153cdfcd3315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e27a0>]}
[0m03:55:51.751550 [error] [MainThread]: Encountered an error:

[0m03:55:51.765252 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m03:55:51.771298 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 30.662617, "process_in_blocks": "0", "process_kernel_time": 0.361187, "process_mem_max_rss": "133283840", "process_out_blocks": "0", "process_user_time": 1.387487}
[0m03:55:51.773166 [debug] [MainThread]: Command `dbt docs serve` failed at 03:55:51.772742 after 30.66 seconds
[0m03:55:51.774008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab86250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab86450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7a300>]}
[0m03:55:51.774622 [debug] [MainThread]: Flushing usage events
[0m03:55:52.867624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:20:16.081841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5b610>]}


============================== 04:20:16.088191 | c292b53d-3507-4657-a5e4-da75b06e013e ==============================
[0m04:20:16.088191 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:20:16.088573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:20:16.884629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c292b53d-3507-4657-a5e4-da75b06e013e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081775c0>]}
[0m04:20:16.913513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c292b53d-3507-4657-a5e4-da75b06e013e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109972690>]}
[0m04:20:16.915138 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m04:20:16.993815 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m04:20:17.208751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:20:17.209202 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/marts/dim_customers.sql
[0m04:20:17.422242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c292b53d-3507-4657-a5e4-da75b06e013e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f75750>]}
[0m04:20:17.474160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:20:17.479253 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:20:17.538907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c292b53d-3507-4657-a5e4-da75b06e013e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109962a80>]}
[0m04:20:17.539257 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m04:20:17.539488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c292b53d-3507-4657-a5e4-da75b06e013e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ada5fd0>]}
[0m04:20:17.540683 [info ] [MainThread]: 
[0m04:20:17.540911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:20:17.541072 [info ] [MainThread]: 
[0m04:20:17.541370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:20:17.541908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m04:20:17.755221 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m04:20:17.755460 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m04:20:17.755607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:20:19.033891 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.278 seconds
[0m04:20:19.045151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m04:20:19.061583 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m04:20:19.062062 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m04:20:19.243357 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.181 seconds
[0m04:20:19.249623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m04:20:19.254022 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m04:20:19.254485 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m04:20:19.421568 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.166 seconds
[0m04:20:19.426360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m04:20:19.430216 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m04:20:19.430651 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m04:20:19.546700 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m04:20:19.553248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c292b53d-3507-4657-a5e4-da75b06e013e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b27eea0>]}
[0m04:20:19.559497 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m04:20:19.560146 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m04:20:19.560655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.dim_customers)
[0m04:20:19.561060 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m04:20:19.572401 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m04:20:19.596663 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m04:20:19.626140 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m04:20:19.630564 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m04:20:19.631042 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        max(o.order_date) as last_order_date,
        datediff('day', max(o.order_date), current_date()) as days_since_last_order
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Improved lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'              -- 3+ orders = proven loyalty
        when total_orders = 2 then 'Repeat_Customer'              -- 2 orders = coming back
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'  -- 1 big order = high potential
        else 'One_Time_Buyer'                                      -- 1 small order = needs nurturing
    end as lifecycle_stage,
    
    -- Additional customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m04:20:21.954508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.322 seconds
[0m04:20:21.993246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c292b53d-3507-4657-a5e4-da75b06e013e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b376090>]}
[0m04:20:21.994049 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 2.43s]
[0m04:20:21.994688 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m04:20:21.995933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:20:21.996280 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_customers' was left open.
[0m04:20:21.996565 [debug] [MainThread]: On model.planetkart_analytics.dim_customers: Close
[0m04:20:22.106483 [info ] [MainThread]: 
[0m04:20:22.107005 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m04:20:22.107749 [debug] [MainThread]: Command end result
[0m04:20:22.198203 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:20:22.204604 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:20:22.214438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m04:20:22.214701 [info ] [MainThread]: 
[0m04:20:22.214931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:20:22.215093 [info ] [MainThread]: 
[0m04:20:22.215273 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:20:22.220281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.209608, "process_in_blocks": "0", "process_kernel_time": 0.537874, "process_mem_max_rss": "164069376", "process_out_blocks": "0", "process_user_time": 2.00847}
[0m04:20:22.220723 [debug] [MainThread]: Command `dbt run` succeeded at 04:20:22.220544 after 6.21 seconds
[0m04:20:22.221001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2bbd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b29def0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b29e5d0>]}
[0m04:20:22.221241 [debug] [MainThread]: Flushing usage events
[0m04:20:23.446130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:22:47.944887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105253750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105253610>]}


============================== 04:22:47.950824 | f69e1aa3-7a3c-468d-aa36-d76982d9c21e ==============================
[0m04:22:47.950824 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:22:47.951202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:22:48.734798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f69e1aa3-7a3c-468d-aa36-d76982d9c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456f5c0>]}
[0m04:22:48.763892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f69e1aa3-7a3c-468d-aa36-d76982d9c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36690>]}
[0m04:22:48.765937 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m04:22:48.841623 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m04:22:49.064058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:22:49.064505 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/marts/dim_customers.sql
[0m04:22:49.280721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f69e1aa3-7a3c-468d-aa36-d76982d9c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106339450>]}
[0m04:22:49.333786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:22:49.338967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:22:49.385082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f69e1aa3-7a3c-468d-aa36-d76982d9c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d26a80>]}
[0m04:22:49.385395 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m04:22:49.385600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f69e1aa3-7a3c-468d-aa36-d76982d9c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ede10>]}
[0m04:22:49.386676 [info ] [MainThread]: 
[0m04:22:49.386875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:22:49.387020 [info ] [MainThread]: 
[0m04:22:49.387281 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:22:49.387759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m04:22:49.604184 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m04:22:49.604426 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m04:22:49.604571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:22:50.146751 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.542 seconds
[0m04:22:50.153948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_snapshots)
[0m04:22:50.161787 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m04:22:50.162094 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m04:22:50.288820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.127 seconds
[0m04:22:50.289933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m04:22:50.291014 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m04:22:50.291187 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m04:22:50.391028 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.099 seconds
[0m04:22:50.397150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m04:22:50.401629 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m04:22:50.402074 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m04:22:50.492273 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.090 seconds
[0m04:22:50.498980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f69e1aa3-7a3c-468d-aa36-d76982d9c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dac30>]}
[0m04:22:50.505551 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m04:22:50.506311 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m04:22:50.506894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now model.planetkart_analytics.dim_customers)
[0m04:22:50.507433 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m04:22:50.517599 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m04:22:50.520059 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m04:22:50.548502 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m04:22:50.572743 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m04:22:50.573265 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    coalesce(days_since_last_order, 9999) as days_since_last_order,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS (Added back!)
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 and datediff('day', signup_date, last_order_date) <= 60 then 'Fast_Repeat'
        when total_orders = 2 and datediff('day', signup_date, last_order_date) > 60 then 'Slow_Repeat'
        when total_orders = 1 and datediff('day', signup_date, '2024-06-30') >= 90 then 'Single_Old'
        else 'Single_Recent'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m04:22:50.687871 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdd2fc-0001-2a9a-0000-000a0e0a4ce1
[0m04:22:50.688620 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMER_METRICS' does not exist or not authorized.
[0m04:22:50.698623 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/dim_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMER_METRICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/dim_customers.sql
[0m04:22:50.702117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f69e1aa3-7a3c-468d-aa36-d76982d9c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b804650>]}
[0m04:22:50.702934 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[31mERROR[0m in 0.19s]
[0m04:22:50.703614 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m04:22:50.704206 [debug] [Thread-4 (]: Marking all children of 'model.planetkart_analytics.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/dim_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMER_METRICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/dim_customers.sql.
[0m04:22:50.706167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:22:50.706523 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_customers' was left open.
[0m04:22:50.706831 [debug] [MainThread]: On model.planetkart_analytics.dim_customers: Close
[0m04:22:50.823399 [info ] [MainThread]: 
[0m04:22:50.824092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m04:22:50.825064 [debug] [MainThread]: Command end result
[0m04:22:50.940716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:22:50.946760 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:22:50.953078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m04:22:50.953460 [info ] [MainThread]: 
[0m04:22:50.953809 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m04:22:50.954082 [info ] [MainThread]: 
[0m04:22:50.954431 [error] [MainThread]: [31mFailure in model dim_customers (models/marts/dim_customers.sql)[0m
[0m04:22:50.954755 [error] [MainThread]:   Database Error in model dim_customers (models/marts/dim_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMER_METRICS' does not exist or not authorized.
  compiled code at target/run/planetkart_analytics/models/marts/dim_customers.sql
[0m04:22:50.955002 [info ] [MainThread]: 
[0m04:22:50.955499 [info ] [MainThread]:   compiled code at target/compiled/planetkart_analytics/models/marts/dim_customers.sql
[0m04:22:50.955737 [info ] [MainThread]: 
[0m04:22:50.956017 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m04:22:50.962108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0833652, "process_in_blocks": "0", "process_kernel_time": 0.452096, "process_mem_max_rss": "162381824", "process_out_blocks": "0", "process_user_time": 1.821671}
[0m04:22:50.962709 [debug] [MainThread]: Command `dbt run` failed at 04:22:50.962608 after 3.08 seconds
[0m04:22:50.963097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107473bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10110b570>]}
[0m04:22:50.963461 [debug] [MainThread]: Flushing usage events
[0m04:22:52.056735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:23:46.456662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eab4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109707750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109707610>]}


============================== 04:23:46.462804 | a6ccc87a-bb3e-49e2-980c-68ae6dfb5239 ==============================
[0m04:23:46.462804 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:23:46.463188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:23:47.309947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ccc87a-bb3e-49e2-980c-68ae6dfb5239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b75c0>]}
[0m04:23:47.338868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ccc87a-bb3e-49e2-980c-68ae6dfb5239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e6690>]}
[0m04:23:47.340615 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m04:23:47.416729 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m04:23:47.634519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:23:47.634987 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/marts/dim_customers.sql
[0m04:23:47.847499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6ccc87a-bb3e-49e2-980c-68ae6dfb5239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aae9450>]}
[0m04:23:47.899692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:23:47.904730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:23:47.966718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6ccc87a-bb3e-49e2-980c-68ae6dfb5239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d6a80>]}
[0m04:23:47.967086 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m04:23:47.967313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ccc87a-bb3e-49e2-980c-68ae6dfb5239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa6190>]}
[0m04:23:47.968497 [info ] [MainThread]: 
[0m04:23:47.968719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:23:47.968883 [info ] [MainThread]: 
[0m04:23:47.969163 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:23:47.969669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m04:23:48.186175 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m04:23:48.186415 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m04:23:48.186557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:23:48.745277 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.558 seconds
[0m04:23:48.760011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m04:23:48.776967 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m04:23:48.777390 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m04:23:48.861924 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.084 seconds
[0m04:23:48.866661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m04:23:48.870784 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m04:23:48.871282 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m04:23:48.970854 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.099 seconds
[0m04:23:48.975445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m04:23:48.981009 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m04:23:48.981536 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m04:23:49.078457 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m04:23:49.081584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ccc87a-bb3e-49e2-980c-68ae6dfb5239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb4aa90>]}
[0m04:23:49.086679 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m04:23:49.087481 [info ] [Thread-1 (]: 1 of 1 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m04:23:49.088102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.dim_customers)
[0m04:23:49.088591 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m04:23:49.101018 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m04:23:49.107436 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m04:23:49.133997 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m04:23:49.138032 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m04:23:49.138484 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 then 'Repeat_Engagement'
        else 'Single_Engagement'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m04:23:50.429413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.290 seconds
[0m04:23:50.465650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ccc87a-bb3e-49e2-980c-68ae6dfb5239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb04e90>]}
[0m04:23:50.466447 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.37s]
[0m04:23:50.466984 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m04:23:50.468076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:23:50.468378 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_customers' was left open.
[0m04:23:50.468625 [debug] [MainThread]: On model.planetkart_analytics.dim_customers: Close
[0m04:23:50.586795 [info ] [MainThread]: 
[0m04:23:50.587453 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m04:23:50.588400 [debug] [MainThread]: Command end result
[0m04:23:50.719664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:23:50.728924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:23:50.739657 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m04:23:50.740026 [info ] [MainThread]: 
[0m04:23:50.740417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:23:50.740679 [info ] [MainThread]: 
[0m04:23:50.740990 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:23:50.747134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.361966, "process_in_blocks": "0", "process_kernel_time": 0.469614, "process_mem_max_rss": "163364864", "process_out_blocks": "0", "process_user_time": 1.919393}
[0m04:23:50.747732 [debug] [MainThread]: Command `dbt run` succeeded at 04:23:50.747628 after 4.36 seconds
[0m04:23:50.748242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88e10>]}
[0m04:23:50.748629 [debug] [MainThread]: Flushing usage events
[0m04:23:51.756479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:28:58.584708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c83750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c83610>]}


============================== 04:28:58.591169 | 13dcc214-6e9f-45e3-8717-660a1c2c4c63 ==============================
[0m04:28:58.591169 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:28:58.591530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:28:59.436460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9f5c0>]}
[0m04:28:59.464716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107762690>]}
[0m04:28:59.466296 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m04:28:59.543533 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m04:28:59.737784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:28:59.738052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:28:59.766717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c08650>]}
[0m04:28:59.819614 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:28:59.824977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:28:59.874212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107752a80>]}
[0m04:28:59.874529 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m04:28:59.874740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799dc50>]}
[0m04:28:59.876137 [info ] [MainThread]: 
[0m04:28:59.876340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:28:59.876493 [info ] [MainThread]: 
[0m04:28:59.876761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:28:59.879518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m04:29:00.095168 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m04:29:00.095417 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m04:29:00.095563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:29:00.603458 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.508 seconds
[0m04:29:00.610069 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m04:29:00.610738 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m04:29:00.702006 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.091 seconds
[0m04:29:00.710397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m04:29:00.729552 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m04:29:00.730052 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m04:29:00.842908 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.112 seconds
[0m04:29:00.848094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m04:29:00.853313 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m04:29:00.853802 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m04:29:00.966822 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m04:29:00.971388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m04:29:00.975488 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m04:29:00.976103 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m04:29:01.082177 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.106 seconds
[0m04:29:01.086648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d01ba00>]}
[0m04:29:01.092276 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m04:29:01.092971 [info ] [Thread-1 (]: 1 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m04:29:01.093459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now model.planetkart_analytics.stg_customers)
[0m04:29:01.093813 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m04:29:01.102093 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m04:29:01.117285 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m04:29:01.137606 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m04:29:01.140522 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m04:29:01.140810 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m04:29:01.341073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m04:29:01.375469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d73dd0>]}
[0m04:29:01.376213 [info ] [Thread-1 (]: 1 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.28s]
[0m04:29:01.376784 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m04:29:01.377155 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m04:29:01.377709 [info ] [Thread-1 (]: 2 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m04:29:01.378215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m04:29:01.378578 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m04:29:01.381420 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m04:29:01.383439 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m04:29:01.386088 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m04:29:01.396002 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m04:29:01.396450 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m04:29:01.558922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m04:29:01.561055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1599c0>]}
[0m04:29:01.561699 [info ] [Thread-1 (]: 2 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.18s]
[0m04:29:01.562240 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m04:29:01.562605 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m04:29:01.563193 [info ] [Thread-1 (]: 3 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders ... [RUN]
[0m04:29:01.563682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m04:29:01.564049 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m04:29:01.567049 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m04:29:01.569170 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m04:29:01.571818 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m04:29:01.642196 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m04:29:01.642738 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m04:29:01.845497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m04:29:01.849732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c1130>]}
[0m04:29:01.850932 [info ] [Thread-1 (]: 3 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.29s]
[0m04:29:01.852047 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m04:29:01.852935 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m04:29:01.853951 [info ] [Thread-1 (]: 4 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products . [RUN]
[0m04:29:01.854755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m04:29:01.855270 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m04:29:01.859660 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m04:29:01.870260 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m04:29:01.873881 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m04:29:01.876978 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m04:29:01.877483 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m04:29:02.037371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m04:29:02.043023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3459d0>]}
[0m04:29:02.044076 [info ] [Thread-1 (]: 4 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.19s]
[0m04:29:02.044855 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m04:29:02.045374 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m04:29:02.046139 [info ] [Thread-1 (]: 5 of 9 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions .. [RUN]
[0m04:29:02.046937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m04:29:02.047446 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m04:29:02.051743 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m04:29:02.055447 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m04:29:02.059481 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m04:29:02.069930 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m04:29:02.070419 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m04:29:02.286775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m04:29:02.291823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d076c80>]}
[0m04:29:02.292842 [info ] [Thread-1 (]: 5 of 9 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.24s]
[0m04:29:02.293604 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m04:29:02.294169 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m04:29:02.294880 [info ] [Thread-1 (]: 6 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m04:29:02.295600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m04:29:02.296098 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m04:29:02.315405 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m04:29:02.317554 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m04:29:02.339127 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m04:29:02.362049 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m04:29:02.362554 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 then 'Repeat_Engagement'
        else 'Single_Engagement'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m04:29:03.485957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.122 seconds
[0m04:29:03.491621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10c6b0>]}
[0m04:29:03.492709 [info ] [Thread-1 (]: 6 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.20s]
[0m04:29:03.493504 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m04:29:03.494056 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m04:29:03.494829 [info ] [Thread-1 (]: 7 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m04:29:03.495527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m04:29:03.496042 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m04:29:03.502215 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m04:29:03.518442 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m04:29:03.522104 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m04:29:03.526504 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m04:29:03.527123 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m04:29:04.486461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m04:29:04.491250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10f1d0>]}
[0m04:29:04.492246 [info ] [Thread-1 (]: 7 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 1.00s]
[0m04:29:04.492983 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m04:29:04.493476 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m04:29:04.494165 [info ] [Thread-1 (]: 8 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m04:29:04.494831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m04:29:04.495337 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m04:29:04.503147 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m04:29:04.514633 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m04:29:04.518315 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m04:29:04.523062 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m04:29:04.523703 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m04:29:05.414768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m04:29:05.422377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10f0b0>]}
[0m04:29:05.424323 [info ] [Thread-1 (]: 8 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 0.93s]
[0m04:29:05.425553 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m04:29:05.426290 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m04:29:05.427247 [info ] [Thread-1 (]: 9 of 9 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m04:29:05.428223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m04:29:05.428859 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m04:29:05.434222 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m04:29:05.437271 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m04:29:05.441844 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m04:29:05.455469 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m04:29:05.456132 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m04:29:06.164044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m04:29:06.169842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dcc214-6e9f-45e3-8717-660a1c2c4c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10da90>]}
[0m04:29:06.170884 [info ] [Thread-1 (]: 9 of 9 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.74s]
[0m04:29:06.171651 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m04:29:06.173302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:29:06.173811 [debug] [MainThread]: Connection 'model.planetkart_analytics.dim_regions' was left open.
[0m04:29:06.174247 [debug] [MainThread]: On model.planetkart_analytics.dim_regions: Close
[0m04:29:06.285616 [info ] [MainThread]: 
[0m04:29:06.286828 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 6.41 seconds (6.41s).
[0m04:29:06.289637 [debug] [MainThread]: Command end result
[0m04:29:06.408600 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:29:06.413721 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:29:06.420148 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m04:29:06.420475 [info ] [MainThread]: 
[0m04:29:06.420922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:29:06.421252 [info ] [MainThread]: 
[0m04:29:06.421544 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m04:29:06.425715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.906702, "process_in_blocks": "0", "process_kernel_time": 0.472553, "process_mem_max_rss": "156860416", "process_out_blocks": "0", "process_user_time": 1.946479}
[0m04:29:06.426195 [debug] [MainThread]: Command `dbt run` succeeded at 04:29:06.426105 after 7.91 seconds
[0m04:29:06.426529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078da390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1a7fb0>]}
[0m04:29:06.426836 [debug] [MainThread]: Flushing usage events
[0m04:29:07.647588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:29:23.376639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f07610>]}


============================== 04:29:23.382887 | 1cebfbca-9b4a-4d17-b501-fe7aafea87de ==============================
[0m04:29:23.382887 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:29:23.383263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:29:24.227100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cebfbca-9b4a-4d17-b501-fe7aafea87de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10883b5c0>]}
[0m04:29:24.255189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cebfbca-9b4a-4d17-b501-fe7aafea87de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e6690>]}
[0m04:29:24.257025 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m04:29:24.335714 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m04:29:24.540607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:29:24.540843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:29:24.568684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cebfbca-9b4a-4d17-b501-fe7aafea87de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba0ec50>]}
[0m04:29:24.619921 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:29:24.624947 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:29:24.675831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cebfbca-9b4a-4d17-b501-fe7aafea87de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90cc80>]}
[0m04:29:24.676145 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m04:29:24.676342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cebfbca-9b4a-4d17-b501-fe7aafea87de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5add0>]}
[0m04:29:24.677959 [info ] [MainThread]: 
[0m04:29:24.678161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:29:24.678309 [info ] [MainThread]: 
[0m04:29:24.678574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:29:24.681467 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics'
[0m04:29:24.898895 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m04:29:24.899144 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m04:29:24.899300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:29:25.394296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.495 seconds
[0m04:29:25.399173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m04:29:25.403882 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m04:29:25.404355 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m04:29:25.493624 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m04:29:25.497529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m04:29:25.501239 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m04:29:25.501703 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m04:29:25.653473 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.151 seconds
[0m04:29:25.655433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cebfbca-9b4a-4d17-b501-fe7aafea87de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb69f30>]}
[0m04:29:25.659273 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:25.659600 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase  [RUN]
[0m04:29:25.659885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13)
[0m04:29:25.660092 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:25.671292 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m04:29:25.672633 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:25.686613 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m04:29:25.704497 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m04:29:25.704834 [debug] [Thread-1 (]: On test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        revenue_segment as value_field,
        count(*) as n_records

    from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    group by revenue_segment

)

select *
from all_values
where value_field not in (
    'High_Value','Medium_Value','Low_Value','No_Purchase'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"} */
[0m04:29:26.099616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m04:29:26.116742 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase  [[32mPASS[0m in 0.46s]
[0m04:29:26.117708 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:26.118166 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:26.118673 [info ] [Thread-1 (]: 2 of 23 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m04:29:26.119249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13, now test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m04:29:26.119680 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:26.127736 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m04:29:26.129582 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:26.132726 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m04:29:26.141707 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m04:29:26.142149 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */
[0m04:29:26.357025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m04:29:26.363305 [info ] [Thread-1 (]: 2 of 23 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.24s]
[0m04:29:26.364233 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:26.364791 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:26.365372 [info ] [Thread-1 (]: 3 of 23 START test not_null_dim_customers_customer_sk .......................... [RUN]
[0m04:29:26.366029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863)
[0m04:29:26.366544 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:26.371918 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m04:29:26.373903 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:26.377074 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m04:29:26.390778 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m04:29:26.391366 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"} */
[0m04:29:26.544984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m04:29:26.548931 [info ] [Thread-1 (]: 3 of 23 PASS not_null_dim_customers_customer_sk ................................ [[32mPASS[0m in 0.18s]
[0m04:29:26.550097 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:26.550991 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:26.551939 [info ] [Thread-1 (]: 4 of 23 START test not_null_dim_products_product_id ............................ [RUN]
[0m04:29:26.552718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863, now test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m04:29:26.553208 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:26.557678 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m04:29:26.559568 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:26.563371 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m04:29:26.573813 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m04:29:26.574347 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"} */
[0m04:29:26.752548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m04:29:26.756973 [info ] [Thread-1 (]: 4 of 23 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.20s]
[0m04:29:26.758023 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:26.758655 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:26.759376 [info ] [Thread-1 (]: 5 of 23 START test not_null_dim_products_product_sk ............................ [RUN]
[0m04:29:26.760119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1, now test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9)
[0m04:29:26.760609 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:26.764976 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m04:29:26.766938 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:26.775130 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m04:29:26.787684 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m04:29:26.788088 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"} */
[0m04:29:26.948310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m04:29:26.952161 [info ] [Thread-1 (]: 5 of 23 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 0.19s]
[0m04:29:26.953398 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:26.954162 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:26.954863 [info ] [Thread-1 (]: 6 of 23 START test not_null_dim_regions_region_sk .............................. [RUN]
[0m04:29:26.955566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9, now test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db)
[0m04:29:26.956146 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:26.960201 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m04:29:26.961328 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:26.963532 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m04:29:26.996331 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m04:29:26.997281 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
where region_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"} */
[0m04:29:27.154230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m04:29:27.157637 [info ] [Thread-1 (]: 6 of 23 PASS not_null_dim_regions_region_sk .................................... [[32mPASS[0m in 0.20s]
[0m04:29:27.158576 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:27.159137 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:27.159653 [info ] [Thread-1 (]: 7 of 23 START test not_null_fact_orders_customer_sk ............................ [RUN]
[0m04:29:27.160187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db, now test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226)
[0m04:29:27.160471 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:27.162938 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m04:29:27.164354 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:27.165584 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m04:29:27.174072 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m04:29:27.174346 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where customer_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"} */
[0m04:29:27.338832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m04:29:27.342946 [info ] [Thread-1 (]: 7 of 23 PASS not_null_fact_orders_customer_sk .................................. [[32mPASS[0m in 0.18s]
[0m04:29:27.343796 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:27.344299 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:27.344829 [info ] [Thread-1 (]: 8 of 23 START test not_null_fact_orders_order_revenue .......................... [RUN]
[0m04:29:27.345751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226, now test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25)
[0m04:29:27.346694 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:27.352932 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m04:29:27.355135 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:27.358087 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m04:29:27.367458 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m04:29:27.368118 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_revenue
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where order_revenue is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"} */
[0m04:29:27.503148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m04:29:27.508759 [info ] [Thread-1 (]: 8 of 23 PASS not_null_fact_orders_order_revenue ................................ [[32mPASS[0m in 0.16s]
[0m04:29:27.509790 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:27.510325 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:27.510919 [info ] [Thread-1 (]: 9 of 23 START test not_null_fact_orders_order_sk ............................... [RUN]
[0m04:29:27.511570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25, now test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6)
[0m04:29:27.512060 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:27.517973 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m04:29:27.520610 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:27.524227 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m04:29:27.535276 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m04:29:27.535784 [debug] [Thread-1 (]: On test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_sk
from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where order_sk is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"} */
[0m04:29:27.715696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m04:29:27.721712 [info ] [Thread-1 (]: 9 of 23 PASS not_null_fact_orders_order_sk ..................................... [[32mPASS[0m in 0.21s]
[0m04:29:27.722781 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:27.723408 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:27.723972 [info ] [Thread-1 (]: 10 of 23 START test source_not_null_planetkart_raw_customers_customer_id ....... [RUN]
[0m04:29:27.724563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6, now test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe)
[0m04:29:27.725048 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:27.730893 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m04:29:27.732772 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:27.735434 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m04:29:27.746606 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m04:29:27.747131 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from planetkart.planetkart_raw.customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"} */
[0m04:29:27.831085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m04:29:27.835574 [info ] [Thread-1 (]: 10 of 23 PASS source_not_null_planetkart_raw_customers_customer_id ............. [[32mPASS[0m in 0.11s]
[0m04:29:27.836813 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:27.837488 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:27.838130 [info ] [Thread-1 (]: 11 of 23 START test source_not_null_planetkart_raw_orders_order_id ............. [RUN]
[0m04:29:27.838759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe, now test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4)
[0m04:29:27.839293 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:27.844988 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m04:29:27.847991 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:27.850884 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m04:29:27.864382 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m04:29:27.864989 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from planetkart.planetkart_raw.orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"} */
[0m04:29:27.959978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m04:29:27.964741 [info ] [Thread-1 (]: 11 of 23 PASS source_not_null_planetkart_raw_orders_order_id ................... [[32mPASS[0m in 0.13s]
[0m04:29:27.965891 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:27.966697 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:27.967443 [info ] [Thread-1 (]: 12 of 23 START test source_not_null_planetkart_raw_products_product_id ......... [RUN]
[0m04:29:27.968142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4, now test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090)
[0m04:29:27.968645 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:27.974705 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m04:29:27.976929 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:27.979821 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m04:29:27.991990 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m04:29:27.992591 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from planetkart.planetkart_raw.products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"} */
[0m04:29:28.300090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m04:29:28.307137 [info ] [Thread-1 (]: 12 of 23 PASS source_not_null_planetkart_raw_products_product_id ............... [[32mPASS[0m in 0.34s]
[0m04:29:28.308477 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:28.309206 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:28.309888 [info ] [Thread-1 (]: 13 of 23 START test source_not_null_planetkart_raw_regions_region_id ........... [RUN]
[0m04:29:28.310505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090, now test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e)
[0m04:29:28.311041 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:28.317660 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m04:29:28.320105 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:28.323342 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m04:29:28.337899 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m04:29:28.338516 [debug] [Thread-1 (]: On test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from planetkart.planetkart_raw.regions
where region_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"} */
[0m04:29:28.418420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:29:28.422910 [info ] [Thread-1 (]: 13 of 23 PASS source_not_null_planetkart_raw_regions_region_id ................. [[32mPASS[0m in 0.11s]
[0m04:29:28.424029 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:28.424715 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:28.425318 [info ] [Thread-1 (]: 14 of 23 START test source_unique_planetkart_raw_customers_customer_id ......... [RUN]
[0m04:29:28.426004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e, now test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d)
[0m04:29:28.426531 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:28.435959 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m04:29:28.438052 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:28.440790 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m04:29:28.455091 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m04:29:28.455639 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"} */
[0m04:29:28.548382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m04:29:28.553753 [info ] [Thread-1 (]: 14 of 23 PASS source_unique_planetkart_raw_customers_customer_id ............... [[32mPASS[0m in 0.13s]
[0m04:29:28.555061 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:28.555680 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:28.556294 [info ] [Thread-1 (]: 15 of 23 START test source_unique_planetkart_raw_orders_order_id ............... [RUN]
[0m04:29:28.557006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d, now test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8)
[0m04:29:28.557504 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:28.563769 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m04:29:28.566144 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:28.568822 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m04:29:28.579142 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m04:29:28.579665 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"} */
[0m04:29:28.666101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m04:29:28.673800 [info ] [Thread-1 (]: 15 of 23 PASS source_unique_planetkart_raw_orders_order_id ..................... [[32mPASS[0m in 0.12s]
[0m04:29:28.675454 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:28.676256 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:28.677019 [info ] [Thread-1 (]: 16 of 23 START test source_unique_planetkart_raw_products_product_id ........... [RUN]
[0m04:29:28.677904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8, now test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb)
[0m04:29:28.678490 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:28.684541 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m04:29:28.686724 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:28.689896 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m04:29:28.705467 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m04:29:28.706052 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"} */
[0m04:29:28.787801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m04:29:28.792850 [info ] [Thread-1 (]: 16 of 23 PASS source_unique_planetkart_raw_products_product_id ................. [[32mPASS[0m in 0.11s]
[0m04:29:28.793851 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:28.794417 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:28.795005 [info ] [Thread-1 (]: 17 of 23 START test source_unique_planetkart_raw_regions_region_id ............. [RUN]
[0m04:29:28.795629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb, now test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f)
[0m04:29:28.796112 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:28.802216 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m04:29:28.804443 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:28.807165 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m04:29:28.819544 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m04:29:28.820019 [debug] [Thread-1 (]: On test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region_id as unique_field,
    count(*) as n_records

from planetkart.planetkart_raw.regions
where region_id is not null
group by region_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"} */
[0m04:29:28.896022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:29:28.907112 [info ] [Thread-1 (]: 17 of 23 PASS source_unique_planetkart_raw_regions_region_id ................... [[32mPASS[0m in 0.11s]
[0m04:29:28.908143 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:28.908702 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:28.909280 [info ] [Thread-1 (]: 18 of 23 START test unique_dim_customers_customer_id ........................... [RUN]
[0m04:29:28.909917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f, now test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m04:29:28.910406 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:28.915445 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m04:29:28.918061 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:28.920692 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m04:29:28.931145 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m04:29:28.931638 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */
[0m04:29:29.037028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m04:29:29.041676 [info ] [Thread-1 (]: 18 of 23 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.13s]
[0m04:29:29.042656 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:29.043177 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:29.043748 [info ] [Thread-1 (]: 19 of 23 START test unique_dim_customers_customer_sk ........................... [RUN]
[0m04:29:29.044357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62)
[0m04:29:29.044827 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:29.051216 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m04:29:29.053630 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:29.056282 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m04:29:29.067631 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m04:29:29.068176 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
where customer_sk is not null
group by customer_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"} */
[0m04:29:29.188839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m04:29:29.194383 [info ] [Thread-1 (]: 19 of 23 PASS unique_dim_customers_customer_sk ................................. [[32mPASS[0m in 0.15s]
[0m04:29:29.195449 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:29.195968 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:29.196541 [info ] [Thread-1 (]: 20 of 23 START test unique_dim_products_product_id ............................. [RUN]
[0m04:29:29.197245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62, now test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m04:29:29.197773 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:29.204398 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m04:29:29.206968 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:29.209618 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m04:29:29.222493 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m04:29:29.223210 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"} */
[0m04:29:29.329358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m04:29:29.335064 [info ] [Thread-1 (]: 20 of 23 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.14s]
[0m04:29:29.336343 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:29.336993 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:29.337646 [info ] [Thread-1 (]: 21 of 23 START test unique_dim_products_product_sk ............................. [RUN]
[0m04:29:29.338261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985, now test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b)
[0m04:29:29.338747 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:29.345271 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m04:29:29.347574 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:29.350507 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m04:29:29.362564 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m04:29:29.363165 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
where product_sk is not null
group by product_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"} */
[0m04:29:29.510674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m04:29:29.515425 [info ] [Thread-1 (]: 21 of 23 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 0.18s]
[0m04:29:29.516361 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:29.516897 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:29.517455 [info ] [Thread-1 (]: 22 of 23 START test unique_dim_regions_region_sk ............................... [RUN]
[0m04:29:29.518048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b, now test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d)
[0m04:29:29.518543 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:29.524786 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m04:29:29.527134 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:29.529732 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m04:29:29.544167 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m04:29:29.544685 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
where region_sk is not null
group by region_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"} */
[0m04:29:29.733456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m04:29:29.738451 [info ] [Thread-1 (]: 22 of 23 PASS unique_dim_regions_region_sk ..................................... [[32mPASS[0m in 0.22s]
[0m04:29:29.739957 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:29.740736 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:29.741328 [info ] [Thread-1 (]: 23 of 23 START test unique_fact_orders_order_sk ................................ [RUN]
[0m04:29:29.741982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d, now test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c)
[0m04:29:29.742473 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:29.749244 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m04:29:29.751644 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:29.754147 [debug] [Thread-1 (]: Writing runtime sql for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m04:29:29.769874 [debug] [Thread-1 (]: Using snowflake connection "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m04:29:29.770399 [debug] [Thread-1 (]: On test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_sk as unique_field,
    count(*) as n_records

from PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
where order_sk is not null
group by order_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"} */
[0m04:29:29.940461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m04:29:29.943241 [info ] [Thread-1 (]: 23 of 23 PASS unique_fact_orders_order_sk ...................................... [[32mPASS[0m in 0.20s]
[0m04:29:29.944012 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:29.945513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:29:29.945900 [debug] [MainThread]: Connection 'test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c' was left open.
[0m04:29:29.946269 [debug] [MainThread]: On test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c: Close
[0m04:29:30.065421 [info ] [MainThread]: 
[0m04:29:30.066143 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m04:29:30.069774 [debug] [MainThread]: Command end result
[0m04:29:30.143657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:29:30.153222 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:29:30.164432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m04:29:30.164720 [info ] [MainThread]: 
[0m04:29:30.164939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:29:30.165088 [info ] [MainThread]: 
[0m04:29:30.165244 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m04:29:30.168506 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.859235, "process_in_blocks": "0", "process_kernel_time": 0.495686, "process_mem_max_rss": "156319744", "process_out_blocks": "0", "process_user_time": 2.187872}
[0m04:29:30.168775 [debug] [MainThread]: Command `dbt test` succeeded at 04:29:30.168724 after 6.86 seconds
[0m04:29:30.168971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f6c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f8100>]}
[0m04:29:30.169155 [debug] [MainThread]: Flushing usage events
[0m04:29:31.114841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:29:40.054156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d03750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d03610>]}


============================== 04:29:40.059832 | f23d87fc-c781-4369-a9c6-26fd3489ec97 ==============================
[0m04:29:40.059832 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:29:40.060198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:29:40.831358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f23d87fc-c781-4369-a9c6-26fd3489ec97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c835c0>]}
[0m04:29:40.859546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f23d87fc-c781-4369-a9c6-26fd3489ec97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e6690>]}
[0m04:29:40.861692 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m04:29:40.937388 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m04:29:41.138470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:29:41.138716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:29:41.167579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f23d87fc-c781-4369-a9c6-26fd3489ec97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88ac50>]}
[0m04:29:41.218372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:29:41.222210 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:29:41.262656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f23d87fc-c781-4369-a9c6-26fd3489ec97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3d72f0>]}
[0m04:29:41.262953 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m04:29:41.263151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f23d87fc-c781-4369-a9c6-26fd3489ec97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba82dd0>]}
[0m04:29:41.264407 [info ] [MainThread]: 
[0m04:29:41.264616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:29:41.264765 [info ] [MainThread]: 
[0m04:29:41.265022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:29:41.265508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m04:29:41.482838 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m04:29:41.483087 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m04:29:41.483232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:29:41.986430 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.503 seconds
[0m04:29:41.999113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m04:29:42.016062 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m04:29:42.016503 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m04:29:42.104592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.088 seconds
[0m04:29:42.108842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m04:29:42.113125 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m04:29:42.113580 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m04:29:42.223883 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m04:29:42.228411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m04:29:42.238905 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m04:29:42.241149 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m04:29:42.333241 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.091 seconds
[0m04:29:42.340315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f23d87fc-c781-4369-a9c6-26fd3489ec97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acde1a0>]}
[0m04:29:42.345667 [debug] [Thread-1 (]: Began running node snapshot.planetkart_analytics.snap_customers
[0m04:29:42.346336 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_customers ................................. [RUN]
[0m04:29:42.346832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now snapshot.planetkart_analytics.snap_customers)
[0m04:29:42.347223 [debug] [Thread-1 (]: Began compiling node snapshot.planetkart_analytics.snap_customers
[0m04:29:42.356458 [debug] [Thread-1 (]: Began executing node snapshot.planetkart_analytics.snap_customers
[0m04:29:42.397839 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:42.398158 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: describe table "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:42.482767 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.084 seconds
[0m04:29:42.521330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:42.521686 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: create or replace temporary table "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



select 
    customer_id,
    first_name,
    last_name,
    email,
    region_id,
    signup_date
from planetkart.planetkart_raw.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            signup_date as dbt_updated_at,
            signup_date as dbt_valid_from,
            
  
  coalesce(nullif(signup_date, signup_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(signup_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            signup_date as dbt_updated_at,
            signup_date as dbt_valid_from,
            signup_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.signup_date)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.signup_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */;
[0m04:29:43.115456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m04:29:43.122635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:43.123244 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: describe table "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:43.204572 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.080 seconds
[0m04:29:43.213632 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:43.214175 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: describe table "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:43.286512 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.072 seconds
[0m04:29:43.294028 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:43.294964 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: describe table "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:43.370760 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.075 seconds
[0m04:29:43.381482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:43.382060 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: describe table "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:43.456191 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.073 seconds
[0m04:29:43.469042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:43.469615 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: describe table "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:43.561565 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.091 seconds
[0m04:29:43.592762 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:43.593354 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: select * from (
        
    
    with snapshot_query as (

        



select 
    customer_id,
    first_name,
    last_name,
    email,
    region_id,
    signup_date
from planetkart.planetkart_raw.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            signup_date as dbt_updated_at,
            signup_date as dbt_valid_from,
            
  
  coalesce(nullif(signup_date, signup_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(signup_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            signup_date as dbt_updated_at,
            signup_date as dbt_valid_from,
            signup_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.signup_date)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.signup_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:44.077923 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.484 seconds
[0m04:29:44.090791 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:44.091516 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:44.162932 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m04:29:44.164412 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TEXT). Please update snapshot config 'updated_at'.
[0m04:29:44.165961 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.planetkart_analytics.snap_customers"
[0m04:29:44.171966 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:44.172764 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:44.267998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m04:29:44.269495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:44.270418 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: merge into "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS" as DBT_INTERNAL_DEST
    using "PLANETKART"."SNAPSHOTS"."SNAP_CUSTOMERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "EMAIL", "REGION_ID", "SIGNUP_DATE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "EMAIL", "REGION_ID", "SIGNUP_DATE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */;
[0m04:29:44.647517 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.376 seconds
[0m04:29:44.649099 [debug] [Thread-1 (]: Using snowflake connection "snapshot.planetkart_analytics.snap_customers"
[0m04:29:44.650079 [debug] [Thread-1 (]: On snapshot.planetkart_analytics.snap_customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "snapshot.planetkart_analytics.snap_customers"} */
[0m04:29:44.846856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m04:29:44.882334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f23d87fc-c781-4369-a9c6-26fd3489ec97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfa4410>]}
[0m04:29:44.883248 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_customers ................................. [[32mSUCCESS 0[0m in 2.53s]
[0m04:29:44.883828 [debug] [Thread-1 (]: Finished running node snapshot.planetkart_analytics.snap_customers
[0m04:29:44.885037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:29:44.885362 [debug] [MainThread]: Connection 'snapshot.planetkart_analytics.snap_customers' was left open.
[0m04:29:44.885647 [debug] [MainThread]: On snapshot.planetkart_analytics.snap_customers: Close
[0m04:29:44.999110 [info ] [MainThread]: 
[0m04:29:44.999905 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m04:29:45.000817 [debug] [MainThread]: Command end result
[0m04:29:45.128157 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:29:45.136202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:29:45.143685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m04:29:45.144023 [info ] [MainThread]: 
[0m04:29:45.144406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:29:45.144667 [info ] [MainThread]: 
[0m04:29:45.144958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:29:45.151149 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.1619744, "process_in_blocks": "0", "process_kernel_time": 0.470071, "process_mem_max_rss": "158695424", "process_out_blocks": "0", "process_user_time": 2.034108}
[0m04:29:45.151749 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:29:45.151619 after 5.16 seconds
[0m04:29:45.152148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd5af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc83250>]}
[0m04:29:45.152489 [debug] [MainThread]: Flushing usage events
[0m04:29:46.167593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:29:53.361156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e07610>]}


============================== 04:29:53.367281 | c6b38be3-e849-459a-bde7-7a61adeb18f6 ==============================
[0m04:29:53.367281 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:29:53.367659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:29:54.201403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6b38be3-e849-459a-bde7-7a61adeb18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075235c0>]}
[0m04:29:54.229428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6b38be3-e849-459a-bde7-7a61adeb18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111be2690>]}
[0m04:29:54.231504 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m04:29:54.307725 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m04:29:54.513353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:29:54.513623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:29:54.542019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6b38be3-e849-459a-bde7-7a61adeb18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112192c50>]}
[0m04:29:54.596979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6b38be3-e849-459a-bde7-7a61adeb18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e809b0>]}
[0m04:29:54.597342 [info ] [MainThread]: Found 9 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m04:29:54.597565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b38be3-e849-459a-bde7-7a61adeb18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f25390>]}
[0m04:29:54.599474 [info ] [MainThread]: 
[0m04:29:54.599716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:29:54.599880 [info ] [MainThread]: 
[0m04:29:54.600171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:29:54.603357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics'
[0m04:29:54.815222 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m04:29:54.815468 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m04:29:54.815635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:29:55.263925 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.448 seconds
[0m04:29:55.268967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m04:29:55.273620 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m04:29:55.274135 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m04:29:55.378494 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.104 seconds
[0m04:29:55.382812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m04:29:55.387281 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m04:29:55.387747 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m04:29:55.474141 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m04:29:55.479209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b38be3-e849-459a-bde7-7a61adeb18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f0e680>]}
[0m04:29:55.485351 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m04:29:55.485954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.stg_customers)
[0m04:29:55.486463 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m04:29:55.502317 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m04:29:55.505295 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m04:29:55.506091 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m04:29:55.506510 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m04:29:55.507028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m04:29:55.507571 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m04:29:55.510580 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m04:29:55.529441 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m04:29:55.530131 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m04:29:55.530534 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m04:29:55.530993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m04:29:55.531439 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m04:29:55.535180 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m04:29:55.552259 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m04:29:55.552958 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m04:29:55.553372 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m04:29:55.553807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m04:29:55.554238 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m04:29:55.557366 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m04:29:55.559861 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m04:29:55.560473 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m04:29:55.560863 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m04:29:55.561292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m04:29:55.561715 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m04:29:55.564819 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m04:29:55.579312 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m04:29:55.579996 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m04:29:55.580413 [debug] [Thread-1 (]: Began running node snapshot.planetkart_analytics.snap_customers
[0m04:29:55.580824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now snapshot.planetkart_analytics.snap_customers)
[0m04:29:55.581214 [debug] [Thread-1 (]: Began compiling node snapshot.planetkart_analytics.snap_customers
[0m04:29:55.585283 [debug] [Thread-1 (]: Began executing node snapshot.planetkart_analytics.snap_customers
[0m04:29:55.585950 [debug] [Thread-1 (]: Finished running node snapshot.planetkart_analytics.snap_customers
[0m04:29:55.586359 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:55.586774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.planetkart_analytics.snap_customers, now test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe)
[0m04:29:55.587169 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:55.599389 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe"
[0m04:29:55.609102 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:55.609804 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe
[0m04:29:55.610176 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:55.610574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_customers_customer_id.86a9670dfe, now test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4)
[0m04:29:55.610951 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:55.614833 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4"
[0m04:29:55.626978 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:55.627586 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4
[0m04:29:55.627904 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:55.628244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_orders_order_id.2dcacc5fa4, now test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090)
[0m04:29:55.628524 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:55.631821 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090"
[0m04:29:55.638423 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:55.639043 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090
[0m04:29:55.639362 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:55.639673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_products_product_id.e016ccb090, now test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e)
[0m04:29:55.639927 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:55.643231 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e"
[0m04:29:55.652568 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:55.653028 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e
[0m04:29:55.653276 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:55.653565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_not_null_planetkart_raw_regions_region_id.d4a95dc75e, now test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d)
[0m04:29:55.653841 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:55.657977 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d"
[0m04:29:55.667872 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:55.668332 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d
[0m04:29:55.668546 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:55.668776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_customers_customer_id.e7edef797d, now test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8)
[0m04:29:55.668977 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:55.671464 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8"
[0m04:29:55.679127 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:55.679468 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8
[0m04:29:55.679673 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:55.679900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_orders_order_id.a04601b3f8, now test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb)
[0m04:29:55.680120 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:55.682128 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb"
[0m04:29:55.692579 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:55.693018 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb
[0m04:29:55.693234 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:55.693444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_products_product_id.689bb398bb, now test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f)
[0m04:29:55.693693 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:55.696457 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f"
[0m04:29:55.703991 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:55.704420 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f
[0m04:29:55.704643 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m04:29:55.704854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.source_unique_planetkart_raw_regions_region_id.1ac75deb0f, now model.planetkart_analytics.dim_customers)
[0m04:29:55.705095 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m04:29:55.714033 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m04:29:55.725044 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m04:29:55.725448 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m04:29:55.725651 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m04:29:55.725904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m04:29:55.726177 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m04:29:55.729112 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m04:29:55.730898 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m04:29:55.731281 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m04:29:55.731487 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m04:29:55.731713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m04:29:55.731939 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m04:29:55.734995 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m04:29:55.737129 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m04:29:55.737508 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m04:29:55.737713 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m04:29:55.737941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m04:29:55.738161 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m04:29:55.740458 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m04:29:55.751177 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m04:29:55.751627 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m04:29:55.751853 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:55.752107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13)
[0m04:29:55.752351 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:55.758218 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13"
[0m04:29:55.767356 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:55.767769 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13
[0m04:29:55.767968 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:55.768208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.accepted_values_dim_customers_revenue_segment__High_Value__Medium_Value__Low_Value__No_Purchase.8dc2ceed13, now test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m04:29:55.768426 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:55.770842 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m04:29:55.779186 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:55.779551 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m04:29:55.779729 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:55.779896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863)
[0m04:29:55.780052 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:55.782025 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863"
[0m04:29:55.790102 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:55.790476 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863
[0m04:29:55.790646 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:55.790818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_customers_customer_sk.8ae5836863, now test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m04:29:55.790976 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:55.793164 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m04:29:55.800926 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:55.801302 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m04:29:55.801478 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:55.801648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62)
[0m04:29:55.801806 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:55.803702 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62"
[0m04:29:55.812543 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:55.812925 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62
[0m04:29:55.813109 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:55.813286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_customers_customer_sk.22a014df62, now test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m04:29:55.813444 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:55.815597 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m04:29:55.824393 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:55.824759 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1
[0m04:29:55.824936 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:55.825124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_id.c8aba288d1, now test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9)
[0m04:29:55.825281 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:55.827194 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9"
[0m04:29:55.835967 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:55.836333 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9
[0m04:29:55.836506 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:55.836682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_products_product_sk.2a2df3e1b9, now test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m04:29:55.836875 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:55.840322 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m04:29:55.851067 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:55.851416 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985
[0m04:29:55.851580 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:55.851738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_id.ef7b2a9985, now test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b)
[0m04:29:55.851887 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:55.853734 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b"
[0m04:29:55.863968 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:55.864331 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b
[0m04:29:55.864504 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:55.864696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_dim_products_product_sk.8f20ac7c5b, now test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226)
[0m04:29:55.864850 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:55.866733 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226"
[0m04:29:55.876478 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:55.876938 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226
[0m04:29:55.877134 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:55.877319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_customer_sk.552ba19226, now test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25)
[0m04:29:55.877485 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:55.879797 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25"
[0m04:29:55.889072 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:55.889444 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25
[0m04:29:55.889614 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:55.889775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_revenue.7129d31d25, now test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6)
[0m04:29:55.889922 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:55.891901 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6"
[0m04:29:55.901187 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:55.901565 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6
[0m04:29:55.901742 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:55.901909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_fact_orders_order_sk.055fc92cc6, now test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c)
[0m04:29:55.902063 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:55.904227 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c"
[0m04:29:55.912866 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:55.913256 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c
[0m04:29:55.913430 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:55.913601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.unique_fact_orders_order_sk.718a9dd21c, now test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db)
[0m04:29:55.913756 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:55.915650 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db"
[0m04:29:55.923768 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:55.924156 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db
[0m04:29:55.924336 [debug] [Thread-1 (]: Began running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:55.924505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.planetkart_analytics.not_null_dim_regions_region_sk.aa799207db, now test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d)
[0m04:29:55.924660 [debug] [Thread-1 (]: Began compiling node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:55.926836 [debug] [Thread-1 (]: Writing injected SQL for node "test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d"
[0m04:29:55.936602 [debug] [Thread-1 (]: Began executing node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:55.936976 [debug] [Thread-1 (]: Finished running node test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d
[0m04:29:55.937516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:29:55.937670 [debug] [MainThread]: Connection 'test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d' was left open.
[0m04:29:55.937807 [debug] [MainThread]: On test.planetkart_analytics.unique_dim_regions_region_sk.0aa657583d: Close
[0m04:29:56.053640 [debug] [MainThread]: Command end result
[0m04:29:56.136029 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:29:56.139989 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:29:56.151967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m04:29:56.157206 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m04:29:56.157381 [info ] [MainThread]: Building catalog
[0m04:29:56.163486 [debug] [ThreadPool]: Acquiring new snowflake connection 'PLANETKART.information_schema'
[0m04:29:56.173322 [debug] [ThreadPool]: Using snowflake connection "PLANETKART.information_schema"
[0m04:29:56.173854 [debug] [ThreadPool]: On PLANETKART.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PLANETKART.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_regions' and upper("table_name") = upper('dim_regions')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_regions' and upper("table_name") = upper('stg_regions')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PLANETKART.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'snap_customers' and upper("table_name") = upper('snap_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_order_items' and upper("table_name") = upper('stg_order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_regions' and upper("table_name") = upper('dim_regions')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_analytics' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PLANETKART_ANALYTICS_planetkart_stage' and upper("table_schema") = upper('PLANETKART_ANALYTICS_planetkart_stage')

                    and 
    "table_name" ilike 'stg_regions' and upper("table_name") = upper('stg_regions')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "PLANETKART.information_schema"} */
[0m04:29:56.174262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:00.244563 [debug] [ThreadPool]: SQL status: SUCCESS 99 in 4.070 seconds
[0m04:30:00.269496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly PLANETKART.information_schema, now planetkart.information_schema)
[0m04:30:00.275743 [debug] [ThreadPool]: Using snowflake connection "planetkart.information_schema"
[0m04:30:00.276441 [debug] [ThreadPool]: On planetkart.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from planetkart.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'regions' and upper("table_name") = upper('regions')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'order_items' and upper("table_name") = upper('order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from planetkart.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'regions' and upper("table_name") = upper('regions')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'order_items' and upper("table_name") = upper('order_items')

                )
             or 
                (
                    
    "table_schema" ilike 'planetkart_raw' and upper("table_schema") = upper('planetkart_raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "planetkart.information_schema"} */
[0m04:30:03.478946 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 3.202 seconds
[0m04:30:03.535088 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/catalog.json
[0m04:30:03.637919 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m04:30:03.645058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m04:30:03.645362 [info ] [MainThread]: Catalog written to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/catalog.json
[0m04:30:03.649977 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.347761, "process_in_blocks": "0", "process_kernel_time": 0.429858, "process_mem_max_rss": "160038912", "process_out_blocks": "0", "process_user_time": 1.927018}
[0m04:30:03.650468 [debug] [MainThread]: Command `dbt docs generate` succeeded at 04:30:03.650381 after 10.35 seconds
[0m04:30:03.650741 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m04:30:03.650961 [debug] [MainThread]: Connection 'planetkart.information_schema' was left open.
[0m04:30:03.651178 [debug] [MainThread]: On planetkart.information_schema: Close
[0m04:30:03.771787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e644d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f7ac0>]}
[0m04:30:03.772660 [debug] [MainThread]: Flushing usage events
[0m04:30:04.765776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:30:09.325009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109603750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109603610>]}


============================== 04:30:09.331425 | bc4e9dde-56fb-4998-8859-35c83faf3637 ==============================
[0m04:30:09.331425 [info ] [MainThread]: Running with dbt=1.10.4
[0m04:30:09.331814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:30:10.174722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc4e9dde-56fb-4998-8859-35c83faf3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867f5c0>]}
[0m04:30:10.202843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc4e9dde-56fb-4998-8859-35c83faf3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e27a0>]}
[0m04:30:40.499388 [error] [MainThread]: Encountered an error:

[0m04:30:40.512653 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m04:30:40.518736 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 31.260895, "process_in_blocks": "0", "process_kernel_time": 0.374478, "process_mem_max_rss": "133480448", "process_out_blocks": "0", "process_user_time": 1.409097}
[0m04:30:40.520518 [debug] [MainThread]: Command `dbt docs serve` failed at 04:30:40.520262 after 31.26 seconds
[0m04:30:40.521225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a88e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a88e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a882300>]}
[0m04:30:40.521727 [debug] [MainThread]: Flushing usage events
[0m04:30:41.516982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:35:32.815698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b307750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b307610>]}


============================== 07:35:32.828042 | b026ad71-ff64-4540-837e-d37fae71b759 ==============================
[0m07:35:32.828042 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:35:32.828676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select analysis', 'send_anonymous_usage_stats': 'True'}
[0m07:35:35.231910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b026ad71-ff64-4540-837e-d37fae71b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2235c0>]}
[0m07:35:35.260652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b026ad71-ff64-4540-837e-d37fae71b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e6690>]}
[0m07:35:35.264719 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:35:35.476020 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:35:35.553328 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:35:35.553614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b026ad71-ff64-4540-837e-d37fae71b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d893e50>]}
[0m07:35:37.616310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.planetkart_analytics.analysis
[0m07:35:37.621136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b026ad71-ff64-4540-837e-d37fae71b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df38500>]}
[0m07:35:37.760820 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:35:37.767951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:35:37.854825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b026ad71-ff64-4540-837e-d37fae71b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db77a10>]}
[0m07:35:37.855328 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:35:37.855625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b026ad71-ff64-4540-837e-d37fae71b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9fdf30>]}
[0m07:35:37.856315 [warn ] [MainThread]: The selection criterion 'analysis' does not match any enabled nodes
[0m07:35:37.857438 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:35:37.857895 [debug] [MainThread]: Command end result
[0m07:35:37.882742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:35:37.886614 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:35:37.902228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:35:37.946753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2930183, "process_in_blocks": "0", "process_kernel_time": 0.942745, "process_mem_max_rss": "153911296", "process_out_blocks": "0", "process_user_time": 3.492106}
[0m07:35:37.947220 [debug] [MainThread]: Command `dbt run` succeeded at 07:35:37.947146 after 5.29 seconds
[0m07:35:37.947523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbe3d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbe3c20>]}
[0m07:35:37.947788 [debug] [MainThread]: Flushing usage events
[0m07:35:39.063102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:36:26.835310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a207750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a207610>]}


============================== 07:36:26.841728 | 986cb88a-60e4-4b7a-847b-01d72f294eb2 ==============================
[0m07:36:26.841728 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:36:26.842110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select customer_insights', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:36:27.737804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '986cb88a-60e4-4b7a-847b-01d72f294eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068235c0>]}
[0m07:36:27.765557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '986cb88a-60e4-4b7a-847b-01d72f294eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0e6690>]}
[0m07:36:27.767460 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:36:27.848962 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:36:28.046102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:36:28.046343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:36:28.051170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.planetkart_analytics.analysis
[0m07:36:28.077200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '986cb88a-60e4-4b7a-847b-01d72f294eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b490650>]}
[0m07:36:28.210401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:36:28.217543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:36:28.271768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '986cb88a-60e4-4b7a-847b-01d72f294eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0d6a80>]}
[0m07:36:28.272167 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:36:28.272419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986cb88a-60e4-4b7a-847b-01d72f294eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b22a0b0>]}
[0m07:36:28.273752 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:36:28.275151 [debug] [MainThread]: Command end result
[0m07:36:28.297869 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:36:28.303873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:36:28.308256 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:36:28.312697 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5463387, "process_in_blocks": "0", "process_kernel_time": 0.397464, "process_mem_max_rss": "140607488", "process_out_blocks": "0", "process_user_time": 1.466007}
[0m07:36:28.313089 [debug] [MainThread]: Command `dbt run` succeeded at 07:36:28.313029 after 1.55 seconds
[0m07:36:28.313327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b75b930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7453d0>]}
[0m07:36:28.313527 [debug] [MainThread]: Flushing usage events
[0m07:36:29.368670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:09.153113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff7610>]}


============================== 07:39:09.158647 | 2a33c01c-627c-4a87-bbc5-a86f281213ad ==============================
[0m07:39:09.158647 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:39:09.159025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select customer_insights', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:39:10.084530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083175c0>]}
[0m07:39:10.112448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee6690>]}
[0m07:39:10.114279 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:39:10.194578 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:39:10.260064 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:39:10.260380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c997e50>]}
[0m07:39:11.164173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d140500>]}
[0m07:39:11.298491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:39:11.305640 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:39:11.365343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc727b0>]}
[0m07:39:11.365813 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:39:11.366236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3b5a50>]}
[0m07:39:11.368177 [info ] [MainThread]: 
[0m07:39:11.368680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:11.368927 [info ] [MainThread]: 
[0m07:39:11.369293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:39:11.369919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m07:39:14.429154 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:39:14.429837 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:39:14.430267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:15.389622 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.959 seconds
[0m07:39:15.393157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now create_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m07:39:15.394161 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "PLANETKART_ANALYTICS_analytics"
"
[0m07:39:15.400731 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m07:39:15.401323 [debug] [ThreadPool]: On create_PLANETKART_PLANETKART_ANALYTICS_analytics: create schema if not exists PLANETKART.PLANETKART_ANALYTICS_analytics
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_PLANETKART_ANALYTICS_analytics"} */
[0m07:39:15.527163 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m07:39:15.536937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_PLANETKART_ANALYTICS_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m07:39:15.552435 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m07:39:15.552943 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m07:39:15.684840 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.131 seconds
[0m07:39:15.688845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m07:39:15.693878 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m07:39:15.694373 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m07:39:15.857079 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.162 seconds
[0m07:39:15.860910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m07:39:15.865481 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m07:39:15.866144 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m07:39:16.015299 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.149 seconds
[0m07:39:16.018672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m07:39:16.023742 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m07:39:16.024328 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m07:39:16.121099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m07:39:16.125797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1e99d0>]}
[0m07:39:16.138706 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.customer_insights
[0m07:39:16.139701 [info ] [Thread-1 (]: 1 of 1 START sql view model PLANETKART_ANALYTICS_analytics.customer_insights ... [RUN]
[0m07:39:16.140346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.customer_insights)
[0m07:39:16.140821 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.customer_insights
[0m07:39:16.151918 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.customer_insights"
[0m07:39:16.155407 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.customer_insights
[0m07:39:16.187090 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.customer_insights"
[0m07:39:16.190428 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.customer_insights"
[0m07:39:16.190794 [debug] [Thread-1 (]: On model.planetkart_analytics.customer_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_analytics.customer_insights
  
  
  
  
  as (
    

-- Customer Intelligence Dashboard
-- Shows key customer segments and behavioral patterns

SELECT 
    -- Customer segmentation summary
    revenue_segment,
    lifecycle_stage,
    COUNT(*) as customer_count,
    ROUND(AVG(total_revenue), 2) as avg_revenue_per_customer,
    ROUND(AVG(total_profit), 2) as avg_profit_per_customer,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin_pct,
    
    -- Business insights
    ROUND(SUM(total_revenue), 2) as segment_total_revenue,
    ROUND(SUM(total_profit), 2) as segment_total_profit,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 1) as pct_of_customers,
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_revenue

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
WHERE total_orders > 0
GROUP BY revenue_segment, lifecycle_stage
ORDER BY segment_total_profit DESC

-- Customer segment profitability, where to focus retention efforts, which segments drive revenue
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.customer_insights"} */;
[0m07:39:16.547657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m07:39:16.583162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a33c01c-627c-4a87-bbc5-a86f281213ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e243ee0>]}
[0m07:39:16.584047 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PLANETKART_ANALYTICS_analytics.customer_insights  [[32mSUCCESS 1[0m in 0.44s]
[0m07:39:16.584685 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.customer_insights
[0m07:39:16.585902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:16.586239 [debug] [MainThread]: Connection 'model.planetkart_analytics.customer_insights' was left open.
[0m07:39:16.586523 [debug] [MainThread]: On model.planetkart_analytics.customer_insights: Close
[0m07:39:16.692324 [info ] [MainThread]: 
[0m07:39:16.693005 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m07:39:16.693934 [debug] [MainThread]: Command end result
[0m07:39:16.733021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:39:16.738829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:39:16.751057 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:39:16.751351 [info ] [MainThread]: 
[0m07:39:16.751677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:39:16.751906 [info ] [MainThread]: 
[0m07:39:16.752167 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m07:39:16.757829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6751165, "process_in_blocks": "0", "process_kernel_time": 0.665733, "process_mem_max_rss": "168935424", "process_out_blocks": "0", "process_user_time": 2.556237}
[0m07:39:16.758305 [debug] [MainThread]: Command `dbt run` succeeded at 07:39:16.758225 after 7.68 seconds
[0m07:39:16.758618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e26b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e20e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d0ad0>]}
[0m07:39:16.758899 [debug] [MainThread]: Flushing usage events
[0m07:39:17.759469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:25.498847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10333f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105403750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105403610>]}


============================== 07:39:25.504447 | 023bee3f-8c37-4a6c-9e1e-753102c573d4 ==============================
[0m07:39:25.504447 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:39:25.504812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:39:26.381639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b4f5c0>]}
[0m07:39:26.409565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e6690>]}
[0m07:39:26.411799 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:39:26.489100 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:39:26.672720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:39:26.672970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:39:26.703664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106790650>]}
[0m07:39:26.895961 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:39:26.902172 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:39:26.947832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d6a80>]}
[0m07:39:26.948313 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:39:26.948617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cec10>]}
[0m07:39:26.950795 [info ] [MainThread]: 
[0m07:39:26.951113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:26.951346 [info ] [MainThread]: 
[0m07:39:26.951751 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:39:26.956577 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m07:39:27.183109 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:39:27.183340 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:39:27.183486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:27.688692 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.505 seconds
[0m07:39:27.695661 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:39:27.696277 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:39:27.833751 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.137 seconds
[0m07:39:27.837010 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:39:27.837324 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:39:27.924035 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.086 seconds
[0m07:39:27.927612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_analytics)
[0m07:39:27.939773 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_analytics"
[0m07:39:27.940099 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_analytics"} */;
[0m07:39:28.020992 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.081 seconds
[0m07:39:28.024362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m07:39:28.027580 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m07:39:28.028074 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m07:39:28.170862 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.142 seconds
[0m07:39:28.174762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m07:39:28.179038 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m07:39:28.179513 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m07:39:28.288384 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.108 seconds
[0m07:39:28.293509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m07:39:28.298252 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m07:39:28.298783 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m07:39:28.395461 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m07:39:28.400865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202c32b0>]}
[0m07:39:28.407934 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m07:39:28.408691 [info ] [Thread-1 (]: 1 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m07:39:28.409270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.stg_customers)
[0m07:39:28.409743 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m07:39:28.421521 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m07:39:28.433224 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m07:39:28.462381 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m07:39:28.482123 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m07:39:28.482522 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m07:39:28.667875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m07:39:28.703485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120236210>]}
[0m07:39:28.704263 [info ] [Thread-1 (]: 1 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.29s]
[0m07:39:28.704844 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m07:39:28.705226 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m07:39:28.705786 [info ] [Thread-1 (]: 2 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m07:39:28.706278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m07:39:28.706639 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m07:39:28.709199 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m07:39:28.722927 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m07:39:28.725663 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m07:39:28.737093 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m07:39:28.737494 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m07:39:28.936201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m07:39:28.941091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204f55a0>]}
[0m07:39:28.942349 [info ] [Thread-1 (]: 2 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.23s]
[0m07:39:28.943182 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m07:39:28.943730 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m07:39:28.944446 [info ] [Thread-1 (]: 3 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders .. [RUN]
[0m07:39:28.945102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m07:39:28.945612 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m07:39:28.950237 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m07:39:28.963258 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m07:39:28.966855 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m07:39:28.981141 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m07:39:28.981615 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m07:39:29.300510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m07:39:29.304439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206d9810>]}
[0m07:39:29.305548 [info ] [Thread-1 (]: 3 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.36s]
[0m07:39:29.306394 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m07:39:29.306983 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m07:39:29.307986 [info ] [Thread-1 (]: 4 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [RUN]
[0m07:39:29.309067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m07:39:29.309746 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m07:39:29.314804 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m07:39:29.325002 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m07:39:29.328536 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m07:39:29.342728 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m07:39:29.343231 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m07:39:29.543181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m07:39:29.547851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120692ed0>]}
[0m07:39:29.549022 [info ] [Thread-1 (]: 4 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.24s]
[0m07:39:29.549806 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m07:39:29.550311 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m07:39:29.551021 [info ] [Thread-1 (]: 5 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions . [RUN]
[0m07:39:29.551737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m07:39:29.552208 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m07:39:29.556343 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m07:39:29.568841 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m07:39:29.572392 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m07:39:29.589895 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m07:39:29.590341 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m07:39:29.844843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m07:39:29.849678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206e34d0>]}
[0m07:39:29.850651 [info ] [Thread-1 (]: 5 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.30s]
[0m07:39:29.851419 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m07:39:29.851928 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m07:39:29.852574 [info ] [Thread-1 (]: 6 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m07:39:29.853207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m07:39:29.853770 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m07:39:29.873106 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m07:39:29.887999 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m07:39:29.911145 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m07:39:29.935193 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m07:39:29.935765 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 then 'Repeat_Engagement'
        else 'Single_Engagement'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m07:39:31.722156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.785 seconds
[0m07:39:31.727550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12066d4f0>]}
[0m07:39:31.728539 [info ] [Thread-1 (]: 6 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.87s]
[0m07:39:31.729281 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m07:39:31.729770 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m07:39:31.730465 [info ] [Thread-1 (]: 7 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m07:39:31.731216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m07:39:31.731793 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m07:39:31.737840 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m07:39:31.756518 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m07:39:31.760222 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m07:39:31.775976 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m07:39:31.776654 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m07:39:32.787579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.010 seconds
[0m07:39:32.790299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204d3ad0>]}
[0m07:39:32.791160 [info ] [Thread-1 (]: 7 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 1.06s]
[0m07:39:32.791935 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m07:39:32.792443 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m07:39:32.793073 [info ] [Thread-1 (]: 8 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m07:39:32.793629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m07:39:32.794231 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m07:39:32.801838 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m07:39:32.811284 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m07:39:32.814516 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m07:39:32.824663 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m07:39:32.825190 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m07:39:33.462469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m07:39:33.467504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204d3d10>]}
[0m07:39:33.469085 [info ] [Thread-1 (]: 8 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 0.67s]
[0m07:39:33.469889 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m07:39:33.470435 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m07:39:33.471130 [info ] [Thread-1 (]: 9 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m07:39:33.471843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m07:39:33.472351 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m07:39:33.477890 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m07:39:33.496253 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m07:39:33.500856 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m07:39:33.515267 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m07:39:33.515923 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m07:39:34.303821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.787 seconds
[0m07:39:34.309303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204d2990>]}
[0m07:39:34.310527 [info ] [Thread-1 (]: 9 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.84s]
[0m07:39:34.311481 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m07:39:34.312118 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.customer_insights
[0m07:39:34.312956 [info ] [Thread-1 (]: 10 of 13 START sql view model PLANETKART_ANALYTICS_analytics.customer_insights . [RUN]
[0m07:39:34.313671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now model.planetkart_analytics.customer_insights)
[0m07:39:34.314290 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.customer_insights
[0m07:39:34.318751 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.customer_insights"
[0m07:39:34.321712 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.customer_insights
[0m07:39:34.325331 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.customer_insights"
[0m07:39:34.328735 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.customer_insights"
[0m07:39:34.329305 [debug] [Thread-1 (]: On model.planetkart_analytics.customer_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_analytics.customer_insights
  
  
  
  
  as (
    

-- Customer Intelligence Dashboard
-- Shows key customer segments and behavioral patterns

SELECT 
    -- Customer segmentation summary
    revenue_segment,
    lifecycle_stage,
    COUNT(*) as customer_count,
    ROUND(AVG(total_revenue), 2) as avg_revenue_per_customer,
    ROUND(AVG(total_profit), 2) as avg_profit_per_customer,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin_pct,
    
    -- Business insights
    ROUND(SUM(total_revenue), 2) as segment_total_revenue,
    ROUND(SUM(total_profit), 2) as segment_total_profit,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 1) as pct_of_customers,
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_revenue

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
WHERE total_orders > 0
GROUP BY revenue_segment, lifecycle_stage
ORDER BY segment_total_profit DESC

-- Customer segment profitability, where to focus retention efforts, which segments drive revenue
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.customer_insights"} */;
[0m07:39:34.506813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m07:39:34.511661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204d14f0>]}
[0m07:39:34.512907 [info ] [Thread-1 (]: 10 of 13 OK created sql view model PLANETKART_ANALYTICS_analytics.customer_insights  [[32mSUCCESS 1[0m in 0.20s]
[0m07:39:34.513792 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.customer_insights
[0m07:39:34.514279 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.product_insights
[0m07:39:34.514948 [info ] [Thread-1 (]: 11 of 13 START sql view model PLANETKART_ANALYTICS_analytics.product_insights .. [RUN]
[0m07:39:34.515583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.customer_insights, now model.planetkart_analytics.product_insights)
[0m07:39:34.516081 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.product_insights
[0m07:39:34.520485 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.product_insights"
[0m07:39:34.522596 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.product_insights
[0m07:39:34.526067 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.product_insights"
[0m07:39:34.528626 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.product_insights"
[0m07:39:34.529154 [debug] [Thread-1 (]: On model.planetkart_analytics.product_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_analytics.product_insights
  
  
  
  
  as (
    --Product Performance



-- Product Portfolio Analysis
-- Identifies winners, losers, and opportunities

SELECT 
    category,
    profit_segment,
    COUNT(*) as products_in_segment,
    ROUND(SUM(total_revenue), 2) as category_revenue,
    ROUND(SUM(total_profit), 2) as category_profit,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin,
    
    -- Top performer in each category
    MAX(CASE WHEN total_profit > 0 THEN product_name END) as top_product,
    MAX(total_profit) as highest_profit,
    
    -- Performance insights
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_total_revenue,
    COUNT(CASE WHEN sales_performance = 'Best_Seller' THEN 1 END) as best_sellers_count

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
GROUP BY category, profit_segment
HAVING SUM(total_revenue) > 0
ORDER BY category_profit DESC

--Which categories are most profitable, product mix optimization, inventory focus areas
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.product_insights"} */;
[0m07:39:34.712249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m07:39:34.716957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12066db50>]}
[0m07:39:34.718011 [info ] [Thread-1 (]: 11 of 13 OK created sql view model PLANETKART_ANALYTICS_analytics.product_insights  [[32mSUCCESS 1[0m in 0.20s]
[0m07:39:34.718751 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.product_insights
[0m07:39:34.719256 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.business_kpis
[0m07:39:34.719975 [info ] [Thread-1 (]: 12 of 13 START sql view model PLANETKART_ANALYTICS_analytics.business_kpis ..... [RUN]
[0m07:39:34.720598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.product_insights, now model.planetkart_analytics.business_kpis)
[0m07:39:34.721082 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.business_kpis
[0m07:39:34.726059 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.business_kpis"
[0m07:39:34.729782 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.business_kpis
[0m07:39:34.733370 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.business_kpis"
[0m07:39:34.737130 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.business_kpis"
[0m07:39:34.737706 [debug] [Thread-1 (]: On model.planetkart_analytics.business_kpis: create or replace   view PLANETKART.PLANETKART_ANALYTICS_analytics.business_kpis
  
  
  
  
  as (
    

-- Executive Dashboard KPIs
-- Key performance indicators for business review

WITH monthly_metrics AS (
    SELECT 
        DATE_TRUNC('month', order_date) as order_month,
        COUNT(*) as monthly_orders,
        SUM(order_revenue) as monthly_revenue,
        SUM(order_profit) as monthly_profit,
        COUNT(DISTINCT customer_id) as monthly_customers,
        AVG(order_revenue) as avg_order_value
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    WHERE is_completed = 1
    GROUP BY DATE_TRUNC('month', order_date)
),

customer_metrics AS (
    SELECT 
        COUNT(*) as total_customers,
        COUNT(CASE WHEN lifecycle_stage = 'Loyal_Customer' THEN 1 END) as loyal_customers,
        COUNT(CASE WHEN churn_risk = 'At_Risk' THEN 1 END) as at_risk_customers,
        AVG(total_revenue) as avg_customer_value
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    WHERE total_orders > 0
)

SELECT 
    -- Time period
    'Business Overview' as metric_category,
    
    -- Revenue metrics
    (SELECT SUM(monthly_revenue) FROM monthly_metrics) as total_revenue,
    (SELECT SUM(monthly_profit) FROM monthly_metrics) as total_profit,
    (SELECT AVG(avg_order_value) FROM monthly_metrics) as avg_order_value,
    
    -- Customer metrics
    (SELECT total_customers FROM customer_metrics) as total_customers,
    (SELECT loyal_customers FROM customer_metrics) as loyal_customers,
    (SELECT at_risk_customers FROM customer_metrics) as at_risk_customers,
    
    -- Performance ratios
    ROUND((SELECT SUM(monthly_profit) FROM monthly_metrics) / 
          (SELECT SUM(monthly_revenue) FROM monthly_metrics) * 100, 1) as overall_profit_margin,
    
    ROUND((SELECT loyal_customers FROM customer_metrics) * 100.0 / 
          (SELECT total_customers FROM customer_metrics), 1) as loyal_customer_pct
        

--Executive summary metrics, overall business health, key ratios for board presentations
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.business_kpis"} */;
[0m07:39:34.960007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m07:39:34.964431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120770890>]}
[0m07:39:34.965597 [info ] [Thread-1 (]: 12 of 13 OK created sql view model PLANETKART_ANALYTICS_analytics.business_kpis  [[32mSUCCESS 1[0m in 0.24s]
[0m07:39:34.966407 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.business_kpis
[0m07:39:34.966915 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.regional_insights
[0m07:39:34.967574 [info ] [Thread-1 (]: 13 of 13 START sql view model PLANETKART_ANALYTICS_analytics.regional_insights . [RUN]
[0m07:39:34.968151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.business_kpis, now model.planetkart_analytics.regional_insights)
[0m07:39:34.968624 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.regional_insights
[0m07:39:34.973266 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.regional_insights"
[0m07:39:34.975238 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.regional_insights
[0m07:39:34.978824 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.regional_insights"
[0m07:39:34.981600 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.regional_insights"
[0m07:39:34.982122 [debug] [Thread-1 (]: On model.planetkart_analytics.regional_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_analytics.regional_insights
  
  
  
  
  as (
    --Regional Performance



-- Multi-Planetary Market Analysis
-- Regional expansion and performance insights

SELECT 
    r.planet,
    r.market_category,
    
    -- Market size metrics
    COUNT(DISTINCT f.customer_id) as unique_customers,
    COUNT(f.order_id) as total_orders,
    ROUND(SUM(f.order_revenue), 2) as total_revenue,
    ROUND(SUM(f.order_profit), 2) as total_profit,
    
    -- Performance metrics
    ROUND(AVG(f.order_revenue), 2) as avg_order_value,
    ROUND(SUM(f.order_profit) / SUM(f.order_revenue) * 100, 1) as profit_margin_pct,
    ROUND(COUNT(f.order_id) * 1.0 / COUNT(DISTINCT f.customer_id), 1) as orders_per_customer,
    
    -- Market insights
    ROUND(SUM(f.order_revenue) * 100.0 / SUM(SUM(f.order_revenue)) OVER(), 1) as market_share_pct

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders f
JOIN PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions r ON f.region_sk = r.region_sk
WHERE f.is_completed = 1
GROUP BY r.planet, r.market_category
ORDER BY total_profit DESC

-- Which planets are most profitable, expansion opportunities, market penetration rates
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.regional_insights"} */;
[0m07:39:35.209228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m07:39:35.214968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023bee3f-8c37-4a6c-9e1e-753102c573d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120770d70>]}
[0m07:39:35.215878 [info ] [Thread-1 (]: 13 of 13 OK created sql view model PLANETKART_ANALYTICS_analytics.regional_insights  [[32mSUCCESS 1[0m in 0.25s]
[0m07:39:35.216595 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.regional_insights
[0m07:39:35.218124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:35.218482 [debug] [MainThread]: Connection 'model.planetkart_analytics.regional_insights' was left open.
[0m07:39:35.218793 [debug] [MainThread]: On model.planetkart_analytics.regional_insights: Close
[0m07:39:35.355571 [info ] [MainThread]: 
[0m07:39:35.356621 [info ] [MainThread]: Finished running 4 table models, 9 view models in 0 hours 0 minutes and 8.40 seconds (8.40s).
[0m07:39:35.360545 [debug] [MainThread]: Command end result
[0m07:39:35.402326 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:39:35.408564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:39:35.415705 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:39:35.415965 [info ] [MainThread]: 
[0m07:39:35.416240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:39:35.416462 [info ] [MainThread]: 
[0m07:39:35.416800 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m07:39:35.422849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.991132, "process_in_blocks": "0", "process_kernel_time": 0.474037, "process_mem_max_rss": "157696000", "process_out_blocks": "0", "process_user_time": 2.321616}
[0m07:39:35.423314 [debug] [MainThread]: Command `dbt run` succeeded at 07:39:35.423232 after 9.99 seconds
[0m07:39:35.423604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12066d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207705f0>]}
[0m07:39:35.423876 [debug] [MainThread]: Flushing usage events
[0m07:39:36.574028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:41:59.463824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b03750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b03610>]}


============================== 07:41:59.470535 | 19fcb1f8-7a2f-43c3-a23c-fade608ed8cc ==============================
[0m07:41:59.470535 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:41:59.470895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:00.337394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac35c0>]}
[0m07:42:00.365964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e6690>]}
[0m07:42:00.368013 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:42:00.450564 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:42:00.516991 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:42:00.517281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8fe50>]}
[0m07:42:01.517715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c84500>]}
[0m07:42:01.709262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:42:01.714927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:42:01.760823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aba7b0>]}
[0m07:42:01.761241 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:42:01.761488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef9a50>]}
[0m07:42:01.763772 [info ] [MainThread]: 
[0m07:42:01.764140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:01.764345 [info ] [MainThread]: 
[0m07:42:01.764688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:42:01.768711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m07:42:02.003879 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:42:02.004120 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:42:02.004267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:02.645129 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.641 seconds
[0m07:42:02.650401 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:42:02.650713 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:42:02.744039 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.093 seconds
[0m07:42:02.751697 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:42:02.752347 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:42:02.850850 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.098 seconds
[0m07:42:02.853614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now create_PLANETKART_PLANETKART_ANALYTICS_advance_analytics)
[0m07:42:02.854628 [debug] [ThreadPool]: Creating schema "database: "PLANETKART"
schema: "PLANETKART_ANALYTICS_advance_analytics"
"
[0m07:42:02.859532 [debug] [ThreadPool]: Using snowflake connection "create_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"
[0m07:42:02.859846 [debug] [ThreadPool]: On create_PLANETKART_PLANETKART_ANALYTICS_advance_analytics: create schema if not exists PLANETKART.PLANETKART_ANALYTICS_advance_analytics
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "create_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"} */
[0m07:42:03.014552 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.154 seconds
[0m07:42:03.018855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_PLANETKART_PLANETKART_ANALYTICS_advance_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m07:42:03.032014 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m07:42:03.032415 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m07:42:03.211052 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.178 seconds
[0m07:42:03.215211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m07:42:03.218983 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m07:42:03.219260 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m07:42:03.356951 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m07:42:03.360550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m07:42:03.364267 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m07:42:03.364757 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m07:42:03.492943 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.128 seconds
[0m07:42:03.497756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics)
[0m07:42:03.508510 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"
[0m07:42:03.509125 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_advance_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"} */;
[0m07:42:03.602490 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.093 seconds
[0m07:42:03.606546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b19cd0>]}
[0m07:42:03.613087 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m07:42:03.613980 [info ] [Thread-1 (]: 1 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m07:42:03.614589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics, now model.planetkart_analytics.stg_customers)
[0m07:42:03.615073 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m07:42:03.625893 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m07:42:03.628401 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m07:42:03.658959 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m07:42:03.661045 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m07:42:03.661400 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m07:42:03.914468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m07:42:03.949323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d8100>]}
[0m07:42:03.950080 [info ] [Thread-1 (]: 1 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.33s]
[0m07:42:03.950657 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m07:42:03.951032 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m07:42:03.951511 [info ] [Thread-1 (]: 2 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m07:42:03.951897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m07:42:03.952220 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m07:42:03.955503 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m07:42:03.957764 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m07:42:03.960001 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m07:42:03.962038 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m07:42:03.962380 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m07:42:04.661857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m07:42:04.665915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d2850>]}
[0m07:42:04.667144 [info ] [Thread-1 (]: 2 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.71s]
[0m07:42:04.668252 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m07:42:04.669059 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m07:42:04.669811 [info ] [Thread-1 (]: 3 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders .. [RUN]
[0m07:42:04.670364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m07:42:04.670744 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m07:42:04.674588 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m07:42:04.676520 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m07:42:04.679520 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m07:42:04.681727 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m07:42:04.682208 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m07:42:04.901163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m07:42:04.904513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b9750>]}
[0m07:42:04.905632 [info ] [Thread-1 (]: 3 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.23s]
[0m07:42:04.906648 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m07:42:04.907394 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m07:42:04.908771 [info ] [Thread-1 (]: 4 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [RUN]
[0m07:42:04.909800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m07:42:04.910459 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m07:42:04.916163 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m07:42:04.918144 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m07:42:04.920918 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m07:42:04.924324 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m07:42:04.924780 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m07:42:05.157274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m07:42:05.160537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a038980>]}
[0m07:42:05.161628 [info ] [Thread-1 (]: 4 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.25s]
[0m07:42:05.162559 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m07:42:05.163274 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m07:42:05.164202 [info ] [Thread-1 (]: 5 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions . [RUN]
[0m07:42:05.164801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m07:42:05.165132 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m07:42:05.170226 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m07:42:05.172021 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m07:42:05.174599 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m07:42:05.176649 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m07:42:05.177097 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m07:42:05.362388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m07:42:05.368977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a037170>]}
[0m07:42:05.369626 [info ] [Thread-1 (]: 5 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.20s]
[0m07:42:05.370115 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m07:42:05.370435 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m07:42:05.370849 [info ] [Thread-1 (]: 6 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m07:42:05.371260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m07:42:05.371544 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m07:42:05.377591 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m07:42:05.380414 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m07:42:05.405742 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m07:42:05.410135 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m07:42:05.410719 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 then 'Repeat_Engagement'
        else 'Single_Engagement'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m07:42:07.924206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.513 seconds
[0m07:42:07.928029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a037e30>]}
[0m07:42:07.929091 [info ] [Thread-1 (]: 6 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 2.56s]
[0m07:42:07.929990 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m07:42:07.930881 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m07:42:07.931720 [info ] [Thread-1 (]: 7 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m07:42:07.932455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m07:42:07.932827 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m07:42:07.937396 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m07:42:07.939335 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m07:42:07.941628 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m07:42:07.945145 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m07:42:07.945610 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m07:42:08.904390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m07:42:08.907805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a270590>]}
[0m07:42:08.909012 [info ] [Thread-1 (]: 7 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 0.98s]
[0m07:42:08.910071 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m07:42:08.910660 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m07:42:08.911365 [info ] [Thread-1 (]: 8 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m07:42:08.912423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m07:42:08.913018 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m07:42:08.920217 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m07:42:08.923134 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m07:42:08.925802 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m07:42:08.929221 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m07:42:08.929814 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m07:42:10.546548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.616 seconds
[0m07:42:10.551369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2710d0>]}
[0m07:42:10.552623 [info ] [Thread-1 (]: 8 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 1.64s]
[0m07:42:10.553668 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m07:42:10.554226 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m07:42:10.554906 [info ] [Thread-1 (]: 9 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m07:42:10.555620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m07:42:10.556270 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m07:42:10.562747 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m07:42:10.566791 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m07:42:10.569938 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m07:42:10.572764 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m07:42:10.573276 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m07:42:11.463771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m07:42:11.467173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a270890>]}
[0m07:42:11.468009 [info ] [Thread-1 (]: 9 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.91s]
[0m07:42:11.468735 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m07:42:11.469295 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.customer_insights
[0m07:42:11.470045 [info ] [Thread-1 (]: 10 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [RUN]
[0m07:42:11.470665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now model.planetkart_analytics.customer_insights)
[0m07:42:11.471049 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.customer_insights
[0m07:42:11.474638 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.customer_insights"
[0m07:42:11.476492 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.customer_insights
[0m07:42:11.478783 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.customer_insights"
[0m07:42:11.482263 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.customer_insights"
[0m07:42:11.482870 [debug] [Thread-1 (]: On model.planetkart_analytics.customer_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.customer_insights
  
  
  
  
  as (
    

-- Customer Intelligence Dashboard
-- Shows key customer segments and behavioral patterns

SELECT 
    -- Customer segmentation summary
    revenue_segment,
    lifecycle_stage,
    COUNT(*) as customer_count,
    ROUND(AVG(total_revenue), 2) as avg_revenue_per_customer,
    ROUND(AVG(total_profit), 2) as avg_profit_per_customer,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin_pct,
    
    -- Business insights
    ROUND(SUM(total_revenue), 2) as segment_total_revenue,
    ROUND(SUM(total_profit), 2) as segment_total_profit,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 1) as pct_of_customers,
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_revenue

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
WHERE total_orders > 0
GROUP BY revenue_segment, lifecycle_stage
ORDER BY segment_total_profit DESC

-- Customer segment profitability, where to focus retention efforts, which segments drive revenue
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.customer_insights"} */;
[0m07:42:11.738944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m07:42:11.742737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2719d0>]}
[0m07:42:11.743754 [info ] [Thread-1 (]: 10 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [[32mSUCCESS 1[0m in 0.27s]
[0m07:42:11.744668 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.customer_insights
[0m07:42:11.745325 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.product_insights
[0m07:42:11.745924 [info ] [Thread-1 (]: 11 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [RUN]
[0m07:42:11.746505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.customer_insights, now model.planetkart_analytics.product_insights)
[0m07:42:11.747156 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.product_insights
[0m07:42:11.754555 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.product_insights"
[0m07:42:11.757394 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.product_insights
[0m07:42:11.760058 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.product_insights"
[0m07:42:11.763531 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.product_insights"
[0m07:42:11.764337 [debug] [Thread-1 (]: On model.planetkart_analytics.product_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.product_insights
  
  
  
  
  as (
    --Product Performance



-- Product Portfolio Analysis
-- Identifies winners, losers, and opportunities

SELECT 
    category,
    profit_segment,
    COUNT(*) as products_in_segment,
    ROUND(SUM(total_revenue), 2) as category_revenue,
    ROUND(SUM(total_profit), 2) as category_profit,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin,
    
    -- Top performer in each category
    MAX(CASE WHEN total_profit > 0 THEN product_name END) as top_product,
    MAX(total_profit) as highest_profit,
    
    -- Performance insights
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_total_revenue,
    COUNT(CASE WHEN sales_performance = 'Best_Seller' THEN 1 END) as best_sellers_count

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
GROUP BY category, profit_segment
HAVING SUM(total_revenue) > 0
ORDER BY category_profit DESC

--Which categories are most profitable, product mix optimization, inventory focus areas
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.product_insights"} */;
[0m07:42:11.975466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m07:42:11.980659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a035250>]}
[0m07:42:11.981655 [info ] [Thread-1 (]: 11 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [[32mSUCCESS 1[0m in 0.23s]
[0m07:42:11.982427 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.product_insights
[0m07:42:11.982952 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.business_kpis
[0m07:42:11.983632 [info ] [Thread-1 (]: 12 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [RUN]
[0m07:42:11.984304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.product_insights, now model.planetkart_analytics.business_kpis)
[0m07:42:11.984806 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.business_kpis
[0m07:42:11.990673 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.business_kpis"
[0m07:42:11.994478 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.business_kpis
[0m07:42:11.997557 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.business_kpis"
[0m07:42:12.002834 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.business_kpis"
[0m07:42:12.003381 [debug] [Thread-1 (]: On model.planetkart_analytics.business_kpis: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.business_kpis
  
  
  
  
  as (
    

-- Executive Dashboard KPIs
-- Key performance indicators for business review

WITH monthly_metrics AS (
    SELECT 
        DATE_TRUNC('month', order_date) as order_month,
        COUNT(*) as monthly_orders,
        SUM(order_revenue) as monthly_revenue,
        SUM(order_profit) as monthly_profit,
        COUNT(DISTINCT customer_id) as monthly_customers,
        AVG(order_revenue) as avg_order_value
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    WHERE is_completed = 1
    GROUP BY DATE_TRUNC('month', order_date)
),

customer_metrics AS (
    SELECT 
        COUNT(*) as total_customers,
        COUNT(CASE WHEN lifecycle_stage = 'Loyal_Customer' THEN 1 END) as loyal_customers,
        COUNT(CASE WHEN churn_risk = 'At_Risk' THEN 1 END) as at_risk_customers,
        AVG(total_revenue) as avg_customer_value
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    WHERE total_orders > 0
)

SELECT 
    -- Time period
    'Business Overview' as metric_category,
    
    -- Revenue metrics
    (SELECT SUM(monthly_revenue) FROM monthly_metrics) as total_revenue,
    (SELECT SUM(monthly_profit) FROM monthly_metrics) as total_profit,
    (SELECT AVG(avg_order_value) FROM monthly_metrics) as avg_order_value,
    
    -- Customer metrics
    (SELECT total_customers FROM customer_metrics) as total_customers,
    (SELECT loyal_customers FROM customer_metrics) as loyal_customers,
    (SELECT at_risk_customers FROM customer_metrics) as at_risk_customers,
    
    -- Performance ratios
    ROUND((SELECT SUM(monthly_profit) FROM monthly_metrics) / 
          (SELECT SUM(monthly_revenue) FROM monthly_metrics) * 100, 1) as overall_profit_margin,
    
    ROUND((SELECT loyal_customers FROM customer_metrics) * 100.0 / 
          (SELECT total_customers FROM customer_metrics), 1) as loyal_customer_pct
        

--Executive summary metrics, overall business health, key ratios for board presentations
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.business_kpis"} */;
[0m07:42:12.426677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m07:42:12.428907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a037230>]}
[0m07:42:12.429539 [info ] [Thread-1 (]: 12 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [[32mSUCCESS 1[0m in 0.44s]
[0m07:42:12.430081 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.business_kpis
[0m07:42:12.430478 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.regional_insights
[0m07:42:12.431234 [info ] [Thread-1 (]: 13 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [RUN]
[0m07:42:12.431918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.business_kpis, now model.planetkart_analytics.regional_insights)
[0m07:42:12.432302 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.regional_insights
[0m07:42:12.436189 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.regional_insights"
[0m07:42:12.438657 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.regional_insights
[0m07:42:12.441063 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.regional_insights"
[0m07:42:12.443595 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.regional_insights"
[0m07:42:12.444034 [debug] [Thread-1 (]: On model.planetkart_analytics.regional_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.regional_insights
  
  
  
  
  as (
    --Regional Performance



-- Multi-Planetary Market Analysis
-- Regional expansion and performance insights

SELECT 
    r.planet,
    r.market_category,
    
    -- Market size metrics
    COUNT(DISTINCT f.customer_id) as unique_customers,
    COUNT(f.order_id) as total_orders,
    ROUND(SUM(f.order_revenue), 2) as total_revenue,
    ROUND(SUM(f.order_profit), 2) as total_profit,
    
    -- Performance metrics
    ROUND(AVG(f.order_revenue), 2) as avg_order_value,
    ROUND(SUM(f.order_profit) / SUM(f.order_revenue) * 100, 1) as profit_margin_pct,
    ROUND(COUNT(f.order_id) * 1.0 / COUNT(DISTINCT f.customer_id), 1) as orders_per_customer,
    
    -- Market insights
    ROUND(SUM(f.order_revenue) * 100.0 / SUM(SUM(f.order_revenue)) OVER(), 1) as market_share_pct

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders f
JOIN PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions r ON f.region_sk = r.region_sk
WHERE f.is_completed = 1
GROUP BY r.planet, r.market_category
ORDER BY total_profit DESC

-- Which planets are most profitable, expansion opportunities, market penetration rates
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.regional_insights"} */;
[0m07:42:12.638196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m07:42:12.642818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fcb1f8-7a2f-43c3-a23c-fade608ed8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a037a70>]}
[0m07:42:12.644141 [info ] [Thread-1 (]: 13 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [[32mSUCCESS 1[0m in 0.21s]
[0m07:42:12.645243 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.regional_insights
[0m07:42:12.647017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:12.648291 [debug] [MainThread]: Connection 'model.planetkart_analytics.regional_insights' was left open.
[0m07:42:12.649085 [debug] [MainThread]: On model.planetkart_analytics.regional_insights: Close
[0m07:42:12.777944 [info ] [MainThread]: 
[0m07:42:12.779150 [info ] [MainThread]: Finished running 4 table models, 9 view models in 0 hours 0 minutes and 11.01 seconds (11.01s).
[0m07:42:12.782349 [debug] [MainThread]: Command end result
[0m07:42:12.823485 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:42:12.829276 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:42:12.843075 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:42:12.843436 [info ] [MainThread]: 
[0m07:42:12.843761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:42:12.844003 [info ] [MainThread]: 
[0m07:42:12.844270 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m07:42:12.850129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.459757, "process_in_blocks": "0", "process_kernel_time": 0.509526, "process_mem_max_rss": "162168832", "process_out_blocks": "0", "process_user_time": 2.839801}
[0m07:42:12.850633 [debug] [MainThread]: Command `dbt run` succeeded at 07:42:12.850536 after 13.46 seconds
[0m07:42:12.851231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106147fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a273b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a273b30>]}
[0m07:42:12.851583 [debug] [MainThread]: Flushing usage events
[0m07:42:14.275269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:48:47.052169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ab4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9f610>]}


============================== 07:48:47.057906 | 61583726-667f-492a-b35e-2e749fb848da ==============================
[0m07:48:47.057906 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:48:47.058287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:48:47.976157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bb5c0>]}
[0m07:48:48.004927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ea690>]}
[0m07:48:48.006919 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:48:48.086570 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:48:48.288493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:48:48.288896 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/Advance_analysis/business_kpis.sql
[0m07:48:48.420476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef8550>]}
[0m07:48:48.550682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:48:48.558343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:48:48.606883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078daa80>]}
[0m07:48:48.607246 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:48:48.607482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b24bb0>]}
[0m07:48:48.609192 [info ] [MainThread]: 
[0m07:48:48.609439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:48:48.609619 [info ] [MainThread]: 
[0m07:48:48.609921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:48:48.613500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m07:48:48.827184 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:48:48.827411 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:48:48.827550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:48:49.410335 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.582 seconds
[0m07:48:49.416909 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:48:49.417607 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:48:49.519249 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.101 seconds
[0m07:48:49.526726 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:48:49.527238 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:48:49.612521 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.085 seconds
[0m07:48:49.619628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m07:48:49.638105 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m07:48:49.638562 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m07:48:49.795762 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.157 seconds
[0m07:48:49.797775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics)
[0m07:48:49.800076 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"
[0m07:48:49.800333 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_advance_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"} */;
[0m07:48:49.932194 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.131 seconds
[0m07:48:49.936411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m07:48:49.946590 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m07:48:49.947155 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m07:48:50.081518 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.134 seconds
[0m07:48:50.086598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_snapshots)
[0m07:48:50.091209 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m07:48:50.091693 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m07:48:50.180505 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m07:48:50.186550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d006000>]}
[0m07:48:50.193260 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m07:48:50.194001 [info ] [Thread-1 (]: 1 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m07:48:50.194585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.stg_customers)
[0m07:48:50.195033 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m07:48:50.205244 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m07:48:50.228019 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m07:48:50.256109 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m07:48:50.292179 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m07:48:50.292571 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m07:48:50.474670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m07:48:50.511335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e4a10>]}
[0m07:48:50.512146 [info ] [Thread-1 (]: 1 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.31s]
[0m07:48:50.512746 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m07:48:50.513150 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m07:48:50.513692 [info ] [Thread-1 (]: 2 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m07:48:50.514181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m07:48:50.514544 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m07:48:50.517241 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m07:48:50.529487 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m07:48:50.532425 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m07:48:50.544115 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m07:48:50.544465 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m07:48:50.778082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m07:48:50.783370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f1f070>]}
[0m07:48:50.784573 [info ] [Thread-1 (]: 2 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.27s]
[0m07:48:50.785485 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m07:48:50.785970 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m07:48:50.786709 [info ] [Thread-1 (]: 3 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders .. [RUN]
[0m07:48:50.787406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m07:48:50.787909 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m07:48:50.792288 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m07:48:50.804787 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m07:48:50.808337 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m07:48:50.821647 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m07:48:50.822160 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m07:48:51.014878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m07:48:51.020232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1add10>]}
[0m07:48:51.021330 [info ] [Thread-1 (]: 3 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.23s]
[0m07:48:51.022239 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m07:48:51.022735 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m07:48:51.023427 [info ] [Thread-1 (]: 4 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [RUN]
[0m07:48:51.024073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m07:48:51.024570 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m07:48:51.028890 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m07:48:51.041243 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m07:48:51.044709 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m07:48:51.060030 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m07:48:51.060605 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m07:48:51.226277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m07:48:51.231656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19be50>]}
[0m07:48:51.232638 [info ] [Thread-1 (]: 4 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.21s]
[0m07:48:51.233412 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m07:48:51.233908 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m07:48:51.234585 [info ] [Thread-1 (]: 5 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions . [RUN]
[0m07:48:51.235340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m07:48:51.235943 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m07:48:51.240502 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m07:48:51.250508 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m07:48:51.254135 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m07:48:51.270362 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m07:48:51.270815 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m07:48:51.503854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m07:48:51.510729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ccc90>]}
[0m07:48:51.511645 [info ] [Thread-1 (]: 5 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.28s]
[0m07:48:51.512389 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m07:48:51.512897 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m07:48:51.513572 [info ] [Thread-1 (]: 6 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m07:48:51.514150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m07:48:51.514588 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m07:48:51.532132 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m07:48:51.549417 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m07:48:51.571754 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m07:48:51.592120 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m07:48:51.592672 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 then 'Repeat_Engagement'
        else 'Single_Engagement'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m07:48:52.851313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.258 seconds
[0m07:48:52.855249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1830b0>]}
[0m07:48:52.856513 [info ] [Thread-1 (]: 6 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.34s]
[0m07:48:52.857818 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m07:48:52.858652 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m07:48:52.859496 [info ] [Thread-1 (]: 7 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m07:48:52.860235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m07:48:52.860820 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m07:48:52.867284 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m07:48:52.880039 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m07:48:52.883782 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m07:48:52.917052 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m07:48:52.917806 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m07:48:53.903928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.985 seconds
[0m07:48:53.909440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1810d0>]}
[0m07:48:53.910801 [info ] [Thread-1 (]: 7 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 1.05s]
[0m07:48:53.911817 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m07:48:53.912409 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m07:48:53.913119 [info ] [Thread-1 (]: 8 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m07:48:53.913909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m07:48:53.914431 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m07:48:53.922317 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m07:48:53.933522 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m07:48:53.937244 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m07:48:53.955406 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m07:48:53.956010 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m07:48:55.029872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.073 seconds
[0m07:48:55.034018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d182870>]}
[0m07:48:55.035402 [info ] [Thread-1 (]: 8 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 1.12s]
[0m07:48:55.036523 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m07:48:55.037048 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m07:48:55.037749 [info ] [Thread-1 (]: 9 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m07:48:55.038437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m07:48:55.038930 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m07:48:55.044165 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m07:48:55.056239 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m07:48:55.059870 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m07:48:55.072406 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m07:48:55.072909 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m07:48:55.644527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m07:48:55.648763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1833b0>]}
[0m07:48:55.649915 [info ] [Thread-1 (]: 9 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.61s]
[0m07:48:55.650786 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m07:48:55.651304 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.customer_insights
[0m07:48:55.651993 [info ] [Thread-1 (]: 10 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [RUN]
[0m07:48:55.652691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now model.planetkart_analytics.customer_insights)
[0m07:48:55.653241 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.customer_insights
[0m07:48:55.657625 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.customer_insights"
[0m07:48:55.670356 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.customer_insights
[0m07:48:55.676629 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.customer_insights"
[0m07:48:55.690966 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.customer_insights"
[0m07:48:55.691545 [debug] [Thread-1 (]: On model.planetkart_analytics.customer_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.customer_insights
  
  
  
  
  as (
    

-- Customer Intelligence Dashboard
-- Shows key customer segments and behavioral patterns

SELECT 
    -- Customer segmentation summary
    revenue_segment,
    lifecycle_stage,
    COUNT(*) as customer_count,
    ROUND(AVG(total_revenue), 2) as avg_revenue_per_customer,
    ROUND(AVG(total_profit), 2) as avg_profit_per_customer,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin_pct,
    
    -- Business insights
    ROUND(SUM(total_revenue), 2) as segment_total_revenue,
    ROUND(SUM(total_profit), 2) as segment_total_profit,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 1) as pct_of_customers,
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_revenue

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
WHERE total_orders > 0
GROUP BY revenue_segment, lifecycle_stage
ORDER BY segment_total_profit DESC

-- Customer segment profitability, where to focus retention efforts, which segments drive revenue
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.customer_insights"} */;
[0m07:48:55.951603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m07:48:55.956819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1830b0>]}
[0m07:48:55.958113 [info ] [Thread-1 (]: 10 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [[32mSUCCESS 1[0m in 0.30s]
[0m07:48:55.959104 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.customer_insights
[0m07:48:55.959622 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.product_insights
[0m07:48:55.960291 [info ] [Thread-1 (]: 11 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [RUN]
[0m07:48:55.960921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.customer_insights, now model.planetkart_analytics.product_insights)
[0m07:48:55.961419 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.product_insights
[0m07:48:55.965926 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.product_insights"
[0m07:48:55.972571 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.product_insights
[0m07:48:55.976117 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.product_insights"
[0m07:48:55.988248 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.product_insights"
[0m07:48:55.988833 [debug] [Thread-1 (]: On model.planetkart_analytics.product_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.product_insights
  
  
  
  
  as (
    --Product Performance



-- Product Portfolio Analysis
-- Identifies winners, losers, and opportunities

SELECT 
    category,
    profit_segment,
    COUNT(*) as products_in_segment,
    ROUND(SUM(total_revenue), 2) as category_revenue,
    ROUND(SUM(total_profit), 2) as category_profit,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin,
    
    -- Top performer in each category
    MAX(CASE WHEN total_profit > 0 THEN product_name END) as top_product,
    MAX(total_profit) as highest_profit,
    
    -- Performance insights
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_total_revenue,
    COUNT(CASE WHEN sales_performance = 'Best_Seller' THEN 1 END) as best_sellers_count

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
GROUP BY category, profit_segment
HAVING SUM(total_revenue) > 0
ORDER BY category_profit DESC

--Which categories are most profitable, product mix optimization, inventory focus areas
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.product_insights"} */;
[0m07:48:56.232413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m07:48:56.237485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0dc5f0>]}
[0m07:48:56.238606 [info ] [Thread-1 (]: 11 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [[32mSUCCESS 1[0m in 0.28s]
[0m07:48:56.239980 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.product_insights
[0m07:48:56.240720 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.business_kpis
[0m07:48:56.241581 [info ] [Thread-1 (]: 12 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [RUN]
[0m07:48:56.242335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.product_insights, now model.planetkart_analytics.business_kpis)
[0m07:48:56.242895 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.business_kpis
[0m07:48:56.251553 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.business_kpis"
[0m07:48:56.262924 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.business_kpis
[0m07:48:56.267542 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.business_kpis"
[0m07:48:56.285534 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.business_kpis"
[0m07:48:56.286276 [debug] [Thread-1 (]: On model.planetkart_analytics.business_kpis: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.business_kpis
  
  
  
  
  as (
    

-- Executive KPI Dashboard - Actionable Business Metrics
SELECT 
    'PlanetKart Business Metrics' as report_name,
    CURRENT_DATE() as report_date,
    
    -- Revenue Metrics
    (SELECT SUM(order_revenue) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) as total_revenue,
    (SELECT SUM(order_profit) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) as total_profit,
    (SELECT AVG(order_revenue) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) as avg_order_value,
    
    -- Customer Metrics  
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE total_orders > 0) as total_active_customers,
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE lifecycle_stage = 'Loyal_Customer') as loyal_customers,
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE churn_risk = 'At_Risk') as at_risk_customers,
    
    -- Product Metrics
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products WHERE sales_performance = 'Best_Seller') as best_selling_products,
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products WHERE profit_segment = 'High_Profit') as high_profit_products,
    
    -- Regional Metrics
    (SELECT COUNT(DISTINCT planet) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions) as markets_served,
    
    -- Performance Ratios
    ROUND((SELECT SUM(order_profit) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) / 
          (SELECT SUM(order_revenue) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) * 100, 1) as profit_margin_pct,
          
    ROUND((SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE lifecycle_stage = 'Loyal_Customer') * 100.0 / 
          (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE total_orders > 0), 1) as loyal_customer_pct
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.business_kpis"} */;
[0m07:48:56.527095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m07:48:56.532287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d182ff0>]}
[0m07:48:56.533437 [info ] [Thread-1 (]: 12 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [[32mSUCCESS 1[0m in 0.29s]
[0m07:48:56.534205 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.business_kpis
[0m07:48:56.534734 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.regional_insights
[0m07:48:56.535397 [info ] [Thread-1 (]: 13 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [RUN]
[0m07:48:56.536009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.business_kpis, now model.planetkart_analytics.regional_insights)
[0m07:48:56.536531 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.regional_insights
[0m07:48:56.541373 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.regional_insights"
[0m07:48:56.547119 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.regional_insights
[0m07:48:56.551059 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.regional_insights"
[0m07:48:56.568805 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.regional_insights"
[0m07:48:56.569433 [debug] [Thread-1 (]: On model.planetkart_analytics.regional_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.regional_insights
  
  
  
  
  as (
    --Regional Performance



-- Multi-Planetary Market Analysis
-- Regional expansion and performance insights

SELECT 
    r.planet,
    r.market_category,
    
    -- Market size metrics
    COUNT(DISTINCT f.customer_id) as unique_customers,
    COUNT(f.order_id) as total_orders,
    ROUND(SUM(f.order_revenue), 2) as total_revenue,
    ROUND(SUM(f.order_profit), 2) as total_profit,
    
    -- Performance metrics
    ROUND(AVG(f.order_revenue), 2) as avg_order_value,
    ROUND(SUM(f.order_profit) / SUM(f.order_revenue) * 100, 1) as profit_margin_pct,
    ROUND(COUNT(f.order_id) * 1.0 / COUNT(DISTINCT f.customer_id), 1) as orders_per_customer,
    
    -- Market insights
    ROUND(SUM(f.order_revenue) * 100.0 / SUM(SUM(f.order_revenue)) OVER(), 1) as market_share_pct

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders f
JOIN PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions r ON f.region_sk = r.region_sk
WHERE f.is_completed = 1
GROUP BY r.planet, r.market_category
ORDER BY total_profit DESC

-- Which planets are most profitable, expansion opportunities, market penetration rates
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.regional_insights"} */;
[0m07:48:56.780955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m07:48:56.787056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61583726-667f-492a-b35e-2e749fb848da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d183110>]}
[0m07:48:56.787964 [info ] [Thread-1 (]: 13 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [[32mSUCCESS 1[0m in 0.25s]
[0m07:48:56.788705 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.regional_insights
[0m07:48:56.790113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:48:56.790443 [debug] [MainThread]: Connection 'model.planetkart_analytics.regional_insights' was left open.
[0m07:48:56.790743 [debug] [MainThread]: On model.planetkart_analytics.regional_insights: Close
[0m07:48:56.903254 [info ] [MainThread]: 
[0m07:48:56.904047 [info ] [MainThread]: Finished running 4 table models, 9 view models in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m07:48:56.907438 [debug] [MainThread]: Command end result
[0m07:48:56.948102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:48:56.954715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:48:56.962286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:48:56.962592 [info ] [MainThread]: 
[0m07:48:56.962966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:48:56.963263 [info ] [MainThread]: 
[0m07:48:56.963679 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m07:48:56.969345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.987444, "process_in_blocks": "0", "process_kernel_time": 0.468558, "process_mem_max_rss": "159629312", "process_out_blocks": "0", "process_user_time": 2.25105}
[0m07:48:56.969851 [debug] [MainThread]: Command `dbt run` succeeded at 07:48:56.969762 after 9.99 seconds
[0m07:48:56.970167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d22ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d22fdd0>]}
[0m07:48:56.970451 [debug] [MainThread]: Flushing usage events
[0m07:48:58.374907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:52:12.386240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107803750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107803610>]}


============================== 07:52:12.393130 | fae4aef1-d755-4f7e-b10a-b4f044310f7f ==============================
[0m07:52:12.393130 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:52:12.393512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:52:13.189492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1f5c0>]}
[0m07:52:13.219283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e6690>]}
[0m07:52:13.221000 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:52:13.310481 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:52:13.519545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:52:13.519968 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/Advance_analysis/business_kpis.sql
[0m07:52:13.660426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf4850>]}
[0m07:52:13.792936 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:52:13.817226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:52:13.920254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d6a80>]}
[0m07:52:13.920787 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:52:13.921174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891cc90>]}
[0m07:52:13.923486 [info ] [MainThread]: 
[0m07:52:13.923807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:52:13.924023 [info ] [MainThread]: 
[0m07:52:13.924387 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:52:13.928629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m07:52:14.153032 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:52:14.153268 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:52:14.153412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:52:14.675338 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.522 seconds
[0m07:52:14.680540 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:52:14.681140 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:52:14.770676 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.089 seconds
[0m07:52:14.791982 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:52:14.792306 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:52:14.868090 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.076 seconds
[0m07:52:14.872703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics)
[0m07:52:14.882297 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"
[0m07:52:14.882584 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_advance_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"} */;
[0m07:52:14.980084 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.097 seconds
[0m07:52:14.983162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m07:52:14.986962 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m07:52:14.987285 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m07:52:15.084701 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.097 seconds
[0m07:52:15.087335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m07:52:15.095865 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m07:52:15.096194 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m07:52:15.179175 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.083 seconds
[0m07:52:15.180598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now list_PLANETKART_snapshots)
[0m07:52:15.182336 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m07:52:15.182532 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m07:52:15.273545 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m07:52:15.276731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a106000>]}
[0m07:52:15.281700 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m07:52:15.282185 [info ] [Thread-1 (]: 1 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m07:52:15.282715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now model.planetkart_analytics.stg_customers)
[0m07:52:15.282931 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m07:52:15.291370 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m07:52:15.293458 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m07:52:15.319322 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m07:52:15.326925 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m07:52:15.327322 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m07:52:15.564377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m07:52:15.582843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e4ad0>]}
[0m07:52:15.583312 [info ] [Thread-1 (]: 1 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.30s]
[0m07:52:15.583637 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m07:52:15.583844 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m07:52:15.584057 [info ] [Thread-1 (]: 2 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m07:52:15.584341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m07:52:15.584559 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m07:52:15.586158 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m07:52:15.587987 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m07:52:15.589773 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m07:52:15.591224 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m07:52:15.591437 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m07:52:15.766554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m07:52:15.770258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f3b3e0>]}
[0m07:52:15.771166 [info ] [Thread-1 (]: 2 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.19s]
[0m07:52:15.771940 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m07:52:15.772448 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m07:52:15.773106 [info ] [Thread-1 (]: 3 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders .. [RUN]
[0m07:52:15.773476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m07:52:15.773718 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m07:52:15.775690 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m07:52:15.777412 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m07:52:15.779445 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m07:52:15.781253 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m07:52:15.781500 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m07:52:15.947250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m07:52:15.951334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b9c70>]}
[0m07:52:15.952859 [info ] [Thread-1 (]: 3 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.18s]
[0m07:52:15.953931 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m07:52:15.954806 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m07:52:15.955411 [info ] [Thread-1 (]: 4 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [RUN]
[0m07:52:15.955869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m07:52:15.956191 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m07:52:15.959043 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m07:52:15.961297 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m07:52:15.964268 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m07:52:15.966489 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m07:52:15.966886 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m07:52:16.130160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m07:52:16.134843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c0950>]}
[0m07:52:16.135921 [info ] [Thread-1 (]: 4 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.18s]
[0m07:52:16.136759 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m07:52:16.137966 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m07:52:16.138992 [info ] [Thread-1 (]: 5 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions . [RUN]
[0m07:52:16.139839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m07:52:16.140355 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m07:52:16.144753 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m07:52:16.148149 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m07:52:16.152119 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m07:52:16.154757 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m07:52:16.155278 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m07:52:16.318942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m07:52:16.321775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c8c20>]}
[0m07:52:16.322653 [info ] [Thread-1 (]: 5 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.18s]
[0m07:52:16.323811 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m07:52:16.324545 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m07:52:16.325336 [info ] [Thread-1 (]: 6 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m07:52:16.325990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m07:52:16.326421 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m07:52:16.337025 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m07:52:16.339132 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m07:52:16.352468 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m07:52:16.355502 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m07:52:16.355822 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 then 'Repeat_Engagement'
        else 'Single_Engagement'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m07:52:17.443400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.087 seconds
[0m07:52:17.449936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a282e10>]}
[0m07:52:17.450413 [info ] [Thread-1 (]: 6 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.12s]
[0m07:52:17.450708 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m07:52:17.450907 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m07:52:17.451112 [info ] [Thread-1 (]: 7 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m07:52:17.451380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m07:52:17.451543 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m07:52:17.453849 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m07:52:17.461122 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m07:52:17.463032 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m07:52:17.467083 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m07:52:17.467500 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m07:52:18.047225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m07:52:18.050147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a281f10>]}
[0m07:52:18.051045 [info ] [Thread-1 (]: 7 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 0.60s]
[0m07:52:18.051884 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m07:52:18.052447 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m07:52:18.053122 [info ] [Thread-1 (]: 8 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m07:52:18.053798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m07:52:18.054593 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m07:52:18.064248 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m07:52:18.067596 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m07:52:18.071685 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m07:52:18.075987 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m07:52:18.076664 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m07:52:18.917080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.840 seconds
[0m07:52:18.919723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a283110>]}
[0m07:52:18.920519 [info ] [Thread-1 (]: 8 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 0.87s]
[0m07:52:18.921245 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m07:52:18.921744 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m07:52:18.922397 [info ] [Thread-1 (]: 9 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m07:52:18.923211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m07:52:18.923966 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m07:52:18.926432 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m07:52:18.928396 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m07:52:18.931019 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m07:52:18.934432 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m07:52:18.934720 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m07:52:19.754077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m07:52:19.758313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a282630>]}
[0m07:52:19.759699 [info ] [Thread-1 (]: 9 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.83s]
[0m07:52:19.760555 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m07:52:19.761149 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.customer_insights
[0m07:52:19.762212 [info ] [Thread-1 (]: 10 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [RUN]
[0m07:52:19.763059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now model.planetkart_analytics.customer_insights)
[0m07:52:19.763549 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.customer_insights
[0m07:52:19.767851 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.customer_insights"
[0m07:52:19.770580 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.customer_insights
[0m07:52:19.776344 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.customer_insights"
[0m07:52:19.779203 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.customer_insights"
[0m07:52:19.779748 [debug] [Thread-1 (]: On model.planetkart_analytics.customer_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.customer_insights
  
  
  
  
  as (
    

-- Customer Intelligence Dashboard
-- Shows key customer segments and behavioral patterns

SELECT 
    -- Customer segmentation summary
    revenue_segment,
    lifecycle_stage,
    COUNT(*) as customer_count,
    ROUND(AVG(total_revenue), 2) as avg_revenue_per_customer,
    ROUND(AVG(total_profit), 2) as avg_profit_per_customer,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin_pct,
    
    -- Business insights
    ROUND(SUM(total_revenue), 2) as segment_total_revenue,
    ROUND(SUM(total_profit), 2) as segment_total_profit,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 1) as pct_of_customers,
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_revenue

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
WHERE total_orders > 0
GROUP BY revenue_segment, lifecycle_stage
ORDER BY segment_total_profit DESC

-- Customer segment profitability, where to focus retention efforts, which segments drive revenue
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.customer_insights"} */;
[0m07:52:19.996061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m07:52:19.999952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2831d0>]}
[0m07:52:20.000956 [info ] [Thread-1 (]: 10 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [[32mSUCCESS 1[0m in 0.24s]
[0m07:52:20.001800 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.customer_insights
[0m07:52:20.002350 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.product_insights
[0m07:52:20.002985 [info ] [Thread-1 (]: 11 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [RUN]
[0m07:52:20.003524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.customer_insights, now model.planetkart_analytics.product_insights)
[0m07:52:20.004149 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.product_insights
[0m07:52:20.007768 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.product_insights"
[0m07:52:20.010005 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.product_insights
[0m07:52:20.013064 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.product_insights"
[0m07:52:20.016457 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.product_insights"
[0m07:52:20.017071 [debug] [Thread-1 (]: On model.planetkart_analytics.product_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.product_insights
  
  
  
  
  as (
    --Product Performance



-- Product Portfolio Analysis
-- Identifies winners, losers, and opportunities

SELECT 
    category,
    profit_segment,
    COUNT(*) as products_in_segment,
    ROUND(SUM(total_revenue), 2) as category_revenue,
    ROUND(SUM(total_profit), 2) as category_profit,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin,
    
    -- Top performer in each category
    MAX(CASE WHEN total_profit > 0 THEN product_name END) as top_product,
    MAX(total_profit) as highest_profit,
    
    -- Performance insights
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_total_revenue,
    COUNT(CASE WHEN sales_performance = 'Best_Seller' THEN 1 END) as best_sellers_count

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
GROUP BY category, profit_segment
HAVING SUM(total_revenue) > 0
ORDER BY category_profit DESC

--Which categories are most profitable, product mix optimization, inventory focus areas
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.product_insights"} */;
[0m07:52:20.237153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m07:52:20.239014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1de630>]}
[0m07:52:20.239559 [info ] [Thread-1 (]: 11 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [[32mSUCCESS 1[0m in 0.24s]
[0m07:52:20.239988 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.product_insights
[0m07:52:20.240273 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.business_kpis
[0m07:52:20.240679 [info ] [Thread-1 (]: 12 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [RUN]
[0m07:52:20.241069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.product_insights, now model.planetkart_analytics.business_kpis)
[0m07:52:20.241348 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.business_kpis
[0m07:52:20.246560 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.business_kpis"
[0m07:52:20.248141 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.business_kpis
[0m07:52:20.250108 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.business_kpis"
[0m07:52:20.254057 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.business_kpis"
[0m07:52:20.254452 [debug] [Thread-1 (]: On model.planetkart_analytics.business_kpis: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.business_kpis
  
  
  
  
  as (
    

-- Executive KPI Dashboard - Meaningful Business Insights
SELECT 
    'PlanetKart Executive Summary' as report_title,
    CURRENT_DATE() as report_date,
    
    -- Core Financial Metrics
    (SELECT SUM(order_revenue) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) as total_revenue,
    (SELECT SUM(order_profit) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) as total_profit,
    (SELECT ROUND(AVG(order_revenue), 2) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) as avg_order_value,
    
    -- Customer Health Metrics (only non-zero)
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE total_orders > 0) as total_active_customers,
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE total_orders >= 2) as repeat_customers,
    (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE revenue_segment = 'High_Value') as high_value_customers,
    
    -- Product Performance (with names)
    (SELECT product_name FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products WHERE total_profit = (SELECT MAX(total_profit) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products)) as most_profitable_product,
    (SELECT ROUND(MAX(total_profit), 2) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products) as highest_product_profit,
    
    (SELECT product_name FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products WHERE total_sales = (SELECT MAX(total_sales) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products)) as best_selling_product,
    (SELECT MAX(total_sales) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products) as highest_sales_count,
    
    -- Regional Insights
    (SELECT COUNT(DISTINCT planet) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions) as planets_served,
    (SELECT planet FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions r 
     JOIN PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders f ON r.region_sk = f.region_sk 
     WHERE f.is_completed = 1
     GROUP BY planet 
     ORDER BY SUM(f.order_revenue) DESC 
     LIMIT 1) as top_revenue_planet,
    
    -- Business Health Ratios
    ROUND((SELECT SUM(order_profit) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) / 
          (SELECT SUM(order_revenue) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders WHERE is_completed = 1) * 100, 1) as overall_profit_margin,
    
    ROUND((SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE total_orders >= 2) * 100.0 / 
          (SELECT COUNT(*) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers WHERE total_orders > 0), 1) as repeat_customer_rate,
          
    -- Category Performance
    (SELECT category FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products 
     GROUP BY category 
     ORDER BY SUM(total_profit) DESC 
     LIMIT 1) as most_profitable_category,
     
    (SELECT ROUND(MAX(category_profit), 2) 
     FROM (SELECT category, SUM(total_profit) as category_profit 
           FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products 
           GROUP BY category)) as top_category_profit
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.business_kpis"} */;
[0m07:52:20.548461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m07:52:20.553680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a282c90>]}
[0m07:52:20.555002 [info ] [Thread-1 (]: 12 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [[32mSUCCESS 1[0m in 0.31s]
[0m07:52:20.555801 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.business_kpis
[0m07:52:20.556326 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.regional_insights
[0m07:52:20.557017 [info ] [Thread-1 (]: 13 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [RUN]
[0m07:52:20.557732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.business_kpis, now model.planetkart_analytics.regional_insights)
[0m07:52:20.558280 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.regional_insights
[0m07:52:20.562978 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.regional_insights"
[0m07:52:20.565078 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.regional_insights
[0m07:52:20.568811 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.regional_insights"
[0m07:52:20.572544 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.regional_insights"
[0m07:52:20.573058 [debug] [Thread-1 (]: On model.planetkart_analytics.regional_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.regional_insights
  
  
  
  
  as (
    --Regional Performance



-- Multi-Planetary Market Analysis
-- Regional expansion and performance insights

SELECT 
    r.planet,
    r.market_category,
    
    -- Market size metrics
    COUNT(DISTINCT f.customer_id) as unique_customers,
    COUNT(f.order_id) as total_orders,
    ROUND(SUM(f.order_revenue), 2) as total_revenue,
    ROUND(SUM(f.order_profit), 2) as total_profit,
    
    -- Performance metrics
    ROUND(AVG(f.order_revenue), 2) as avg_order_value,
    ROUND(SUM(f.order_profit) / SUM(f.order_revenue) * 100, 1) as profit_margin_pct,
    ROUND(COUNT(f.order_id) * 1.0 / COUNT(DISTINCT f.customer_id), 1) as orders_per_customer,
    
    -- Market insights
    ROUND(SUM(f.order_revenue) * 100.0 / SUM(SUM(f.order_revenue)) OVER(), 1) as market_share_pct

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders f
JOIN PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions r ON f.region_sk = r.region_sk
WHERE f.is_completed = 1
GROUP BY r.planet, r.market_category
ORDER BY total_profit DESC

-- Which planets are most profitable, expansion opportunities, market penetration rates
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.regional_insights"} */;
[0m07:52:20.785486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m07:52:20.789539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae4aef1-d755-4f7e-b10a-b4f044310f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a280b90>]}
[0m07:52:20.790928 [info ] [Thread-1 (]: 13 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [[32mSUCCESS 1[0m in 0.23s]
[0m07:52:20.792190 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.regional_insights
[0m07:52:20.794867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:52:20.795545 [debug] [MainThread]: Connection 'model.planetkart_analytics.regional_insights' was left open.
[0m07:52:20.796004 [debug] [MainThread]: On model.planetkart_analytics.regional_insights: Close
[0m07:52:20.905065 [info ] [MainThread]: 
[0m07:52:20.905866 [info ] [MainThread]: Finished running 4 table models, 9 view models in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m07:52:20.909707 [debug] [MainThread]: Command end result
[0m07:52:20.949108 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:52:20.953624 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:52:20.971679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:52:20.972076 [info ] [MainThread]: 
[0m07:52:20.972407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:52:20.972661 [info ] [MainThread]: 
[0m07:52:20.972948 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m07:52:20.978375 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.657026, "process_in_blocks": "0", "process_kernel_time": 0.492438, "process_mem_max_rss": "155680768", "process_out_blocks": "0", "process_user_time": 2.013589}
[0m07:52:20.979071 [debug] [MainThread]: Command `dbt run` succeeded at 07:52:20.978970 after 8.66 seconds
[0m07:52:20.979509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a438590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43bfb0>]}
[0m07:52:20.979974 [debug] [MainThread]: Flushing usage events
[0m07:52:22.218711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:53:26.911785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109203750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109203610>]}


============================== 07:53:26.917365 | 7e3a3e9e-428f-4a97-a071-0e51d863504a ==============================
[0m07:53:26.917365 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:53:26.917739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudahnshusharan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:53:27.799672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851f5c0>]}
[0m07:53:27.827531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1a690>]}
[0m07:53:27.829381 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m07:53:27.908266 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:53:28.127897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:53:28.128327 [debug] [MainThread]: Partial parsing: updated file: planetkart_analytics://models/Advance_analysis/business_kpis.sql
[0m07:53:28.262146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a328850>]}
[0m07:53:28.398814 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:53:28.406098 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:53:28.458091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d0aa80>]}
[0m07:53:28.458498 [info ] [MainThread]: Found 13 models, 1 snapshot, 23 data tests, 5 sources, 592 macros
[0m07:53:28.458766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f54670>]}
[0m07:53:28.460723 [info ] [MainThread]: 
[0m07:53:28.460996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:53:28.461193 [info ] [MainThread]: 
[0m07:53:28.461538 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:53:28.465174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PLANETKART'
[0m07:53:28.683296 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:53:28.683537 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:53:28.683684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:29.289940 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.606 seconds
[0m07:53:29.296937 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:53:29.297628 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:53:29.386585 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.088 seconds
[0m07:53:29.394988 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART"
[0m07:53:29.395698 [debug] [ThreadPool]: On list_PLANETKART: show terse schemas in database PLANETKART
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART"} */
[0m07:53:29.485108 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.089 seconds
[0m07:53:29.487955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART, now list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics)
[0m07:53:29.498533 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"
[0m07:53:29.498901 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_advance_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics"} */;
[0m07:53:29.600833 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.102 seconds
[0m07:53:29.603770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_advance_analytics, now list_PLANETKART_snapshots)
[0m07:53:29.607017 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_snapshots"
[0m07:53:29.607392 [debug] [ThreadPool]: On list_PLANETKART_snapshots: show objects in PLANETKART.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_snapshots"} */;
[0m07:53:29.702964 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m07:53:29.707539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_snapshots, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics)
[0m07:53:29.717239 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"
[0m07:53:29.717778 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics"} */;
[0m07:53:29.803770 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.085 seconds
[0m07:53:29.808861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_analytics, now list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage)
[0m07:53:29.813016 [debug] [ThreadPool]: Using snowflake connection "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"
[0m07:53:29.813471 [debug] [ThreadPool]: On list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage: show objects in PLANETKART.PLANETKART_ANALYTICS_planetkart_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "connection_name": "list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage"} */;
[0m07:53:29.927452 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.113 seconds
[0m07:53:29.932470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44a000>]}
[0m07:53:29.940057 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_customers
[0m07:53:29.940824 [info ] [Thread-1 (]: 1 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [RUN]
[0m07:53:29.941402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_PLANETKART_PLANETKART_ANALYTICS_planetkart_stage, now model.planetkart_analytics.stg_customers)
[0m07:53:29.941876 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_customers
[0m07:53:29.953988 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_customers"
[0m07:53:29.979083 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_customers
[0m07:53:30.012182 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_customers"
[0m07:53:30.030583 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_customers"
[0m07:53:30.030999 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_customers: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers
  
  
  
  
  as (
    

select
    customer_id,
    trim(first_name || ' ' || last_name) as customer_name,
    lower(trim(email)) as email,
    region_id,
    signup_date::timestamp as signup_date,
    datediff('day', signup_date, current_date()) as days_since_signup,
    case 
        when datediff('day', signup_date, current_date()) <= 30 then 'New'
        when datediff('day', signup_date, current_date()) <= 90 then 'Recent'
        else 'Established'
    end as customer_tenure,
    case when email like '%@%.%' then 'Valid' else 'Invalid' end as email_status
from planetkart.planetkart_raw.customers
where customer_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_customers"} */;
[0m07:53:30.227740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m07:53:30.265048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b524a10>]}
[0m07:53:30.265874 [info ] [Thread-1 (]: 1 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_customers  [[32mSUCCESS 1[0m in 0.32s]
[0m07:53:30.266618 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_customers
[0m07:53:30.267077 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_order_items
[0m07:53:30.267627 [info ] [Thread-1 (]: 2 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [RUN]
[0m07:53:30.268085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_customers, now model.planetkart_analytics.stg_order_items)
[0m07:53:30.268429 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_order_items
[0m07:53:30.271099 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_order_items"
[0m07:53:30.279322 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_order_items
[0m07:53:30.281898 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_order_items"
[0m07:53:30.293258 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_order_items"
[0m07:53:30.293648 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_order_items: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items
  
  
  
  
  as (
    

select
    order_id,
    product_id,
    quantity,
    unit_price,
    
    -- Key metrics for analysis
    quantity * unit_price as line_total
    
from planetkart.planetkart_raw.order_items
where order_id is not null and product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_order_items"} */;
[0m07:53:30.462850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m07:53:30.467759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b387120>]}
[0m07:53:30.469241 [info ] [Thread-1 (]: 2 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_order_items  [[32mSUCCESS 1[0m in 0.20s]
[0m07:53:30.470248 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_order_items
[0m07:53:30.470779 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_orders
[0m07:53:30.471514 [info ] [Thread-1 (]: 3 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders .. [RUN]
[0m07:53:30.472237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_order_items, now model.planetkart_analytics.stg_orders)
[0m07:53:30.472772 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_orders
[0m07:53:30.477336 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_orders"
[0m07:53:30.486812 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_orders
[0m07:53:30.490505 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_orders"
[0m07:53:30.503246 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_orders"
[0m07:53:30.503723 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_orders: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders
  
  
  
  
  as (
    

select
    order_id,
    customer_id,
    order_date::timestamp as order_date,
    lower(trim(status)) as order_status,
    
    -- Useful for analysis
    case when lower(status) = 'completed' then 1 else 0 end as is_completed,
    date_trunc('month', order_date::timestamp) as order_month
    
from planetkart.planetkart_raw.orders
where order_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_orders"} */;
[0m07:53:30.678939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m07:53:30.683722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ddd10>]}
[0m07:53:30.685088 [info ] [Thread-1 (]: 3 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_orders  [[32mSUCCESS 1[0m in 0.21s]
[0m07:53:30.686376 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_orders
[0m07:53:30.687043 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_products
[0m07:53:30.687850 [info ] [Thread-1 (]: 4 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [RUN]
[0m07:53:30.688565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_orders, now model.planetkart_analytics.stg_products)
[0m07:53:30.689090 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_products
[0m07:53:30.693652 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_products"
[0m07:53:30.704478 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_products
[0m07:53:30.708052 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_products"
[0m07:53:30.721136 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_products"
[0m07:53:30.721661 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_products: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products
  
  
  
  
  as (
    

select
    product_id,
    trim(product_name) as product_name,
    trim(category) as category,
    trim(sku) as sku,
    cost,
    
    -- Basic data cleaning
    case when cost <= 0 or cost is null then 'Invalid' else 'Valid' end as cost_flag,
    upper(left(category, 1)) || lower(substring(category, 2)) as category_clean
    
from planetkart.planetkart_raw.products
where product_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_products"} */;
[0m07:53:30.911483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m07:53:30.917429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b503b50>]}
[0m07:53:30.918572 [info ] [Thread-1 (]: 4 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_products  [[32mSUCCESS 1[0m in 0.23s]
[0m07:53:30.919323 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_products
[0m07:53:30.919828 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.stg_regions
[0m07:53:30.920574 [info ] [Thread-1 (]: 5 of 13 START sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions . [RUN]
[0m07:53:30.921398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_products, now model.planetkart_analytics.stg_regions)
[0m07:53:30.921978 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.stg_regions
[0m07:53:30.926034 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.stg_regions"
[0m07:53:30.935507 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.stg_regions
[0m07:53:30.939042 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.stg_regions"
[0m07:53:30.949782 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.stg_regions"
[0m07:53:30.950264 [debug] [Thread-1 (]: On model.planetkart_analytics.stg_regions: create or replace   view PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
  
  
  
  
  as (
    

select
    region_id,
    upper(trim(planet)) as planet,
    upper(trim(zone)) as zone
    
from planetkart.planetkart_raw.regions
where region_id is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.stg_regions"} */;
[0m07:53:31.168402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m07:53:31.173360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b610c20>]}
[0m07:53:31.174448 [info ] [Thread-1 (]: 5 of 13 OK created sql view model PLANETKART_ANALYTICS_planetkart_stage.stg_regions  [[32mSUCCESS 1[0m in 0.25s]
[0m07:53:31.175354 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.stg_regions
[0m07:53:31.175847 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_customers
[0m07:53:31.176488 [info ] [Thread-1 (]: 6 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [RUN]
[0m07:53:31.177120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.stg_regions, now model.planetkart_analytics.dim_customers)
[0m07:53:31.177691 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_customers
[0m07:53:31.196571 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_customers"
[0m07:53:31.215142 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_customers
[0m07:53:31.237921 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_customers"
[0m07:53:31.259089 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_customers"
[0m07:53:31.259641 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_customers: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    
    
    
    as (

with customer_metrics as (
    select 
        c.customer_id,
        c.customer_name,
        c.email,
        c.region_id,
        c.signup_date,
        c.customer_tenure,
        
        count(o.order_id) as total_orders,
        count(case when o.order_status = 'completed' then 1 end) as completed_orders,
        sum(case when o.order_status = 'completed' then oi.line_total else 0 end) as total_revenue,
        avg(case when o.order_status = 'completed' then oi.line_total end) as avg_order_value,
        sum(case when o.order_status = 'completed' then oi.line_total - (p.cost * oi.quantity) else 0 end) as total_profit,
        max(o.order_date) as last_order_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on c.customer_id = o.customer_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    group by 1,2,3,4,5,6
)

select 
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    customer_id,
    customer_name,
    email,
    region_id,
    signup_date,
    customer_tenure,
    total_orders,
    completed_orders,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    last_order_date,
    
    -- Revenue segments
    case 
        when coalesce(total_revenue, 0) >= 150 then 'High_Value'
        when coalesce(total_revenue, 0) >= 80 then 'Medium_Value'
        when coalesce(total_revenue, 0) > 0 then 'Low_Value'
        else 'No_Purchase'
    end as revenue_segment,
    
    -- Profit segments
    case 
        when coalesce(total_profit, 0) >= 20 then 'Highly_Profitable'
        when coalesce(total_profit, 0) >= 5 then 'Profitable'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        else 'Unprofitable'
    end as profit_segment,
    
    -- Lifecycle stage (behavior-based)
    case 
        when total_orders = 0 then 'Never_Purchased'
        when total_orders >= 3 then 'Loyal_Customer'
        when total_orders = 2 then 'Repeat_Customer'
        when coalesce(total_revenue, 0) >= 200 then 'High_Value_Single'
        else 'One_Time_Buyer'
    end as lifecycle_stage,
    
    -- Customer type segmentation
    case 
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 300 then 'VIP_Customer'
        when total_orders >= 2 and coalesce(total_revenue, 0) >= 150 then 'Premium_Repeat'
        when total_orders >= 2 then 'Standard_Repeat'
        when coalesce(total_revenue, 0) >= 200 then 'High_Potential'
        else 'Standard_Single'
    end as customer_type,
    
    -- CHURN ANALYSIS
    case 
        when total_orders = 0 then 'Never_Active'
        when last_order_date >= '2024-06-01' then 'Currently_Active'
        when last_order_date >= '2024-05-01' then 'Recently_Active'
        when last_order_date >= '2024-04-01' then 'At_Risk'
        when last_order_date >= '2024-03-01' then 'High_Churn_Risk'
        else 'Likely_Churned'
    end as churn_risk,
    
    -- Engagement pattern analysis
    case 
        when total_orders = 0 then 'No_Engagement'
        when total_orders >= 3 then 'High_Engagement'
        when total_orders = 2 then 'Repeat_Engagement'
        else 'Single_Engagement'
    end as engagement_pattern,
    
    -- Profit margin calculation
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from customer_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_customers"} */;
[0m07:53:32.295137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.035 seconds
[0m07:53:32.300237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c6c90>]}
[0m07:53:32.301576 [info ] [Thread-1 (]: 6 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_customers  [[32mSUCCESS 1[0m in 1.12s]
[0m07:53:32.302455 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_customers
[0m07:53:32.302989 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_products
[0m07:53:32.303721 [info ] [Thread-1 (]: 7 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [RUN]
[0m07:53:32.304519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_customers, now model.planetkart_analytics.dim_products)
[0m07:53:32.304998 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_products
[0m07:53:32.311118 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_products"
[0m07:53:32.326143 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_products
[0m07:53:32.329723 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_products"
[0m07:53:32.357659 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_products"
[0m07:53:32.358507 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_products: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    
    
    
    as (

with product_metrics as (
    select 
        p.product_id,
        p.product_name,
        p.category,
        p.sku,
        p.cost,
        
        count(oi.order_id) as total_sales,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.line_total) as total_revenue,
        avg(oi.unit_price) as avg_selling_price,
        sum(oi.line_total - (p.cost * oi.quantity)) as total_profit,
        avg(oi.unit_price - p.cost) as avg_profit_per_unit,
        count(distinct o.customer_id) as unique_customers,
        max(o.order_date) as last_sold_date
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on p.product_id = oi.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o on oi.order_id = o.order_id 
    where o.order_status = 'completed' or o.order_status is null
    group by 1,2,3,4,5
)

select 
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk,
    product_id,
    product_name,
    category,
    sku,
    cost,
    coalesce(total_sales, 0) as total_sales,
    coalesce(total_quantity_sold, 0) as total_quantity_sold,
    coalesce(total_revenue, 0) as total_revenue,
    coalesce(total_profit, 0) as total_profit,
    coalesce(unique_customers, 0) as unique_customers,
    last_sold_date,
    
    case 
        when coalesce(total_profit, 0) >= 30 then 'High_Profit'
        when coalesce(total_profit, 0) >= 10 then 'Medium_Profit'
        when coalesce(total_profit, 0) > 0 then 'Low_Profit'
        when coalesce(total_profit, 0) < 0 then 'Loss_Making'
        else 'Never_Sold'
    end as profit_segment,
    
    case 
        when coalesce(total_sales, 0) >= 3 then 'Best_Seller'
        when coalesce(total_sales, 0) >= 2 then 'Good_Seller'
        when coalesce(total_sales, 0) = 1 then 'Slow_Mover'
        else 'No_Sales'
    end as sales_performance,
    
    case 
        when coalesce(total_revenue, 0) > 0 then round((coalesce(total_profit, 0) / total_revenue) * 100, 1)
        else 0 
    end as profit_margin_pct,
    
    current_timestamp() as created_at

from product_metrics
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_products"} */;
[0m07:53:33.254487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.895 seconds
[0m07:53:33.259683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c4fb0>]}
[0m07:53:33.260755 [info ] [Thread-1 (]: 7 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_products  [[32mSUCCESS 1[0m in 0.96s]
[0m07:53:33.261539 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_products
[0m07:53:33.262040 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.fact_orders
[0m07:53:33.262710 [info ] [Thread-1 (]: 8 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [RUN]
[0m07:53:33.263413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_products, now model.planetkart_analytics.fact_orders)
[0m07:53:33.264042 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.fact_orders
[0m07:53:33.271492 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.fact_orders"
[0m07:53:33.285105 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.fact_orders
[0m07:53:33.288865 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.fact_orders"
[0m07:53:33.308123 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.fact_orders"
[0m07:53:33.308716 [debug] [Thread-1 (]: On model.planetkart_analytics.fact_orders: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    
    
    
    as (

with order_facts as (
    select 
        o.order_id,
        o.customer_id,
        c.region_id,
        o.order_date,
        o.order_status,
        
        -- Order metrics (aggregated from order items)
        sum(oi.quantity) as total_quantity,
        sum(oi.line_total) as order_revenue,
        sum(p.cost * oi.quantity) as order_cost,
        sum(oi.line_total - (p.cost * oi.quantity)) as order_profit,
        count(oi.product_id) as products_count
        
    from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_orders o
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_order_items oi on o.order_id = oi.order_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_products p on oi.product_id = p.product_id
    left join PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_customers c on o.customer_id = c.customer_id
    group by o.order_id, o.customer_id, c.region_id, o.order_date, o.order_status
)

select 
    -- Surrogate keys for star schema
    md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk,
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    
    -- Natural keys
    order_id,
    customer_id,
    region_id,
    order_date,
    order_status,
    
    -- Measures
    total_quantity,
    order_revenue,
    order_cost,
    order_profit,
    products_count,
    
    -- Business metrics
    case 
        when order_profit >= 20 then 'High_Profit'
        when order_profit >= 5 then 'Medium_Profit'
        when order_profit > 0 then 'Low_Profit'
        else 'No_Profit'
    end as profit_tier,
    
    case 
        when order_revenue >= 150 then 'Large'
        when order_revenue >= 80 then 'Medium'
        else 'Small'
    end as order_size,
    
    case when order_status = 'completed' then 1 else 0 end as is_completed,
    
    current_timestamp() as created_at

from order_facts
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.fact_orders"} */;
[0m07:53:34.380943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m07:53:34.386428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c6f30>]}
[0m07:53:34.387556 [info ] [Thread-1 (]: 8 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.fact_orders  [[32mSUCCESS 1[0m in 1.12s]
[0m07:53:34.388321 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.fact_orders
[0m07:53:34.388825 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.dim_regions
[0m07:53:34.389519 [info ] [Thread-1 (]: 9 of 13 START sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [RUN]
[0m07:53:34.390197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.fact_orders, now model.planetkart_analytics.dim_regions)
[0m07:53:34.390714 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.dim_regions
[0m07:53:34.396164 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.dim_regions"
[0m07:53:34.408673 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.dim_regions
[0m07:53:34.412708 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.dim_regions"
[0m07:53:34.430667 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.dim_regions"
[0m07:53:34.431256 [debug] [Thread-1 (]: On model.planetkart_analytics.dim_regions: create or replace transient table PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
    
    
    
    as (

select 
    md5(cast(coalesce(cast(region_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as region_sk,
    region_id,
    planet,
    zone,
    
    case 
        when planet = 'Earth' then 'Home_Base'
        when planet in ('Mars', 'Venus') then 'Expansion_Territory' 
        else 'Frontier'
    end as market_category,
    
    case 
        when planet = 'Earth' then 1
        when planet = 'Mars' then 2  
        when planet = 'Venus' then 3
        else 4
    end as expansion_order,
    
    current_timestamp() as created_at

from PLANETKART.PLANETKART_ANALYTICS_planetkart_stage.stg_regions
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.dim_regions"} */;
[0m07:53:34.939211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m07:53:34.942833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c69f0>]}
[0m07:53:34.943914 [info ] [Thread-1 (]: 9 of 13 OK created sql table model PLANETKART_ANALYTICS_planetkart_analytics.dim_regions  [[32mSUCCESS 1[0m in 0.55s]
[0m07:53:34.945018 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.dim_regions
[0m07:53:34.945963 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.customer_insights
[0m07:53:34.946914 [info ] [Thread-1 (]: 10 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [RUN]
[0m07:53:34.947697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.dim_regions, now model.planetkart_analytics.customer_insights)
[0m07:53:34.948185 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.customer_insights
[0m07:53:34.952712 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.customer_insights"
[0m07:53:34.963071 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.customer_insights
[0m07:53:34.969789 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.customer_insights"
[0m07:53:34.985210 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.customer_insights"
[0m07:53:34.985741 [debug] [Thread-1 (]: On model.planetkart_analytics.customer_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.customer_insights
  
  
  
  
  as (
    

-- Customer Intelligence Dashboard
-- Shows key customer segments and behavioral patterns

SELECT 
    -- Customer segmentation summary
    revenue_segment,
    lifecycle_stage,
    COUNT(*) as customer_count,
    ROUND(AVG(total_revenue), 2) as avg_revenue_per_customer,
    ROUND(AVG(total_profit), 2) as avg_profit_per_customer,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin_pct,
    
    -- Business insights
    ROUND(SUM(total_revenue), 2) as segment_total_revenue,
    ROUND(SUM(total_profit), 2) as segment_total_profit,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 1) as pct_of_customers,
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_revenue

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
WHERE total_orders > 0
GROUP BY revenue_segment, lifecycle_stage
ORDER BY segment_total_profit DESC

-- Customer segment profitability, where to focus retention efforts, which segments drive revenue
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.customer_insights"} */;
[0m07:53:35.194387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.207 seconds
[0m07:53:35.198876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c6a50>]}
[0m07:53:35.200187 [info ] [Thread-1 (]: 10 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.customer_insights  [[32mSUCCESS 1[0m in 0.25s]
[0m07:53:35.201044 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.customer_insights
[0m07:53:35.201566 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.product_insights
[0m07:53:35.202258 [info ] [Thread-1 (]: 11 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [RUN]
[0m07:53:35.202941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.customer_insights, now model.planetkart_analytics.product_insights)
[0m07:53:35.203452 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.product_insights
[0m07:53:35.208064 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.product_insights"
[0m07:53:35.215657 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.product_insights
[0m07:53:35.219247 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.product_insights"
[0m07:53:35.235377 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.product_insights"
[0m07:53:35.235939 [debug] [Thread-1 (]: On model.planetkart_analytics.product_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.product_insights
  
  
  
  
  as (
    --Product Performance



-- Product Portfolio Analysis
-- Identifies winners, losers, and opportunities

SELECT 
    category,
    profit_segment,
    COUNT(*) as products_in_segment,
    ROUND(SUM(total_revenue), 2) as category_revenue,
    ROUND(SUM(total_profit), 2) as category_profit,
    ROUND(AVG(profit_margin_pct), 1) as avg_margin,
    
    -- Top performer in each category
    MAX(CASE WHEN total_profit > 0 THEN product_name END) as top_product,
    MAX(total_profit) as highest_profit,
    
    -- Performance insights
    ROUND(SUM(total_revenue) * 100.0 / SUM(SUM(total_revenue)) OVER(), 1) as pct_of_total_revenue,
    COUNT(CASE WHEN sales_performance = 'Best_Seller' THEN 1 END) as best_sellers_count

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
GROUP BY category, profit_segment
HAVING SUM(total_revenue) > 0
ORDER BY category_profit DESC

--Which categories are most profitable, product mix optimization, inventory focus areas
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.product_insights"} */;
[0m07:53:35.452352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m07:53:35.457405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5227b0>]}
[0m07:53:35.458766 [info ] [Thread-1 (]: 11 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.product_insights  [[32mSUCCESS 1[0m in 0.25s]
[0m07:53:35.459883 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.product_insights
[0m07:53:35.460481 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.business_kpis
[0m07:53:35.461197 [info ] [Thread-1 (]: 12 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [RUN]
[0m07:53:35.461912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.product_insights, now model.planetkart_analytics.business_kpis)
[0m07:53:35.462496 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.business_kpis
[0m07:53:35.469223 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.business_kpis"
[0m07:53:35.482463 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.business_kpis
[0m07:53:35.486595 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.business_kpis"
[0m07:53:35.506856 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.business_kpis"
[0m07:53:35.507619 [debug] [Thread-1 (]: On model.planetkart_analytics.business_kpis: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.business_kpis
  
  
  
  
  as (
    

-- Executive KPI Dashboard - Fixed Single Row Results
WITH core_metrics AS (
    SELECT 
        SUM(order_revenue) as total_revenue,
        SUM(order_profit) as total_profit,
        ROUND(AVG(order_revenue), 2) as avg_order_value,
        COUNT(DISTINCT customer_id) as unique_customers
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders
    WHERE is_completed = 1
),

customer_metrics AS (
    SELECT 
        COUNT(*) as total_active_customers,
        COUNT(CASE WHEN total_orders >= 2 THEN 1 END) as repeat_customers,
        COUNT(CASE WHEN revenue_segment = 'High_Value' THEN 1 END) as high_value_customers
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_customers
    WHERE total_orders > 0
),

product_metrics AS (
    SELECT 
        MAX(total_profit) as max_profit,
        MAX(total_sales) as max_sales
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
),

top_product AS (
    SELECT 
        product_name as most_profitable_product
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    WHERE total_profit = (SELECT MAX(total_profit) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products)
    LIMIT 1
),

best_seller AS (
    SELECT 
        product_name as best_selling_product
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products
    WHERE total_sales = (SELECT MAX(total_sales) FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_products)
    LIMIT 1
),

regional_metrics AS (
    SELECT 
        COUNT(DISTINCT planet) as planets_served
    FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions
)

SELECT 
    'PlanetKart Executive Summary' as report_title,
    CURRENT_DATE() as report_date,
    
    -- Financial Metrics
    cm.total_revenue,
    cm.total_profit,
    cm.avg_order_value,
    
    -- Customer Metrics
    custm.total_active_customers,
    custm.repeat_customers,
    custm.high_value_customers,
    
    -- Product Performance
    tp.most_profitable_product,
    pm.max_profit as highest_product_profit,
    bs.best_selling_product,
    pm.max_sales as highest_sales_count,
    
    -- Regional Data
    rm.planets_served,
    
    -- Business Ratios
    ROUND(cm.total_profit / cm.total_revenue * 100, 1) as overall_profit_margin,
    ROUND(custm.repeat_customers * 100.0 / custm.total_active_customers, 1) as repeat_customer_rate

FROM core_metrics cm
CROSS JOIN customer_metrics custm
CROSS JOIN product_metrics pm
CROSS JOIN top_product tp
CROSS JOIN best_seller bs
CROSS JOIN regional_metrics rm
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.business_kpis"} */;
[0m07:53:35.778951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m07:53:35.784584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c7350>]}
[0m07:53:35.785876 [info ] [Thread-1 (]: 12 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.business_kpis  [[32mSUCCESS 1[0m in 0.32s]
[0m07:53:35.786811 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.business_kpis
[0m07:53:35.787490 [debug] [Thread-1 (]: Began running node model.planetkart_analytics.regional_insights
[0m07:53:35.788333 [info ] [Thread-1 (]: 13 of 13 START sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [RUN]
[0m07:53:35.789035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.planetkart_analytics.business_kpis, now model.planetkart_analytics.regional_insights)
[0m07:53:35.789536 [debug] [Thread-1 (]: Began compiling node model.planetkart_analytics.regional_insights
[0m07:53:35.794373 [debug] [Thread-1 (]: Writing injected SQL for node "model.planetkart_analytics.regional_insights"
[0m07:53:35.800339 [debug] [Thread-1 (]: Began executing node model.planetkart_analytics.regional_insights
[0m07:53:35.803868 [debug] [Thread-1 (]: Writing runtime sql for node "model.planetkart_analytics.regional_insights"
[0m07:53:35.820466 [debug] [Thread-1 (]: Using snowflake connection "model.planetkart_analytics.regional_insights"
[0m07:53:35.821072 [debug] [Thread-1 (]: On model.planetkart_analytics.regional_insights: create or replace   view PLANETKART.PLANETKART_ANALYTICS_advance_analytics.regional_insights
  
  
  
  
  as (
    --Regional Performance



-- Multi-Planetary Market Analysis
-- Regional expansion and performance insights

SELECT 
    r.planet,
    r.market_category,
    
    -- Market size metrics
    COUNT(DISTINCT f.customer_id) as unique_customers,
    COUNT(f.order_id) as total_orders,
    ROUND(SUM(f.order_revenue), 2) as total_revenue,
    ROUND(SUM(f.order_profit), 2) as total_profit,
    
    -- Performance metrics
    ROUND(AVG(f.order_revenue), 2) as avg_order_value,
    ROUND(SUM(f.order_profit) / SUM(f.order_revenue) * 100, 1) as profit_margin_pct,
    ROUND(COUNT(f.order_id) * 1.0 / COUNT(DISTINCT f.customer_id), 1) as orders_per_customer,
    
    -- Market insights
    ROUND(SUM(f.order_revenue) * 100.0 / SUM(SUM(f.order_revenue)) OVER(), 1) as market_share_pct

FROM PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.fact_orders f
JOIN PLANETKART.PLANETKART_ANALYTICS_planetkart_analytics.dim_regions r ON f.region_sk = r.region_sk
WHERE f.is_completed = 1
GROUP BY r.planet, r.market_category
ORDER BY total_profit DESC

-- Which planets are most profitable, expansion opportunities, market penetration rates
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "planetkart_analytics", "target_name": "dev", "node_id": "model.planetkart_analytics.regional_insights"} */;
[0m07:53:36.025836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m07:53:36.030906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a3e9e-428f-4a97-a071-0e51d863504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c6090>]}
[0m07:53:36.032042 [info ] [Thread-1 (]: 13 of 13 OK created sql view model PLANETKART_ANALYTICS_advance_analytics.regional_insights  [[32mSUCCESS 1[0m in 0.24s]
[0m07:53:36.032874 [debug] [Thread-1 (]: Finished running node model.planetkart_analytics.regional_insights
[0m07:53:36.034389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:36.034814 [debug] [MainThread]: Connection 'model.planetkart_analytics.regional_insights' was left open.
[0m07:53:36.035193 [debug] [MainThread]: On model.planetkart_analytics.regional_insights: Close
[0m07:53:36.143313 [info ] [MainThread]: 
[0m07:53:36.144107 [info ] [MainThread]: Finished running 4 table models, 9 view models in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m07:53:36.147083 [debug] [MainThread]: Command end result
[0m07:53:36.186966 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/manifest.json
[0m07:53:36.196000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/semantic_manifest.json
[0m07:53:36.202741 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudahnshusharan/planetkart_analytics/planetkart-analytics/target/run_results.json
[0m07:53:36.203006 [info ] [MainThread]: 
[0m07:53:36.203276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:53:36.203516 [info ] [MainThread]: 
[0m07:53:36.203747 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m07:53:36.208894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.366044, "process_in_blocks": "0", "process_kernel_time": 0.509149, "process_mem_max_rss": "159924224", "process_out_blocks": "0", "process_user_time": 2.260514}
[0m07:53:36.209489 [debug] [MainThread]: Command `dbt run` succeeded at 07:53:36.209361 after 9.37 seconds
[0m07:53:36.209884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108420b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b523ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b67c770>]}
[0m07:53:36.210212 [debug] [MainThread]: Flushing usage events
[0m07:53:37.440587 [debug] [MainThread]: An error was encountered while trying to flush usage events
